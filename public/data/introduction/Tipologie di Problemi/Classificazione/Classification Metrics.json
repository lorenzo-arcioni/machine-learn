{
  "title": "Metriche di Valutazione per Classificazione in Machine Learning",
  "content": "<style>pre { line-height: 125%; }\ntd.linenos .normal { color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px; }\nspan.linenos { color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px; }\ntd.linenos .special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }\nspan.linenos.special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }\n.codehilite .hll { background-color: #ffffcc }\n.codehilite { background: #f8f8f8; }\n.codehilite .c { color: #3D7B7B; font-style: italic } /* Comment */\n.codehilite .err { border: 1px solid #F00 } /* Error */\n.codehilite .k { color: #008000; font-weight: bold } /* Keyword */\n.codehilite .o { color: #666 } /* Operator */\n.codehilite .ch { color: #3D7B7B; font-style: italic } /* Comment.Hashbang */\n.codehilite .cm { color: #3D7B7B; font-style: italic } /* Comment.Multiline */\n.codehilite .cp { color: #9C6500 } /* Comment.Preproc */\n.codehilite .cpf { color: #3D7B7B; font-style: italic } /* Comment.PreprocFile */\n.codehilite .c1 { color: #3D7B7B; font-style: italic } /* Comment.Single */\n.codehilite .cs { color: #3D7B7B; font-style: italic } /* Comment.Special */\n.codehilite .gd { color: #A00000 } /* Generic.Deleted */\n.codehilite .ge { font-style: italic } /* Generic.Emph */\n.codehilite .ges { font-weight: bold; font-style: italic } /* Generic.EmphStrong */\n.codehilite .gr { color: #E40000 } /* Generic.Error */\n.codehilite .gh { color: #000080; font-weight: bold } /* Generic.Heading */\n.codehilite .gi { color: #008400 } /* Generic.Inserted */\n.codehilite .go { color: #717171 } /* Generic.Output */\n.codehilite .gp { color: #000080; font-weight: bold } /* Generic.Prompt */\n.codehilite .gs { font-weight: bold } /* Generic.Strong */\n.codehilite .gu { color: #800080; font-weight: bold } /* Generic.Subheading */\n.codehilite .gt { color: #04D } /* Generic.Traceback */\n.codehilite .kc { color: #008000; font-weight: bold } /* Keyword.Constant */\n.codehilite .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */\n.codehilite .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */\n.codehilite .kp { color: #008000 } /* Keyword.Pseudo */\n.codehilite .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */\n.codehilite .kt { color: #B00040 } /* Keyword.Type */\n.codehilite .m { color: #666 } /* Literal.Number */\n.codehilite .s { color: #BA2121 } /* Literal.String */\n.codehilite .na { color: #687822 } /* Name.Attribute */\n.codehilite .nb { color: #008000 } /* Name.Builtin */\n.codehilite .nc { color: #00F; font-weight: bold } /* Name.Class */\n.codehilite .no { color: #800 } /* Name.Constant */\n.codehilite .nd { color: #A2F } /* Name.Decorator */\n.codehilite .ni { color: #717171; font-weight: bold } /* Name.Entity */\n.codehilite .ne { color: #CB3F38; font-weight: bold } /* Name.Exception */\n.codehilite .nf { color: #00F } /* Name.Function */\n.codehilite .nl { color: #767600 } /* Name.Label */\n.codehilite .nn { color: #00F; font-weight: bold } /* Name.Namespace */\n.codehilite .nt { color: #008000; font-weight: bold } /* Name.Tag */\n.codehilite .nv { color: #19177C } /* Name.Variable */\n.codehilite .ow { color: #A2F; font-weight: bold } /* Operator.Word */\n.codehilite .w { color: #BBB } /* Text.Whitespace */\n.codehilite .mb { color: #666 } /* Literal.Number.Bin */\n.codehilite .mf { color: #666 } /* Literal.Number.Float */\n.codehilite .mh { color: #666 } /* Literal.Number.Hex */\n.codehilite .mi { color: #666 } /* Literal.Number.Integer */\n.codehilite .mo { color: #666 } /* Literal.Number.Oct */\n.codehilite .sa { color: #BA2121 } /* Literal.String.Affix */\n.codehilite .sb { color: #BA2121 } /* Literal.String.Backtick */\n.codehilite .sc { color: #BA2121 } /* Literal.String.Char */\n.codehilite .dl { color: #BA2121 } /* Literal.String.Delimiter */\n.codehilite .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */\n.codehilite .s2 { color: #BA2121 } /* Literal.String.Double */\n.codehilite .se { color: #AA5D1F; font-weight: bold } /* Literal.String.Escape */\n.codehilite .sh { color: #BA2121 } /* Literal.String.Heredoc */\n.codehilite .si { color: #A45A77; font-weight: bold } /* Literal.String.Interpol */\n.codehilite .sx { color: #008000 } /* Literal.String.Other */\n.codehilite .sr { color: #A45A77 } /* Literal.String.Regex */\n.codehilite .s1 { color: #BA2121 } /* Literal.String.Single */\n.codehilite .ss { color: #19177C } /* Literal.String.Symbol */\n.codehilite .bp { color: #008000 } /* Name.Builtin.Pseudo */\n.codehilite .fm { color: #00F } /* Name.Function.Magic */\n.codehilite .vc { color: #19177C } /* Name.Variable.Class */\n.codehilite .vg { color: #19177C } /* Name.Variable.Global */\n.codehilite .vi { color: #19177C } /* Name.Variable.Instance */\n.codehilite .vm { color: #19177C } /* Name.Variable.Magic */\n.codehilite .il { color: #666 } /* Literal.Number.Integer.Long */\n\n/* Styling per blocchi di codice */\n.codehilite {\n    background: transparent !important;\n    border-radius: 8px;\n    overflow: hidden;\n}\n.codehilite pre {\n    background: transparent !important;\n    margin: 0 !important;\n    padding: 20px !important;\n    font-family: 'Monaco', 'Menlo', 'Consolas', monospace !important;\n    font-size: 14px !important;\n    line-height: 1.5 !important;\n    white-space: pre !important;\n    overflow-x: auto !important;\n    color: inherit !important;\n}\n.codehilite code {\n    background: transparent !important;\n    padding: 0 !important;\n    font-family: inherit !important;\n}\n\n\n.code-wrapper { \n    position: relative; \n}\n.copy-button {\n    position: absolute; \n    top: 12px; \n    right: 12px; \n    padding: 6px 12px; \n    font-size: 12px;\n    cursor: pointer; \n    border: none; \n    border-radius: 4px; \n    background: rgba(255,255,255,0.9);\n    color: #374151; \n    transition: all 0.2s ease;\n    font-weight: 500;\n}\n.copy-button:hover { \n    background: rgba(255,255,255,1);\n    transform: translateY(-1px);\n}\n\n\ndetails.code-container {\n    border: 1px solid #e5e7eb; \n    border-radius: 12px; \n    background: #f9fafb;\n    margin: 16px 0;\n    transition: all 0.3s ease;\n}\ndetails.code-container summary {\n    padding: 12px 16px;\n    font-size: 14px; \n    color: #6b7280; \n    cursor: pointer; \n    outline: none; \n    user-select: none;\n    font-weight: 500;\n}\ndetails.code-container[open] summary::after { \n    content: \" (Hide Code)\"; \n    color: #9ca3af; \n}\ndetails.code-container:not([open]) summary::after { \n    content: \" (Show Code)\"; \n    color: #d1d5db; \n}\ndetails.code-container .code-wrapper {\n    padding: 0;\n    margin: 0;\n}\n/* Blocchi di codice sempre visibili */\n.code-visible {\n    border: 1px solid #e5e7eb;\n    border-radius: 12px;\n    background: #f9fafb;\n    margin: 16px 0;\n}\n.code-visible .code-wrapper {\n    padding: 0;\n    margin: 0;\n}\n</style>\n<h2 id=\"1-introduzione\">1. Introduzione</h2>\n<p>La valutazione di modelli di classificazione richiede metriche specifiche che quantifichino la qualità delle predizioni. Questo documento presenta una trattazione completa e rigorosa delle principali metriche utilizzate nel machine learning, con particolare attenzione alle differenze rispetto alle metriche biometriche.</p>\n<h2 id=\"2-matrice-di-confusione\">2. Matrice di Confusione</h2>\n<p>La <strong>matrice di confusione</strong> è la base per calcolare tutte le metriche di classificazione. Per un problema binario:</p>\n<table>\n<thead>\n<tr>\n<th></th>\n<th><strong>Predetto Positivo (P)</strong></th>\n<th><strong>Predetto Negativo (N)</strong></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><strong>Reale Positivo</strong></td>\n<td>TP (True Positive)</td>\n<td>FN (False Negative)</td>\n</tr>\n<tr>\n<td><strong>Reale Negativo</strong></td>\n<td>FP (False Positive)</td>\n<td>TN (True Negative)</td>\n</tr>\n</tbody>\n</table>\n<h3 id=\"21-definizioni-rigorose\">2.1 Definizioni Rigorose</h3>\n<ul>\n<li><strong>TP (True Positive)</strong>: Istanze positive correttamente classificate come positive</li>\n<li>In ML: Predizioni positive corrette</li>\n<li>\n<p>In Biometria: <strong>Genuine Acceptance (GA)</strong> o <strong>Genuine Match (GM)</strong></p>\n</li>\n<li>\n<p><strong>TN (True Negative)</strong>: Istanze negative correttamente classificate come negative</p>\n</li>\n<li>In ML: Predizioni negative corrette</li>\n<li>\n<p>In Biometria: <strong>Genuine Rejection (GR)</strong> o <strong>Genuine Non-Match (GNM)</strong></p>\n</li>\n<li>\n<p><strong>FP (False Positive)</strong>: Istanze negative erroneamente classificate come positive (Errore di Tipo II)</p>\n</li>\n<li>In ML: Falsi allarmi</li>\n<li>\n<p>In Biometria: <strong>False Acceptance (FA)</strong> o <strong>False Match (FM)</strong></p>\n</li>\n<li>\n<p><strong>FN (False Negative)</strong>: Istanze positive erroneamente classificate come negative (Errore di Tipo I)</p>\n</li>\n<li>In ML: Mancate rilevazioni</li>\n<li>In Biometria: <strong>False Rejection (FR)</strong> o <strong>False Non-Match (FNM)</strong></li>\n</ul>\n<h3 id=\"22-visualizzazione-della-matrice-di-confusione\">2.2 Visualizzazione della Matrice di Confusione</h3>\n<details class=\"code-container\">\n<summary>Code</summary>\n<div class=\"code-wrapper\">\n<button class=\"copy-button\" onclick=\"\n                const code = this.parentElement.querySelector('pre');\n                if (code) {\n                    navigator.clipboard.writeText(code.innerText);\n                    this.textContent = 'Copied!';\n                    setTimeout(() => this.textContent = 'Copy', 2000);\n                }\n            \">Copy</button>\n<div class=\"codehilite\"><pre><span></span><code><span class=\"kn\">from</span><span class=\"w\"> </span><span class=\"nn\">sklearn.metrics</span><span class=\"w\"> </span><span class=\"kn\">import</span> <span class=\"n\">confusion_matrix</span><span class=\"p\">,</span> <span class=\"n\">ConfusionMatrixDisplay</span>\n<span class=\"kn\">from</span><span class=\"w\"> </span><span class=\"nn\">sklearn.datasets</span><span class=\"w\"> </span><span class=\"kn\">import</span> <span class=\"n\">make_classification</span>\n<span class=\"kn\">from</span><span class=\"w\"> </span><span class=\"nn\">sklearn.model_selection</span><span class=\"w\"> </span><span class=\"kn\">import</span> <span class=\"n\">train_test_split</span>\n<span class=\"kn\">from</span><span class=\"w\"> </span><span class=\"nn\">sklearn.ensemble</span><span class=\"w\"> </span><span class=\"kn\">import</span> <span class=\"n\">RandomForestClassifier</span>\n<span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"nn\">matplotlib.pyplot</span><span class=\"w\"> </span><span class=\"k\">as</span><span class=\"w\"> </span><span class=\"nn\">plt</span>\n<span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"nn\">numpy</span><span class=\"w\"> </span><span class=\"k\">as</span><span class=\"w\"> </span><span class=\"nn\">np</span>\n<span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"nn\">seaborn</span><span class=\"w\"> </span><span class=\"k\">as</span><span class=\"w\"> </span><span class=\"nn\">sns</span>\n\n<span class=\"n\">X</span><span class=\"p\">,</span> <span class=\"n\">y</span> <span class=\"o\">=</span> <span class=\"n\">make_classification</span><span class=\"p\">(</span><span class=\"n\">n_samples</span><span class=\"o\">=</span><span class=\"mi\">1000</span><span class=\"p\">,</span> <span class=\"n\">n_features</span><span class=\"o\">=</span><span class=\"mi\">20</span><span class=\"p\">,</span> <span class=\"n\">n_informative</span><span class=\"o\">=</span><span class=\"mi\">15</span><span class=\"p\">,</span> \n                          <span class=\"n\">n_redundant</span><span class=\"o\">=</span><span class=\"mi\">5</span><span class=\"p\">,</span> <span class=\"n\">random_state</span><span class=\"o\">=</span><span class=\"mi\">42</span><span class=\"p\">)</span>\n<span class=\"n\">X_train</span><span class=\"p\">,</span> <span class=\"n\">X_test</span><span class=\"p\">,</span> <span class=\"n\">y_train</span><span class=\"p\">,</span> <span class=\"n\">y_test</span> <span class=\"o\">=</span> <span class=\"n\">train_test_split</span><span class=\"p\">(</span><span class=\"n\">X</span><span class=\"p\">,</span> <span class=\"n\">y</span><span class=\"p\">,</span> <span class=\"n\">test_size</span><span class=\"o\">=</span><span class=\"mf\">0.3</span><span class=\"p\">,</span> <span class=\"n\">random_state</span><span class=\"o\">=</span><span class=\"mi\">42</span><span class=\"p\">)</span>\n<span class=\"n\">clf</span> <span class=\"o\">=</span> <span class=\"n\">RandomForestClassifier</span><span class=\"p\">(</span><span class=\"n\">random_state</span><span class=\"o\">=</span><span class=\"mi\">42</span><span class=\"p\">)</span>\n<span class=\"n\">clf</span><span class=\"o\">.</span><span class=\"n\">fit</span><span class=\"p\">(</span><span class=\"n\">X_train</span><span class=\"p\">,</span> <span class=\"n\">y_train</span><span class=\"p\">)</span>\n<span class=\"n\">y_pred</span> <span class=\"o\">=</span> <span class=\"n\">clf</span><span class=\"o\">.</span><span class=\"n\">predict</span><span class=\"p\">(</span><span class=\"n\">X_test</span><span class=\"p\">)</span>\n\n<span class=\"n\">fig</span><span class=\"p\">,</span> <span class=\"n\">axes</span> <span class=\"o\">=</span> <span class=\"n\">plt</span><span class=\"o\">.</span><span class=\"n\">subplots</span><span class=\"p\">(</span><span class=\"mi\">1</span><span class=\"p\">,</span> <span class=\"mi\">2</span><span class=\"p\">,</span> <span class=\"n\">figsize</span><span class=\"o\">=</span><span class=\"p\">(</span><span class=\"mi\">14</span><span class=\"p\">,</span> <span class=\"mi\">5</span><span class=\"p\">))</span>\n\n<span class=\"c1\"># Matrice assoluta</span>\n<span class=\"n\">cm</span> <span class=\"o\">=</span> <span class=\"n\">confusion_matrix</span><span class=\"p\">(</span><span class=\"n\">y_test</span><span class=\"p\">,</span> <span class=\"n\">y_pred</span><span class=\"p\">)</span>\n<span class=\"n\">disp</span> <span class=\"o\">=</span> <span class=\"n\">ConfusionMatrixDisplay</span><span class=\"p\">(</span><span class=\"n\">confusion_matrix</span><span class=\"o\">=</span><span class=\"n\">cm</span><span class=\"p\">,</span> <span class=\"n\">display_labels</span><span class=\"o\">=</span><span class=\"p\">[</span><span class=\"s1\">&#39;Negativo&#39;</span><span class=\"p\">,</span> <span class=\"s1\">&#39;Positivo&#39;</span><span class=\"p\">])</span>\n<span class=\"n\">disp</span><span class=\"o\">.</span><span class=\"n\">plot</span><span class=\"p\">(</span><span class=\"n\">cmap</span><span class=\"o\">=</span><span class=\"s1\">&#39;Blues&#39;</span><span class=\"p\">,</span> <span class=\"n\">ax</span><span class=\"o\">=</span><span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">])</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">set_title</span><span class=\"p\">(</span><span class=\"s1\">&#39;Matrice di Confusione (Valori Assoluti)&#39;</span><span class=\"p\">)</span>\n\n<span class=\"c1\"># Matrice normalizzata</span>\n<span class=\"n\">cm_norm</span> <span class=\"o\">=</span> <span class=\"n\">confusion_matrix</span><span class=\"p\">(</span><span class=\"n\">y_test</span><span class=\"p\">,</span> <span class=\"n\">y_pred</span><span class=\"p\">,</span> <span class=\"n\">normalize</span><span class=\"o\">=</span><span class=\"s1\">&#39;true&#39;</span><span class=\"p\">)</span>\n<span class=\"n\">disp_norm</span> <span class=\"o\">=</span> <span class=\"n\">ConfusionMatrixDisplay</span><span class=\"p\">(</span><span class=\"n\">confusion_matrix</span><span class=\"o\">=</span><span class=\"n\">cm_norm</span><span class=\"p\">,</span> <span class=\"n\">display_labels</span><span class=\"o\">=</span><span class=\"p\">[</span><span class=\"s1\">&#39;Negativo&#39;</span><span class=\"p\">,</span> <span class=\"s1\">&#39;Positivo&#39;</span><span class=\"p\">])</span>\n<span class=\"n\">disp_norm</span><span class=\"o\">.</span><span class=\"n\">plot</span><span class=\"p\">(</span><span class=\"n\">cmap</span><span class=\"o\">=</span><span class=\"s1\">&#39;Greens&#39;</span><span class=\"p\">,</span> <span class=\"n\">ax</span><span class=\"o\">=</span><span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">],</span> <span class=\"n\">values_format</span><span class=\"o\">=</span><span class=\"s1\">&#39;.2%&#39;</span><span class=\"p\">)</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">set_title</span><span class=\"p\">(</span><span class=\"s1\">&#39;Matrice di Confusione (Normalizzata)&#39;</span><span class=\"p\">)</span>\n\n<span class=\"n\">plt</span><span class=\"o\">.</span><span class=\"n\">tight_layout</span><span class=\"p\">()</span>\n<span class=\"n\">plt</span><span class=\"o\">.</span><span class=\"n\">show</span><span class=\"p\">()</span>\n\n<span class=\"n\">tn</span><span class=\"p\">,</span> <span class=\"n\">fp</span><span class=\"p\">,</span> <span class=\"n\">fn</span><span class=\"p\">,</span> <span class=\"n\">tp</span> <span class=\"o\">=</span> <span class=\"n\">cm</span><span class=\"o\">.</span><span class=\"n\">ravel</span><span class=\"p\">()</span>\n<span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"sa\">f</span><span class=\"s2\">&quot;True Positives (TP): </span><span class=\"si\">{</span><span class=\"n\">tp</span><span class=\"si\">}</span><span class=\"s2\">&quot;</span><span class=\"p\">)</span>\n<span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"sa\">f</span><span class=\"s2\">&quot;True Negatives (TN): </span><span class=\"si\">{</span><span class=\"n\">tn</span><span class=\"si\">}</span><span class=\"s2\">&quot;</span><span class=\"p\">)</span>\n<span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"sa\">f</span><span class=\"s2\">&quot;False Positives (FP): </span><span class=\"si\">{</span><span class=\"n\">fp</span><span class=\"si\">}</span><span class=\"s2\">&quot;</span><span class=\"p\">)</span>\n<span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"sa\">f</span><span class=\"s2\">&quot;False Negatives (FN): </span><span class=\"si\">{</span><span class=\"n\">fn</span><span class=\"si\">}</span><span class=\"s2\">&quot;</span><span class=\"p\">)</span>\n</code></pre></div>\n</div>\n</details>\n\n<h3 id=\"23-interpretazione-probabilistica\">2.3 Interpretazione Probabilistica</h3>\n<p>Dato un sistema di classificazione con soglia $\\tau$, possiamo definire due ipotesi:</p>\n<ul>\n<li><strong>H₀</strong>: Le due istanze appartengono a classi diverse (impostor/negativo)</li>\n<li><strong>H₁</strong>: Le due istanze appartengono alla stessa classe (genuine/positivo)</li>\n</ul>\n<p>E due possibili decisioni:</p>\n<ul>\n<li><strong>D₀</strong>: Classificare come negativo/diverso</li>\n<li><strong>D₁</strong>: Classificare come positivo/stesso</li>\n</ul>\n<p>Allora:\n- <strong>FPR</strong> = P(D₁ | H₀ = true) = Probabilità di classificare come positivo quando è negativo\n- <strong>FNR</strong> = P(D₀ | H₁ = true) = Probabilità di classificare come negativo quando è positivo</p>\n<details class=\"code-container\">\n<summary>Code</summary>\n<div class=\"code-wrapper\">\n<button class=\"copy-button\" onclick=\"\n                const code = this.parentElement.querySelector('pre');\n                if (code) {\n                    navigator.clipboard.writeText(code.innerText);\n                    this.textContent = 'Copied!';\n                    setTimeout(() => this.textContent = 'Copy', 2000);\n                }\n            \">Copy</button>\n<div class=\"codehilite\"><pre><span></span><code><span class=\"c1\"># Visualizzazione distribuzioni genuine vs impostor</span>\n<span class=\"kn\">from</span><span class=\"w\"> </span><span class=\"nn\">scipy</span><span class=\"w\"> </span><span class=\"kn\">import</span> <span class=\"n\">stats</span>\n\n<span class=\"n\">fig</span><span class=\"p\">,</span> <span class=\"n\">ax</span> <span class=\"o\">=</span> <span class=\"n\">plt</span><span class=\"o\">.</span><span class=\"n\">subplots</span><span class=\"p\">(</span><span class=\"n\">figsize</span><span class=\"o\">=</span><span class=\"p\">(</span><span class=\"mi\">12</span><span class=\"p\">,</span> <span class=\"mi\">6</span><span class=\"p\">))</span>\n\n<span class=\"c1\"># Simula distribuzioni genuine e impostor</span>\n<span class=\"n\">genuine_scores</span> <span class=\"o\">=</span> <span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">random</span><span class=\"o\">.</span><span class=\"n\">beta</span><span class=\"p\">(</span><span class=\"mi\">8</span><span class=\"p\">,</span> <span class=\"mi\">2</span><span class=\"p\">,</span> <span class=\"mi\">1000</span><span class=\"p\">)</span>\n<span class=\"n\">impostor_scores</span> <span class=\"o\">=</span> <span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">random</span><span class=\"o\">.</span><span class=\"n\">beta</span><span class=\"p\">(</span><span class=\"mi\">2</span><span class=\"p\">,</span> <span class=\"mi\">8</span><span class=\"p\">,</span> <span class=\"mi\">1000</span><span class=\"p\">)</span>\n\n<span class=\"n\">ax</span><span class=\"o\">.</span><span class=\"n\">hist</span><span class=\"p\">(</span><span class=\"n\">impostor_scores</span><span class=\"p\">,</span> <span class=\"n\">bins</span><span class=\"o\">=</span><span class=\"mi\">50</span><span class=\"p\">,</span> <span class=\"n\">alpha</span><span class=\"o\">=</span><span class=\"mf\">0.6</span><span class=\"p\">,</span> <span class=\"n\">label</span><span class=\"o\">=</span><span class=\"s1\">&#39;Impostor (H₀)&#39;</span><span class=\"p\">,</span> <span class=\"n\">color</span><span class=\"o\">=</span><span class=\"s1\">&#39;red&#39;</span><span class=\"p\">,</span> <span class=\"n\">density</span><span class=\"o\">=</span><span class=\"kc\">True</span><span class=\"p\">)</span>\n<span class=\"n\">ax</span><span class=\"o\">.</span><span class=\"n\">hist</span><span class=\"p\">(</span><span class=\"n\">genuine_scores</span><span class=\"p\">,</span> <span class=\"n\">bins</span><span class=\"o\">=</span><span class=\"mi\">50</span><span class=\"p\">,</span> <span class=\"n\">alpha</span><span class=\"o\">=</span><span class=\"mf\">0.6</span><span class=\"p\">,</span> <span class=\"n\">label</span><span class=\"o\">=</span><span class=\"s1\">&#39;Genuine (H₁)&#39;</span><span class=\"p\">,</span> <span class=\"n\">color</span><span class=\"o\">=</span><span class=\"s1\">&#39;green&#39;</span><span class=\"p\">,</span> <span class=\"n\">density</span><span class=\"o\">=</span><span class=\"kc\">True</span><span class=\"p\">)</span>\n\n<span class=\"n\">threshold</span> <span class=\"o\">=</span> <span class=\"mf\">0.5</span>\n<span class=\"n\">ax</span><span class=\"o\">.</span><span class=\"n\">axvline</span><span class=\"p\">(</span><span class=\"n\">threshold</span><span class=\"p\">,</span> <span class=\"n\">color</span><span class=\"o\">=</span><span class=\"s1\">&#39;black&#39;</span><span class=\"p\">,</span> <span class=\"n\">linestyle</span><span class=\"o\">=</span><span class=\"s1\">&#39;--&#39;</span><span class=\"p\">,</span> <span class=\"n\">linewidth</span><span class=\"o\">=</span><span class=\"mi\">2</span><span class=\"p\">,</span> <span class=\"n\">label</span><span class=\"o\">=</span><span class=\"sa\">f</span><span class=\"s1\">&#39;Soglia τ = </span><span class=\"si\">{</span><span class=\"n\">threshold</span><span class=\"si\">}</span><span class=\"s1\">&#39;</span><span class=\"p\">)</span>\n\n<span class=\"c1\"># Area FPR e FNR</span>\n<span class=\"n\">x_fp</span> <span class=\"o\">=</span> <span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">linspace</span><span class=\"p\">(</span><span class=\"n\">threshold</span><span class=\"p\">,</span> <span class=\"mi\">1</span><span class=\"p\">,</span> <span class=\"mi\">100</span><span class=\"p\">)</span>\n<span class=\"n\">x_fn</span> <span class=\"o\">=</span> <span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">linspace</span><span class=\"p\">(</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"n\">threshold</span><span class=\"p\">,</span> <span class=\"mi\">100</span><span class=\"p\">)</span>\n\n<span class=\"n\">ax</span><span class=\"o\">.</span><span class=\"n\">fill_between</span><span class=\"p\">(</span><span class=\"n\">x_fp</span><span class=\"p\">,</span> <span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"n\">stats</span><span class=\"o\">.</span><span class=\"n\">beta</span><span class=\"o\">.</span><span class=\"n\">pdf</span><span class=\"p\">(</span><span class=\"n\">x_fp</span><span class=\"p\">,</span> <span class=\"mi\">2</span><span class=\"p\">,</span> <span class=\"mi\">8</span><span class=\"p\">),</span> <span class=\"n\">alpha</span><span class=\"o\">=</span><span class=\"mf\">0.3</span><span class=\"p\">,</span> <span class=\"n\">color</span><span class=\"o\">=</span><span class=\"s1\">&#39;red&#39;</span><span class=\"p\">,</span> \n                <span class=\"n\">label</span><span class=\"o\">=</span><span class=\"s1\">&#39;FPR (Tipo II)&#39;</span><span class=\"p\">)</span>\n<span class=\"n\">ax</span><span class=\"o\">.</span><span class=\"n\">fill_between</span><span class=\"p\">(</span><span class=\"n\">x_fn</span><span class=\"p\">,</span> <span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"n\">stats</span><span class=\"o\">.</span><span class=\"n\">beta</span><span class=\"o\">.</span><span class=\"n\">pdf</span><span class=\"p\">(</span><span class=\"n\">x_fn</span><span class=\"p\">,</span> <span class=\"mi\">8</span><span class=\"p\">,</span> <span class=\"mi\">2</span><span class=\"p\">),</span> <span class=\"n\">alpha</span><span class=\"o\">=</span><span class=\"mf\">0.3</span><span class=\"p\">,</span> <span class=\"n\">color</span><span class=\"o\">=</span><span class=\"s1\">&#39;orange&#39;</span><span class=\"p\">,</span> \n                <span class=\"n\">label</span><span class=\"o\">=</span><span class=\"s1\">&#39;FNR (Tipo I)&#39;</span><span class=\"p\">)</span>\n\n<span class=\"n\">ax</span><span class=\"o\">.</span><span class=\"n\">set_xlabel</span><span class=\"p\">(</span><span class=\"s1\">&#39;Score di Similarità&#39;</span><span class=\"p\">)</span>\n<span class=\"n\">ax</span><span class=\"o\">.</span><span class=\"n\">set_ylabel</span><span class=\"p\">(</span><span class=\"s1\">&#39;Densità di Probabilità&#39;</span><span class=\"p\">)</span>\n<span class=\"n\">ax</span><span class=\"o\">.</span><span class=\"n\">set_title</span><span class=\"p\">(</span><span class=\"s1\">&#39;Distribuzioni Genuine vs Impostor e Errori al variare della Soglia&#39;</span><span class=\"p\">)</span>\n<span class=\"n\">ax</span><span class=\"o\">.</span><span class=\"n\">legend</span><span class=\"p\">()</span>\n<span class=\"n\">ax</span><span class=\"o\">.</span><span class=\"n\">grid</span><span class=\"p\">(</span><span class=\"n\">alpha</span><span class=\"o\">=</span><span class=\"mf\">0.3</span><span class=\"p\">)</span>\n<span class=\"n\">plt</span><span class=\"o\">.</span><span class=\"n\">show</span><span class=\"p\">()</span>\n</code></pre></div>\n</div>\n</details>\n\n<h2 id=\"3-attenzione-alla-confusione-ml-vs-biometria\">3. ATTENZIONE ALLA CONFUSIONE: ML vs Biometria</h2>\n<h3 id=\"31-confronto-terminologico\">3.1 Confronto Terminologico</h3>\n<p>È <strong>fondamentale</strong> comprendere le differenze tra le metriche di Machine Learning e quelle biometriche, che spesso generano confusione:</p>\n<table>\n<thead>\n<tr>\n<th><strong>Machine Learning</strong></th>\n<th><strong>Biometria</strong></th>\n<th><strong>Significato</strong></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>True Positive (TP)</td>\n<td>Genuine Acceptance (GA) / Genuine Match (GM)</td>\n<td>Positivo correttamente identificato</td>\n</tr>\n<tr>\n<td>True Negative (TN)</td>\n<td>Genuine Rejection (GR) / Genuine Non-Match (GNM)</td>\n<td>Negativo correttamente identificato</td>\n</tr>\n<tr>\n<td>False Positive (FP)</td>\n<td>False Acceptance (FA) / False Match (FM)</td>\n<td>Negativo erroneamente accettato (Tipo II)</td>\n</tr>\n<tr>\n<td>False Negative (FN)</td>\n<td>False Rejection (FR) / False Non-Match (FNM)</td>\n<td>Positivo erroneamente rifiutato (Tipo I)</td>\n</tr>\n</tbody>\n</table>\n<h3 id=\"32-differenze-cruciali-nelle-metriche\">3.2 Differenze Cruciali nelle Metriche</h3>\n<p><strong>PRECISION e RECALL</strong> (ML) vs <strong>FAR e FRR</strong> (Biometria) <strong>NON</strong> esprimono le stesse statistiche di errore!</p>\n<h4 id=\"metriche-machine-learning\">Metriche Machine Learning</h4>\n<p><strong>PRECISION</strong> (Positive Predictive Value):\n$$\\text{Precision} = \\frac{TP}{TP + FP} = \\frac{\\text{Positivi Corretti}}{\\text{Tutti i Predetti Positivi}}$$</p>\n<p><strong>RECALL</strong> (Sensitivity, True Positive Rate):\n$$\\text{Recall} = \\frac{TP}{TP + FN} = \\frac{\\text{Positivi Corretti}}{\\text{Tutti i Reali Positivi}}$$</p>\n<p>Entrambe <strong>partono dalle risposte corrette positive (TP)</strong>!</p>\n<h4 id=\"metriche-biometriche\">Metriche Biometriche</h4>\n<p><strong>FAR</strong> (False Acceptance Rate / False Match Rate):\n$$\\text{FAR} = \\frac{FP}{FP + TN} = \\frac{FA}{FA + GR}$$</p>\n<p>Probabilità che un <strong>impostor</strong> venga accettato. Se FAR = 0.1%, significa che 1 su 1000 impostori riesce ad accedere.</p>\n<p><strong>FRR</strong> (False Rejection Rate / False Non-Match Rate):\n$$\\text{FRR} = \\frac{FN}{FN + TP} = \\frac{FR}{FR + GA}$$</p>\n<p>Probabilità che un <strong>utente genuino</strong> venga rifiutato. Se FRR = 0.05%, significa che 1 su 2000 utenti autorizzati non viene riconosciuto.</p>\n<p>Entrambe <strong>partono dai due tipi di errore (FP e FN)</strong>!</p>\n<h3 id=\"33-equivalenze-con-terminologia-ml-standard\">3.3 Equivalenze con Terminologia ML Standard</h3>\n<p>In termini di Machine Learning:</p>\n<ul>\n<li>\n<p><strong>FRR</strong> ≡ <strong>Miss Rate</strong> ≡ <strong>False Negative Rate (FNR)</strong>\n  $$\\text{FNR} = \\frac{FN}{FN + TP} = 1 - \\text{Recall}$$</p>\n</li>\n<li>\n<p><strong>FAR</strong> ≡ <strong>Fall-Out</strong> ≡ <strong>False Positive Rate (FPR)</strong>\n  $$\\text{FPR} = \\frac{FP}{FP + TN} = 1 - \\text{Specificity}$$</p>\n</li>\n</ul>\n<h3 id=\"34-visualizzazione-comparativa\">3.4 Visualizzazione Comparativa</h3>\n<details class=\"code-container\">\n<summary>Code</summary>\n<div class=\"code-wrapper\">\n<button class=\"copy-button\" onclick=\"\n                const code = this.parentElement.querySelector('pre');\n                if (code) {\n                    navigator.clipboard.writeText(code.innerText);\n                    this.textContent = 'Copied!';\n                    setTimeout(() => this.textContent = 'Copy', 2000);\n                }\n            \">Copy</button>\n<div class=\"codehilite\"><pre><span></span><code><span class=\"n\">fig</span><span class=\"p\">,</span> <span class=\"n\">axes</span> <span class=\"o\">=</span> <span class=\"n\">plt</span><span class=\"o\">.</span><span class=\"n\">subplots</span><span class=\"p\">(</span><span class=\"mi\">2</span><span class=\"p\">,</span> <span class=\"mi\">2</span><span class=\"p\">,</span> <span class=\"n\">figsize</span><span class=\"o\">=</span><span class=\"p\">(</span><span class=\"mi\">14</span><span class=\"p\">,</span> <span class=\"mi\">10</span><span class=\"p\">))</span>\n\n<span class=\"c1\"># Dati di esempio dalla confusion matrix</span>\n<span class=\"n\">labels</span> <span class=\"o\">=</span> <span class=\"p\">[</span><span class=\"s1\">&#39;Precision</span><span class=\"se\">\\n</span><span class=\"s1\">(ML)&#39;</span><span class=\"p\">,</span> <span class=\"s1\">&#39;Recall</span><span class=\"se\">\\n</span><span class=\"s1\">(ML)&#39;</span><span class=\"p\">,</span> <span class=\"s1\">&#39;FAR</span><span class=\"se\">\\n</span><span class=\"s1\">(Biometria)&#39;</span><span class=\"p\">,</span> <span class=\"s1\">&#39;FRR</span><span class=\"se\">\\n</span><span class=\"s1\">(Biometria)&#39;</span><span class=\"p\">]</span>\n<span class=\"n\">formulas</span> <span class=\"o\">=</span> <span class=\"p\">[</span>\n    <span class=\"sa\">f</span><span class=\"s1\">&#39;TP/(TP+FP)</span><span class=\"se\">\\n</span><span class=\"si\">{</span><span class=\"n\">tp</span><span class=\"si\">}</span><span class=\"s1\">/</span><span class=\"si\">{</span><span class=\"n\">tp</span><span class=\"o\">+</span><span class=\"n\">fp</span><span class=\"si\">}</span><span class=\"s1\"> = </span><span class=\"si\">{</span><span class=\"n\">tp</span><span class=\"o\">/</span><span class=\"p\">(</span><span class=\"n\">tp</span><span class=\"o\">+</span><span class=\"n\">fp</span><span class=\"p\">)</span><span class=\"si\">:</span><span class=\"s1\">.3f</span><span class=\"si\">}</span><span class=\"s1\">&#39;</span><span class=\"p\">,</span>\n    <span class=\"sa\">f</span><span class=\"s1\">&#39;TP/(TP+FN)</span><span class=\"se\">\\n</span><span class=\"si\">{</span><span class=\"n\">tp</span><span class=\"si\">}</span><span class=\"s1\">/</span><span class=\"si\">{</span><span class=\"n\">tp</span><span class=\"o\">+</span><span class=\"n\">fn</span><span class=\"si\">}</span><span class=\"s1\"> = </span><span class=\"si\">{</span><span class=\"n\">tp</span><span class=\"o\">/</span><span class=\"p\">(</span><span class=\"n\">tp</span><span class=\"o\">+</span><span class=\"n\">fn</span><span class=\"p\">)</span><span class=\"si\">:</span><span class=\"s1\">.3f</span><span class=\"si\">}</span><span class=\"s1\">&#39;</span><span class=\"p\">,</span>\n    <span class=\"sa\">f</span><span class=\"s1\">&#39;FP/(FP+TN)</span><span class=\"se\">\\n</span><span class=\"si\">{</span><span class=\"n\">fp</span><span class=\"si\">}</span><span class=\"s1\">/</span><span class=\"si\">{</span><span class=\"n\">fp</span><span class=\"o\">+</span><span class=\"n\">tn</span><span class=\"si\">}</span><span class=\"s1\"> = </span><span class=\"si\">{</span><span class=\"n\">fp</span><span class=\"o\">/</span><span class=\"p\">(</span><span class=\"n\">fp</span><span class=\"o\">+</span><span class=\"n\">tn</span><span class=\"p\">)</span><span class=\"si\">:</span><span class=\"s1\">.3f</span><span class=\"si\">}</span><span class=\"s1\">&#39;</span><span class=\"p\">,</span>\n    <span class=\"sa\">f</span><span class=\"s1\">&#39;FN/(FN+TP)</span><span class=\"se\">\\n</span><span class=\"si\">{</span><span class=\"n\">fn</span><span class=\"si\">}</span><span class=\"s1\">/</span><span class=\"si\">{</span><span class=\"n\">fn</span><span class=\"o\">+</span><span class=\"n\">tp</span><span class=\"si\">}</span><span class=\"s1\"> = </span><span class=\"si\">{</span><span class=\"n\">fn</span><span class=\"o\">/</span><span class=\"p\">(</span><span class=\"n\">fn</span><span class=\"o\">+</span><span class=\"n\">tp</span><span class=\"p\">)</span><span class=\"si\">:</span><span class=\"s1\">.3f</span><span class=\"si\">}</span><span class=\"s1\">&#39;</span>\n<span class=\"p\">]</span>\n<span class=\"n\">colors</span> <span class=\"o\">=</span> <span class=\"p\">[</span><span class=\"s1\">&#39;#2ecc71&#39;</span><span class=\"p\">,</span> <span class=\"s1\">&#39;#3498db&#39;</span><span class=\"p\">,</span> <span class=\"s1\">&#39;#e74c3c&#39;</span><span class=\"p\">,</span> <span class=\"s1\">&#39;#f39c12&#39;</span><span class=\"p\">]</span>\n\n<span class=\"c1\"># Grafico 1: Formule a confronto</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"mi\">0</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">axis</span><span class=\"p\">(</span><span class=\"s1\">&#39;off&#39;</span><span class=\"p\">)</span>\n<span class=\"n\">y_pos</span> <span class=\"o\">=</span> <span class=\"p\">[</span><span class=\"mf\">0.8</span><span class=\"p\">,</span> <span class=\"mf\">0.6</span><span class=\"p\">,</span> <span class=\"mf\">0.4</span><span class=\"p\">,</span> <span class=\"mf\">0.2</span><span class=\"p\">]</span>\n<span class=\"k\">for</span> <span class=\"n\">i</span><span class=\"p\">,</span> <span class=\"p\">(</span><span class=\"n\">label</span><span class=\"p\">,</span> <span class=\"n\">formula</span><span class=\"p\">,</span> <span class=\"n\">color</span><span class=\"p\">)</span> <span class=\"ow\">in</span> <span class=\"nb\">enumerate</span><span class=\"p\">(</span><span class=\"nb\">zip</span><span class=\"p\">(</span><span class=\"n\">labels</span><span class=\"p\">,</span> <span class=\"n\">formulas</span><span class=\"p\">,</span> <span class=\"n\">colors</span><span class=\"p\">)):</span>\n    <span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"mi\">0</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">text</span><span class=\"p\">(</span><span class=\"mf\">0.1</span><span class=\"p\">,</span> <span class=\"n\">y_pos</span><span class=\"p\">[</span><span class=\"n\">i</span><span class=\"p\">],</span> <span class=\"sa\">f</span><span class=\"s1\">&#39;</span><span class=\"si\">{</span><span class=\"n\">label</span><span class=\"si\">}</span><span class=\"s1\">:&#39;</span><span class=\"p\">,</span> <span class=\"n\">fontsize</span><span class=\"o\">=</span><span class=\"mi\">12</span><span class=\"p\">,</span> <span class=\"n\">fontweight</span><span class=\"o\">=</span><span class=\"s1\">&#39;bold&#39;</span><span class=\"p\">,</span> <span class=\"n\">color</span><span class=\"o\">=</span><span class=\"n\">color</span><span class=\"p\">)</span>\n    <span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"mi\">0</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">text</span><span class=\"p\">(</span><span class=\"mf\">0.4</span><span class=\"p\">,</span> <span class=\"n\">y_pos</span><span class=\"p\">[</span><span class=\"n\">i</span><span class=\"p\">],</span> <span class=\"n\">formula</span><span class=\"p\">,</span> <span class=\"n\">fontsize</span><span class=\"o\">=</span><span class=\"mi\">11</span><span class=\"p\">,</span> <span class=\"n\">family</span><span class=\"o\">=</span><span class=\"s1\">&#39;monospace&#39;</span><span class=\"p\">)</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"mi\">0</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">set_title</span><span class=\"p\">(</span><span class=\"s1\">&#39;Confronto Formule: ML vs Biometria&#39;</span><span class=\"p\">,</span> <span class=\"n\">fontsize</span><span class=\"o\">=</span><span class=\"mi\">14</span><span class=\"p\">,</span> <span class=\"n\">fontweight</span><span class=\"o\">=</span><span class=\"s1\">&#39;bold&#39;</span><span class=\"p\">)</span>\n\n<span class=\"c1\"># Grafico 2: Cosa misurano</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"mi\">1</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">axis</span><span class=\"p\">(</span><span class=\"s1\">&#39;off&#39;</span><span class=\"p\">)</span>\n<span class=\"n\">descriptions</span> <span class=\"o\">=</span> <span class=\"p\">[</span>\n    <span class=\"s1\">&#39;Quanti predetti</span><span class=\"se\">\\n</span><span class=\"s1\">positivi sono corretti&#39;</span><span class=\"p\">,</span>\n    <span class=\"s1\">&#39;Quanti reali positivi</span><span class=\"se\">\\n</span><span class=\"s1\">sono stati trovati&#39;</span><span class=\"p\">,</span>\n    <span class=\"s1\">&#39;Quanti impostori</span><span class=\"se\">\\n</span><span class=\"s1\">vengono accettati&#39;</span><span class=\"p\">,</span>\n    <span class=\"s1\">&#39;Quanti genuini</span><span class=\"se\">\\n</span><span class=\"s1\">vengono rifiutati&#39;</span>\n<span class=\"p\">]</span>\n<span class=\"k\">for</span> <span class=\"n\">i</span><span class=\"p\">,</span> <span class=\"p\">(</span><span class=\"n\">label</span><span class=\"p\">,</span> <span class=\"n\">desc</span><span class=\"p\">,</span> <span class=\"n\">color</span><span class=\"p\">)</span> <span class=\"ow\">in</span> <span class=\"nb\">enumerate</span><span class=\"p\">(</span><span class=\"nb\">zip</span><span class=\"p\">(</span><span class=\"n\">labels</span><span class=\"p\">,</span> <span class=\"n\">descriptions</span><span class=\"p\">,</span> <span class=\"n\">colors</span><span class=\"p\">)):</span>\n    <span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"mi\">1</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">text</span><span class=\"p\">(</span><span class=\"mf\">0.1</span><span class=\"p\">,</span> <span class=\"n\">y_pos</span><span class=\"p\">[</span><span class=\"n\">i</span><span class=\"p\">],</span> <span class=\"n\">label</span><span class=\"p\">,</span> <span class=\"n\">fontsize</span><span class=\"o\">=</span><span class=\"mi\">11</span><span class=\"p\">,</span> <span class=\"n\">fontweight</span><span class=\"o\">=</span><span class=\"s1\">&#39;bold&#39;</span><span class=\"p\">,</span> <span class=\"n\">color</span><span class=\"o\">=</span><span class=\"n\">color</span><span class=\"p\">)</span>\n    <span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"mi\">1</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">text</span><span class=\"p\">(</span><span class=\"mf\">0.45</span><span class=\"p\">,</span> <span class=\"n\">y_pos</span><span class=\"p\">[</span><span class=\"n\">i</span><span class=\"p\">],</span> <span class=\"n\">desc</span><span class=\"p\">,</span> <span class=\"n\">fontsize</span><span class=\"o\">=</span><span class=\"mi\">10</span><span class=\"p\">)</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"mi\">1</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">set_title</span><span class=\"p\">(</span><span class=\"s1\">&#39;Cosa Misurano&#39;</span><span class=\"p\">,</span> <span class=\"n\">fontsize</span><span class=\"o\">=</span><span class=\"mi\">14</span><span class=\"p\">,</span> <span class=\"n\">fontweight</span><span class=\"o\">=</span><span class=\"s1\">&#39;bold&#39;</span><span class=\"p\">)</span>\n\n<span class=\"c1\"># Grafico 3: Matrice con evidenziazione Precision/Recall</span>\n<span class=\"n\">cm_display</span> <span class=\"o\">=</span> <span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">array</span><span class=\"p\">(<span class=\"text-gray-600\"></span><span class=\"n\">tn</span><span class=\"p\">,</span> <span class=\"n\">fp</span><span class=\"p\">],</span> <span class=\"p\">[</span><span class=\"n\">fn</span><span class=\"p\">,</span> <span class=\"n\">tp</span><span class=\"p\"></span>)</span>\n<span class=\"n\">im1</span> <span class=\"o\">=</span> <span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">,</span> <span class=\"mi\">0</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">imshow</span><span class=\"p\">(</span><span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">zeros</span><span class=\"p\">((</span><span class=\"mi\">2</span><span class=\"p\">,</span> <span class=\"mi\">2</span><span class=\"p\">)),</span> <span class=\"n\">cmap</span><span class=\"o\">=</span><span class=\"s1\">&#39;Greys&#39;</span><span class=\"p\">,</span> <span class=\"n\">alpha</span><span class=\"o\">=</span><span class=\"mf\">0.1</span><span class=\"p\">)</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">,</span> <span class=\"mi\">0</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">text</span><span class=\"p\">(</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"sa\">f</span><span class=\"s1\">&#39;TN</span><span class=\"se\">\\n</span><span class=\"si\">{</span><span class=\"n\">tn</span><span class=\"si\">}</span><span class=\"s1\">&#39;</span><span class=\"p\">,</span> <span class=\"n\">ha</span><span class=\"o\">=</span><span class=\"s1\">&#39;center&#39;</span><span class=\"p\">,</span> <span class=\"n\">va</span><span class=\"o\">=</span><span class=\"s1\">&#39;center&#39;</span><span class=\"p\">,</span> <span class=\"n\">fontsize</span><span class=\"o\">=</span><span class=\"mi\">14</span><span class=\"p\">)</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">,</span> <span class=\"mi\">0</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">text</span><span class=\"p\">(</span><span class=\"mi\">1</span><span class=\"p\">,</span> <span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"sa\">f</span><span class=\"s1\">&#39;FP</span><span class=\"se\">\\n</span><span class=\"si\">{</span><span class=\"n\">fp</span><span class=\"si\">}</span><span class=\"s1\">&#39;</span><span class=\"p\">,</span> <span class=\"n\">ha</span><span class=\"o\">=</span><span class=\"s1\">&#39;center&#39;</span><span class=\"p\">,</span> <span class=\"n\">va</span><span class=\"o\">=</span><span class=\"s1\">&#39;center&#39;</span><span class=\"p\">,</span> <span class=\"n\">fontsize</span><span class=\"o\">=</span><span class=\"mi\">14</span><span class=\"p\">,</span> \n               <span class=\"n\">bbox</span><span class=\"o\">=</span><span class=\"nb\">dict</span><span class=\"p\">(</span><span class=\"n\">boxstyle</span><span class=\"o\">=</span><span class=\"s1\">&#39;round&#39;</span><span class=\"p\">,</span> <span class=\"n\">facecolor</span><span class=\"o\">=</span><span class=\"s1\">&#39;lightcoral&#39;</span><span class=\"p\">,</span> <span class=\"n\">alpha</span><span class=\"o\">=</span><span class=\"mf\">0.7</span><span class=\"p\">))</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">,</span> <span class=\"mi\">0</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">text</span><span class=\"p\">(</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"mi\">1</span><span class=\"p\">,</span> <span class=\"sa\">f</span><span class=\"s1\">&#39;FN</span><span class=\"se\">\\n</span><span class=\"si\">{</span><span class=\"n\">fn</span><span class=\"si\">}</span><span class=\"s1\">&#39;</span><span class=\"p\">,</span> <span class=\"n\">ha</span><span class=\"o\">=</span><span class=\"s1\">&#39;center&#39;</span><span class=\"p\">,</span> <span class=\"n\">va</span><span class=\"o\">=</span><span class=\"s1\">&#39;center&#39;</span><span class=\"p\">,</span> <span class=\"n\">fontsize</span><span class=\"o\">=</span><span class=\"mi\">14</span><span class=\"p\">,</span>\n               <span class=\"n\">bbox</span><span class=\"o\">=</span><span class=\"nb\">dict</span><span class=\"p\">(</span><span class=\"n\">boxstyle</span><span class=\"o\">=</span><span class=\"s1\">&#39;round&#39;</span><span class=\"p\">,</span> <span class=\"n\">facecolor</span><span class=\"o\">=</span><span class=\"s1\">&#39;lightyellow&#39;</span><span class=\"p\">,</span> <span class=\"n\">alpha</span><span class=\"o\">=</span><span class=\"mf\">0.7</span><span class=\"p\">))</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">,</span> <span class=\"mi\">0</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">text</span><span class=\"p\">(</span><span class=\"mi\">1</span><span class=\"p\">,</span> <span class=\"mi\">1</span><span class=\"p\">,</span> <span class=\"sa\">f</span><span class=\"s1\">&#39;TP</span><span class=\"se\">\\n</span><span class=\"si\">{</span><span class=\"n\">tp</span><span class=\"si\">}</span><span class=\"s1\">&#39;</span><span class=\"p\">,</span> <span class=\"n\">ha</span><span class=\"o\">=</span><span class=\"s1\">&#39;center&#39;</span><span class=\"p\">,</span> <span class=\"n\">va</span><span class=\"o\">=</span><span class=\"s1\">&#39;center&#39;</span><span class=\"p\">,</span> <span class=\"n\">fontsize</span><span class=\"o\">=</span><span class=\"mi\">14</span><span class=\"p\">,</span>\n               <span class=\"n\">bbox</span><span class=\"o\">=</span><span class=\"nb\">dict</span><span class=\"p\">(</span><span class=\"n\">boxstyle</span><span class=\"o\">=</span><span class=\"s1\">&#39;round&#39;</span><span class=\"p\">,</span> <span class=\"n\">facecolor</span><span class=\"o\">=</span><span class=\"s1\">&#39;lightgreen&#39;</span><span class=\"p\">,</span> <span class=\"n\">alpha</span><span class=\"o\">=</span><span class=\"mf\">0.7</span><span class=\"p\">))</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">,</span> <span class=\"mi\">0</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">set_xticks</span><span class=\"p\">([</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"mi\">1</span><span class=\"p\">])</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">,</span> <span class=\"mi\">0</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">set_yticks</span><span class=\"p\">([</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"mi\">1</span><span class=\"p\">])</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">,</span> <span class=\"mi\">0</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">set_xticklabels</span><span class=\"p\">([</span><span class=\"s1\">&#39;Pred: Neg&#39;</span><span class=\"p\">,</span> <span class=\"s1\">&#39;Pred: Pos&#39;</span><span class=\"p\">])</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">,</span> <span class=\"mi\">0</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">set_yticklabels</span><span class=\"p\">([</span><span class=\"s1\">&#39;Real: Neg&#39;</span><span class=\"p\">,</span> <span class=\"s1\">&#39;Real: Pos&#39;</span><span class=\"p\">])</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">,</span> <span class=\"mi\">0</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">set_title</span><span class=\"p\">(</span><span class=\"s1\">&#39;Precision (verde+rosso) &amp; Recall (verde+giallo)&#39;</span><span class=\"p\">,</span> <span class=\"n\">fontweight</span><span class=\"o\">=</span><span class=\"s1\">&#39;bold&#39;</span><span class=\"p\">)</span>\n\n<span class=\"c1\"># Grafico 4: Matrice con evidenziazione FAR/FRR</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">,</span> <span class=\"mi\">1</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">imshow</span><span class=\"p\">(</span><span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">zeros</span><span class=\"p\">((</span><span class=\"mi\">2</span><span class=\"p\">,</span> <span class=\"mi\">2</span><span class=\"p\">)),</span> <span class=\"n\">cmap</span><span class=\"o\">=</span><span class=\"s1\">&#39;Greys&#39;</span><span class=\"p\">,</span> <span class=\"n\">alpha</span><span class=\"o\">=</span><span class=\"mf\">0.1</span><span class=\"p\">)</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">,</span> <span class=\"mi\">1</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">text</span><span class=\"p\">(</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"sa\">f</span><span class=\"s1\">&#39;TN</span><span class=\"se\">\\n</span><span class=\"si\">{</span><span class=\"n\">tn</span><span class=\"si\">}</span><span class=\"s1\">&#39;</span><span class=\"p\">,</span> <span class=\"n\">ha</span><span class=\"o\">=</span><span class=\"s1\">&#39;center&#39;</span><span class=\"p\">,</span> <span class=\"n\">va</span><span class=\"o\">=</span><span class=\"s1\">&#39;center&#39;</span><span class=\"p\">,</span> <span class=\"n\">fontsize</span><span class=\"o\">=</span><span class=\"mi\">14</span><span class=\"p\">,</span>\n               <span class=\"n\">bbox</span><span class=\"o\">=</span><span class=\"nb\">dict</span><span class=\"p\">(</span><span class=\"n\">boxstyle</span><span class=\"o\">=</span><span class=\"s1\">&#39;round&#39;</span><span class=\"p\">,</span> <span class=\"n\">facecolor</span><span class=\"o\">=</span><span class=\"s1\">&#39;lightblue&#39;</span><span class=\"p\">,</span> <span class=\"n\">alpha</span><span class=\"o\">=</span><span class=\"mf\">0.7</span><span class=\"p\">))</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">,</span> <span class=\"mi\">1</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">text</span><span class=\"p\">(</span><span class=\"mi\">1</span><span class=\"p\">,</span> <span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"sa\">f</span><span class=\"s1\">&#39;FP</span><span class=\"se\">\\n</span><span class=\"si\">{</span><span class=\"n\">fp</span><span class=\"si\">}</span><span class=\"s1\">&#39;</span><span class=\"p\">,</span> <span class=\"n\">ha</span><span class=\"o\">=</span><span class=\"s1\">&#39;center&#39;</span><span class=\"p\">,</span> <span class=\"n\">va</span><span class=\"o\">=</span><span class=\"s1\">&#39;center&#39;</span><span class=\"p\">,</span> <span class=\"n\">fontsize</span><span class=\"o\">=</span><span class=\"mi\">14</span><span class=\"p\">,</span>\n               <span class=\"n\">bbox</span><span class=\"o\">=</span><span class=\"nb\">dict</span><span class=\"p\">(</span><span class=\"n\">boxstyle</span><span class=\"o\">=</span><span class=\"s1\">&#39;round&#39;</span><span class=\"p\">,</span> <span class=\"n\">facecolor</span><span class=\"o\">=</span><span class=\"s1\">&#39;lightcoral&#39;</span><span class=\"p\">,</span> <span class=\"n\">alpha</span><span class=\"o\">=</span><span class=\"mf\">0.7</span><span class=\"p\">))</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">,</span> <span class=\"mi\">1</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">text</span><span class=\"p\">(</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"mi\">1</span><span class=\"p\">,</span> <span class=\"sa\">f</span><span class=\"s1\">&#39;FN</span><span class=\"se\">\\n</span><span class=\"si\">{</span><span class=\"n\">fn</span><span class=\"si\">}</span><span class=\"s1\">&#39;</span><span class=\"p\">,</span> <span class=\"n\">ha</span><span class=\"o\">=</span><span class=\"s1\">&#39;center&#39;</span><span class=\"p\">,</span> <span class=\"n\">va</span><span class=\"o\">=</span><span class=\"s1\">&#39;center&#39;</span><span class=\"p\">,</span> <span class=\"n\">fontsize</span><span class=\"o\">=</span><span class=\"mi\">14</span><span class=\"p\">,</span>\n               <span class=\"n\">bbox</span><span class=\"o\">=</span><span class=\"nb\">dict</span><span class=\"p\">(</span><span class=\"n\">boxstyle</span><span class=\"o\">=</span><span class=\"s1\">&#39;round&#39;</span><span class=\"p\">,</span> <span class=\"n\">facecolor</span><span class=\"o\">=</span><span class=\"s1\">&#39;lightyellow&#39;</span><span class=\"p\">,</span> <span class=\"n\">alpha</span><span class=\"o\">=</span><span class=\"mf\">0.7</span><span class=\"p\">))</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">,</span> <span class=\"mi\">1</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">text</span><span class=\"p\">(</span><span class=\"mi\">1</span><span class=\"p\">,</span> <span class=\"mi\">1</span><span class=\"p\">,</span> <span class=\"sa\">f</span><span class=\"s1\">&#39;TP</span><span class=\"se\">\\n</span><span class=\"si\">{</span><span class=\"n\">tp</span><span class=\"si\">}</span><span class=\"s1\">&#39;</span><span class=\"p\">,</span> <span class=\"n\">ha</span><span class=\"o\">=</span><span class=\"s1\">&#39;center&#39;</span><span class=\"p\">,</span> <span class=\"n\">va</span><span class=\"o\">=</span><span class=\"s1\">&#39;center&#39;</span><span class=\"p\">,</span> <span class=\"n\">fontsize</span><span class=\"o\">=</span><span class=\"mi\">14</span><span class=\"p\">,</span>\n               <span class=\"n\">bbox</span><span class=\"o\">=</span><span class=\"nb\">dict</span><span class=\"p\">(</span><span class=\"n\">boxstyle</span><span class=\"o\">=</span><span class=\"s1\">&#39;round&#39;</span><span class=\"p\">,</span> <span class=\"n\">facecolor</span><span class=\"o\">=</span><span class=\"s1\">&#39;lightgreen&#39;</span><span class=\"p\">,</span> <span class=\"n\">alpha</span><span class=\"o\">=</span><span class=\"mf\">0.7</span><span class=\"p\">))</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">,</span> <span class=\"mi\">1</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">set_xticks</span><span class=\"p\">([</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"mi\">1</span><span class=\"p\">])</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">,</span> <span class=\"mi\">1</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">set_yticks</span><span class=\"p\">([</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"mi\">1</span><span class=\"p\">])</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">,</span> <span class=\"mi\">1</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">set_xticklabels</span><span class=\"p\">([</span><span class=\"s1\">&#39;Pred: Neg&#39;</span><span class=\"p\">,</span> <span class=\"s1\">&#39;Pred: Pos&#39;</span><span class=\"p\">])</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">,</span> <span class=\"mi\">1</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">set_yticklabels</span><span class=\"p\">([</span><span class=\"s1\">&#39;Real: Neg&#39;</span><span class=\"p\">,</span> <span class=\"s1\">&#39;Real: Pos&#39;</span><span class=\"p\">])</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">,</span> <span class=\"mi\">1</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">set_title</span><span class=\"p\">(</span><span class=\"s1\">&#39;FAR (rosso+blu) &amp; FRR (giallo+verde)&#39;</span><span class=\"p\">,</span> <span class=\"n\">fontweight</span><span class=\"o\">=</span><span class=\"s1\">&#39;bold&#39;</span><span class=\"p\">)</span>\n\n<span class=\"n\">plt</span><span class=\"o\">.</span><span class=\"n\">tight_layout</span><span class=\"p\">()</span>\n<span class=\"n\">plt</span><span class=\"o\">.</span><span class=\"n\">show</span><span class=\"p\">()</span>\n</code></pre></div>\n</div>\n</details>\n\n<h3 id=\"35-tabella-riassuntiva-delle-differenze\">3.5 Tabella Riassuntiva delle Differenze</h3>\n<details class=\"code-container\">\n<summary>Code</summary>\n<div class=\"code-wrapper\">\n<button class=\"copy-button\" onclick=\"\n                const code = this.parentElement.querySelector('pre');\n                if (code) {\n                    navigator.clipboard.writeText(code.innerText);\n                    this.textContent = 'Copied!';\n                    setTimeout(() => this.textContent = 'Copy', 2000);\n                }\n            \">Copy</button>\n<div class=\"codehilite\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"nn\">pandas</span><span class=\"w\"> </span><span class=\"k\">as</span><span class=\"w\"> </span><span class=\"nn\">pd</span>\n\n<span class=\"n\">comparison_data</span> <span class=\"o\">=</span> <span class=\"p\">{</span>\n    <span class=\"s1\">&#39;Metrica&#39;</span><span class=\"p\">:</span> <span class=\"p\">[</span><span class=\"s1\">&#39;Precision&#39;</span><span class=\"p\">,</span> <span class=\"s1\">&#39;Recall&#39;</span><span class=\"p\">,</span> <span class=\"s1\">&#39;FAR&#39;</span><span class=\"p\">,</span> <span class=\"s1\">&#39;FRR&#39;</span><span class=\"p\">],</span>\n    <span class=\"s1\">&#39;Formula&#39;</span><span class=\"p\">:</span> <span class=\"p\">[</span><span class=\"s1\">&#39;TP/(TP+FP)&#39;</span><span class=\"p\">,</span> <span class=\"s1\">&#39;TP/(TP+FN)&#39;</span><span class=\"p\">,</span> <span class=\"s1\">&#39;FP/(FP+TN)&#39;</span><span class=\"p\">,</span> <span class=\"s1\">&#39;FN/(FN+TP)&#39;</span><span class=\"p\">],</span>\n    <span class=\"s1\">&#39;Equivalente Biometria&#39;</span><span class=\"p\">:</span> <span class=\"p\">[</span><span class=\"s1\">&#39;GA/(FA+GA)&#39;</span><span class=\"p\">,</span> <span class=\"s1\">&#39;GA/(GA+FR)&#39;</span><span class=\"p\">,</span> <span class=\"s1\">&#39;FA/(FA+GR)&#39;</span><span class=\"p\">,</span> <span class=\"s1\">&#39;FR/(FR+GA)&#39;</span><span class=\"p\">],</span>\n    <span class=\"s1\">&#39;Parte da&#39;</span><span class=\"p\">:</span> <span class=\"p\">[</span><span class=\"s1\">&#39;TP corretti&#39;</span><span class=\"p\">,</span> <span class=\"s1\">&#39;TP corretti&#39;</span><span class=\"p\">,</span> <span class=\"s1\">&#39;FP errori&#39;</span><span class=\"p\">,</span> <span class=\"s1\">&#39;FN errori&#39;</span><span class=\"p\">],</span>\n    <span class=\"s1\">&#39;Focus&#39;</span><span class=\"p\">:</span> <span class=\"p\">[</span><span class=\"s1\">&#39;Pred. Positivi&#39;</span><span class=\"p\">,</span> <span class=\"s1\">&#39;Reali Positivi&#39;</span><span class=\"p\">,</span> <span class=\"s1\">&#39;Reali Negativi&#39;</span><span class=\"p\">,</span> <span class=\"s1\">&#39;Reali Positivi&#39;</span><span class=\"p\">],</span>\n    <span class=\"s1\">&#39;Obiettivo&#39;</span><span class=\"p\">:</span> <span class=\"p\">[</span><span class=\"s1\">&#39;↑ Massimizzare&#39;</span><span class=\"p\">,</span> <span class=\"s1\">&#39;↑ Massimizzare&#39;</span><span class=\"p\">,</span> <span class=\"s1\">&#39;↓ Minimizzare&#39;</span><span class=\"p\">,</span> <span class=\"s1\">&#39;↓ Minimizzare&#39;</span><span class=\"p\">]</span>\n<span class=\"p\">}</span>\n\n<span class=\"n\">df_comparison</span> <span class=\"o\">=</span> <span class=\"n\">pd</span><span class=\"o\">.</span><span class=\"n\">DataFrame</span><span class=\"p\">(</span><span class=\"n\">comparison_data</span><span class=\"p\">)</span>\n<span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"s2\">&quot;</span><span class=\"se\">\\n</span><span class=\"s2\">&quot;</span> <span class=\"o\">+</span> <span class=\"s2\">&quot;=&quot;</span><span class=\"o\">*</span><span class=\"mi\">80</span><span class=\"p\">)</span>\n<span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"s2\">&quot;DIFFERENZE FONDAMENTALI: ML vs BIOMETRIA&quot;</span><span class=\"p\">)</span>\n<span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"s2\">&quot;=&quot;</span><span class=\"o\">*</span><span class=\"mi\">80</span><span class=\"p\">)</span>\n<span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"n\">df_comparison</span><span class=\"o\">.</span><span class=\"n\">to_string</span><span class=\"p\">(</span><span class=\"n\">index</span><span class=\"o\">=</span><span class=\"kc\">False</span><span class=\"p\">))</span>\n<span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"s2\">&quot;=&quot;</span><span class=\"o\">*</span><span class=\"mi\">80</span><span class=\"p\">)</span>\n<span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"s2\">&quot;</span><span class=\"se\">\\n</span><span class=\"s2\">NOTA CRITICA:&quot;</span><span class=\"p\">)</span>\n<span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"s2\">&quot;• Precision e Recall misurano la QUALITÀ delle predizioni positive&quot;</span><span class=\"p\">)</span>\n<span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"s2\">&quot;• FAR e FRR misurano i TASSI DI ERRORE del sistema&quot;</span><span class=\"p\">)</span>\n<span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"s2\">&quot;• Non sono intercambiabili nelle valutazioni!&quot;</span><span class=\"p\">)</span>\n<span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"s2\">&quot;=&quot;</span><span class=\"o\">*</span><span class=\"mi\">80</span><span class=\"p\">)</span>\n</code></pre></div>\n</div>\n</details>\n\n<h2 id=\"4-metriche-fondamentali-di-machine-learning\">4. Metriche Fondamentali di Machine Learning</h2>\n<h3 id=\"41-accuracy-accuratezza\">4.1 Accuracy (Accuratezza)</h3>\n<p>L&rsquo;<strong>accuracy</strong> misura la proporzione di predizioni corrette sul totale:</p>\n$$\\text{Accuracy} = \\frac{TP + TN}{TP + TN + FP + FN}$$\n<p><strong>Vantaggi</strong>: Intuitiva e semplice<br />\n<strong>Svantaggi</strong>: Inadeguata per dataset sbilanciati (può essere alta anche con un modello che predice sempre la classe maggioritaria)</p>\n<details class=\"code-container\">\n<summary>Code</summary>\n<div class=\"code-wrapper\">\n<button class=\"copy-button\" onclick=\"\n                const code = this.parentElement.querySelector('pre');\n                if (code) {\n                    navigator.clipboard.writeText(code.innerText);\n                    this.textContent = 'Copied!';\n                    setTimeout(() => this.textContent = 'Copy', 2000);\n                }\n            \">Copy</button>\n<div class=\"codehilite\"><pre><span></span><code><span class=\"kn\">from</span><span class=\"w\"> </span><span class=\"nn\">sklearn.metrics</span><span class=\"w\"> </span><span class=\"kn\">import</span> <span class=\"n\">accuracy_score</span>\n\n<span class=\"n\">accuracy</span> <span class=\"o\">=</span> <span class=\"n\">accuracy_score</span><span class=\"p\">(</span><span class=\"n\">y_test</span><span class=\"p\">,</span> <span class=\"n\">y_pred</span><span class=\"p\">)</span>\n<span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"sa\">f</span><span class=\"s1\">&#39;Accuracy: </span><span class=\"si\">{</span><span class=\"n\">accuracy</span><span class=\"si\">:</span><span class=\"s1\">.4f</span><span class=\"si\">}</span><span class=\"s1\">&#39;</span><span class=\"p\">)</span>\n\n<span class=\"c1\"># Visualizzazione impatto dello sbilanciamento</span>\n<span class=\"n\">class_ratios</span> <span class=\"o\">=</span> <span class=\"p\">[</span><span class=\"mf\">0.5</span><span class=\"p\">,</span> <span class=\"mf\">0.7</span><span class=\"p\">,</span> <span class=\"mf\">0.9</span><span class=\"p\">,</span> <span class=\"mf\">0.95</span><span class=\"p\">,</span> <span class=\"mf\">0.99</span><span class=\"p\">]</span>\n<span class=\"n\">dummy_accuracies</span> <span class=\"o\">=</span> <span class=\"n\">class_ratios</span>\n\n<span class=\"n\">fig</span><span class=\"p\">,</span> <span class=\"n\">ax</span> <span class=\"o\">=</span> <span class=\"n\">plt</span><span class=\"o\">.</span><span class=\"n\">subplots</span><span class=\"p\">(</span><span class=\"n\">figsize</span><span class=\"o\">=</span><span class=\"p\">(</span><span class=\"mi\">10</span><span class=\"p\">,</span> <span class=\"mi\">6</span><span class=\"p\">))</span>\n<span class=\"n\">ax</span><span class=\"o\">.</span><span class=\"n\">plot</span><span class=\"p\">(</span><span class=\"n\">class_ratios</span><span class=\"p\">,</span> <span class=\"n\">dummy_accuracies</span><span class=\"p\">,</span> <span class=\"s1\">&#39;o-&#39;</span><span class=\"p\">,</span> <span class=\"n\">linewidth</span><span class=\"o\">=</span><span class=\"mi\">2</span><span class=\"p\">,</span> <span class=\"n\">markersize</span><span class=\"o\">=</span><span class=\"mi\">8</span><span class=\"p\">,</span> \n        <span class=\"n\">label</span><span class=\"o\">=</span><span class=\"s1\">&#39;Accuracy modello &quot;dummy&quot; (predice sempre classe maggioritaria)&#39;</span><span class=\"p\">)</span>\n<span class=\"n\">ax</span><span class=\"o\">.</span><span class=\"n\">axhline</span><span class=\"p\">(</span><span class=\"n\">accuracy</span><span class=\"p\">,</span> <span class=\"n\">color</span><span class=\"o\">=</span><span class=\"s1\">&#39;red&#39;</span><span class=\"p\">,</span> <span class=\"n\">linestyle</span><span class=\"o\">=</span><span class=\"s1\">&#39;--&#39;</span><span class=\"p\">,</span> <span class=\"n\">linewidth</span><span class=\"o\">=</span><span class=\"mi\">2</span><span class=\"p\">,</span> \n          <span class=\"n\">label</span><span class=\"o\">=</span><span class=\"sa\">f</span><span class=\"s1\">&#39;Accuracy modello reale: </span><span class=\"si\">{</span><span class=\"n\">accuracy</span><span class=\"si\">:</span><span class=\"s1\">.3f</span><span class=\"si\">}</span><span class=\"s1\">&#39;</span><span class=\"p\">)</span>\n<span class=\"n\">ax</span><span class=\"o\">.</span><span class=\"n\">set_xlabel</span><span class=\"p\">(</span><span class=\"s1\">&#39;Proporzione Classe Maggioritaria&#39;</span><span class=\"p\">,</span> <span class=\"n\">fontsize</span><span class=\"o\">=</span><span class=\"mi\">12</span><span class=\"p\">)</span>\n<span class=\"n\">ax</span><span class=\"o\">.</span><span class=\"n\">set_ylabel</span><span class=\"p\">(</span><span class=\"s1\">&#39;Accuracy&#39;</span><span class=\"p\">,</span> <span class=\"n\">fontsize</span><span class=\"o\">=</span><span class=\"mi\">12</span><span class=\"p\">)</span>\n<span class=\"n\">ax</span><span class=\"o\">.</span><span class=\"n\">set_title</span><span class=\"p\">(</span><span class=\"s1\">&#39;Accuracy può essere ingannevole con dataset sbilanciati!&#39;</span><span class=\"p\">,</span> <span class=\"n\">fontsize</span><span class=\"o\">=</span><span class=\"mi\">14</span><span class=\"p\">)</span>\n<span class=\"n\">ax</span><span class=\"o\">.</span><span class=\"n\">legend</span><span class=\"p\">()</span>\n<span class=\"n\">ax</span><span class=\"o\">.</span><span class=\"n\">grid</span><span class=\"p\">(</span><span class=\"n\">alpha</span><span class=\"o\">=</span><span class=\"mf\">0.3</span><span class=\"p\">)</span>\n<span class=\"n\">plt</span><span class=\"o\">.</span><span class=\"n\">show</span><span class=\"p\">()</span>\n</code></pre></div>\n</div>\n</details>\n\n<h3 id=\"42-precision-precisione\">4.2 Precision (Precisione)</h3>\n<p>La <strong>precision</strong> misura la proporzione di predizioni positive che sono effettivamente corrette:</p>\n$$\\text{Precision} = \\frac{TP}{TP + FP}$$\n<p>Risponde alla domanda: <em>&ldquo;Tra tutti i casi predetti come positivi, quanti sono realmente positivi?&rdquo;</em></p>\n<p><strong>Quando è critica</strong>: Alto costo dei falsi positivi (es. spam detection, diagnosi mediche che richiedono trattamenti invasivi)</p>\n<p><strong>Equivalente biometrico</strong>: Positive Predictive Value = GA/(FA+GA)</p>\n<details class=\"code-container\">\n<summary>Code</summary>\n<div class=\"code-wrapper\">\n<button class=\"copy-button\" onclick=\"\n                const code = this.parentElement.querySelector('pre');\n                if (code) {\n                    navigator.clipboard.writeText(code.innerText);\n                    this.textContent = 'Copied!';\n                    setTimeout(() => this.textContent = 'Copy', 2000);\n                }\n            \">Copy</button>\n<div class=\"codehilite\"><pre><span></span><code><span class=\"kn\">from</span><span class=\"w\"> </span><span class=\"nn\">sklearn.metrics</span><span class=\"w\"> </span><span class=\"kn\">import</span> <span class=\"n\">precision_score</span>\n\n<span class=\"n\">precision</span> <span class=\"o\">=</span> <span class=\"n\">precision_score</span><span class=\"p\">(</span><span class=\"n\">y_test</span><span class=\"p\">,</span> <span class=\"n\">y_pred</span><span class=\"p\">)</span>\n<span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"sa\">f</span><span class=\"s1\">&#39;Precision: </span><span class=\"si\">{</span><span class=\"n\">precision</span><span class=\"si\">:</span><span class=\"s1\">.4f</span><span class=\"si\">}</span><span class=\"s1\">&#39;</span><span class=\"p\">)</span>\n\n<span class=\"c1\"># Visualizzazione interpretazione</span>\n<span class=\"n\">fig</span><span class=\"p\">,</span> <span class=\"n\">ax</span> <span class=\"o\">=</span> <span class=\"n\">plt</span><span class=\"o\">.</span><span class=\"n\">subplots</span><span class=\"p\">(</span><span class=\"n\">figsize</span><span class=\"o\">=</span><span class=\"p\">(</span><span class=\"mi\">10</span><span class=\"p\">,</span> <span class=\"mi\">6</span><span class=\"p\">))</span>\n<span class=\"n\">categories</span> <span class=\"o\">=</span> <span class=\"p\">[</span><span class=\"s1\">&#39;Predetti</span><span class=\"se\">\\n</span><span class=\"s1\">Positivi&#39;</span><span class=\"p\">,</span> <span class=\"s1\">&#39;di cui Veri</span><span class=\"se\">\\n</span><span class=\"s1\">Positivi (TP)&#39;</span><span class=\"p\">,</span> <span class=\"s1\">&#39;di cui Falsi</span><span class=\"se\">\\n</span><span class=\"s1\">Positivi (FP)&#39;</span><span class=\"p\">]</span>\n<span class=\"n\">values</span> <span class=\"o\">=</span> <span class=\"p\">[</span><span class=\"n\">tp</span> <span class=\"o\">+</span> <span class=\"n\">fp</span><span class=\"p\">,</span> <span class=\"n\">tp</span><span class=\"p\">,</span> <span class=\"n\">fp</span><span class=\"p\">]</span>\n<span class=\"n\">colors</span> <span class=\"o\">=</span> <span class=\"p\">[</span><span class=\"s1\">&#39;lightblue&#39;</span><span class=\"p\">,</span> <span class=\"s1\">&#39;green&#39;</span><span class=\"p\">,</span> <span class=\"s1\">&#39;red&#39;</span><span class=\"p\">]</span>\n\n<span class=\"n\">bars</span> <span class=\"o\">=</span> <span class=\"n\">ax</span><span class=\"o\">.</span><span class=\"n\">bar</span><span class=\"p\">(</span><span class=\"n\">categories</span><span class=\"p\">,</span> <span class=\"n\">values</span><span class=\"p\">,</span> <span class=\"n\">color</span><span class=\"o\">=</span><span class=\"n\">colors</span><span class=\"p\">,</span> <span class=\"n\">alpha</span><span class=\"o\">=</span><span class=\"mf\">0.7</span><span class=\"p\">,</span> <span class=\"n\">edgecolor</span><span class=\"o\">=</span><span class=\"s1\">&#39;black&#39;</span><span class=\"p\">,</span> <span class=\"n\">linewidth</span><span class=\"o\">=</span><span class=\"mi\">2</span><span class=\"p\">)</span>\n<span class=\"n\">ax</span><span class=\"o\">.</span><span class=\"n\">set_ylabel</span><span class=\"p\">(</span><span class=\"s1\">&#39;Numero di Campioni&#39;</span><span class=\"p\">,</span> <span class=\"n\">fontsize</span><span class=\"o\">=</span><span class=\"mi\">12</span><span class=\"p\">)</span>\n<span class=\"n\">ax</span><span class=\"o\">.</span><span class=\"n\">set_title</span><span class=\"p\">(</span><span class=\"sa\">f</span><span class=\"s1\">&#39;Precision = TP / (TP + FP) = </span><span class=\"si\">{</span><span class=\"n\">tp</span><span class=\"si\">}</span><span class=\"s1\">/</span><span class=\"si\">{</span><span class=\"n\">tp</span><span class=\"o\">+</span><span class=\"n\">fp</span><span class=\"si\">}</span><span class=\"s1\"> = </span><span class=\"si\">{</span><span class=\"n\">precision</span><span class=\"si\">:</span><span class=\"s1\">.3f</span><span class=\"si\">}</span><span class=\"s1\">&#39;</span><span class=\"p\">,</span> <span class=\"n\">fontsize</span><span class=\"o\">=</span><span class=\"mi\">14</span><span class=\"p\">)</span>\n\n<span class=\"k\">for</span> <span class=\"n\">bar</span><span class=\"p\">,</span> <span class=\"n\">val</span> <span class=\"ow\">in</span> <span class=\"nb\">zip</span><span class=\"p\">(</span><span class=\"n\">bars</span><span class=\"p\">,</span> <span class=\"n\">values</span><span class=\"p\">):</span>\n    <span class=\"n\">height</span> <span class=\"o\">=</span> <span class=\"n\">bar</span><span class=\"o\">.</span><span class=\"n\">get_height</span><span class=\"p\">()</span>\n    <span class=\"n\">ax</span><span class=\"o\">.</span><span class=\"n\">text</span><span class=\"p\">(</span><span class=\"n\">bar</span><span class=\"o\">.</span><span class=\"n\">get_x</span><span class=\"p\">()</span> <span class=\"o\">+</span> <span class=\"n\">bar</span><span class=\"o\">.</span><span class=\"n\">get_width</span><span class=\"p\">()</span><span class=\"o\">/</span><span class=\"mf\">2.</span><span class=\"p\">,</span> <span class=\"n\">height</span><span class=\"p\">,</span>\n            <span class=\"sa\">f</span><span class=\"s1\">&#39;</span><span class=\"si\">{</span><span class=\"n\">val</span><span class=\"si\">}</span><span class=\"s1\">&#39;</span><span class=\"p\">,</span> <span class=\"n\">ha</span><span class=\"o\">=</span><span class=\"s1\">&#39;center&#39;</span><span class=\"p\">,</span> <span class=\"n\">va</span><span class=\"o\">=</span><span class=\"s1\">&#39;bottom&#39;</span><span class=\"p\">,</span> <span class=\"n\">fontsize</span><span class=\"o\">=</span><span class=\"mi\">12</span><span class=\"p\">,</span> <span class=\"n\">fontweight</span><span class=\"o\">=</span><span class=\"s1\">&#39;bold&#39;</span><span class=\"p\">)</span>\n\n<span class=\"n\">plt</span><span class=\"o\">.</span><span class=\"n\">tight_layout</span><span class=\"p\">()</span>\n<span class=\"n\">plt</span><span class=\"o\">.</span><span class=\"n\">show</span><span class=\"p\">()</span>\n</code></pre></div>\n</div>\n</details>\n\n<h3 id=\"43-recall-sensibilita-true-positive-rate-tpr\">4.3 Recall (Sensibilità, True Positive Rate, TPR)</h3>\n<p>Il <strong>recall</strong> misura la proporzione di istanze positive che sono state correttamente identificate:</p>\n$$\\text{Recall} = \\text{TPR} = \\text{Sensitivity} = \\frac{TP}{TP + FN}$$\n<p>Risponde alla domanda: <em>&ldquo;Tra tutti i casi realmente positivi, quanti sono stati identificati?&rdquo;</em></p>\n<p><strong>Quando è critico</strong>: Alto costo dei falsi negativi (es. rilevamento tumori, frodi finanziarie, sistemi di sicurezza)</p>\n<p><strong>Equivalente biometrico</strong>: GAR (Genuine Acceptance Rate) = GA/(GA+FR) = 1 - FRR</p>\n<details class=\"code-container\">\n<summary>Code</summary>\n<div class=\"code-wrapper\">\n<button class=\"copy-button\" onclick=\"\n                const code = this.parentElement.querySelector('pre');\n                if (code) {\n                    navigator.clipboard.writeText(code.innerText);\n                    this.textContent = 'Copied!';\n                    setTimeout(() => this.textContent = 'Copy', 2000);\n                }\n            \">Copy</button>\n<div class=\"codehilite\"><pre><span></span><code><span class=\"kn\">from</span><span class=\"w\"> </span><span class=\"nn\">sklearn.metrics</span><span class=\"w\"> </span><span class=\"kn\">import</span> <span class=\"n\">recall_score</span>\n\n<span class=\"n\">recall</span> <span class=\"o\">=</span> <span class=\"n\">recall_score</span><span class=\"p\">(</span><span class=\"n\">y_test</span><span class=\"p\">,</span> <span class=\"n\">y_pred</span><span class=\"p\">)</span>\n<span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"sa\">f</span><span class=\"s1\">&#39;Recall: </span><span class=\"si\">{</span><span class=\"n\">recall</span><span class=\"si\">:</span><span class=\"s1\">.4f</span><span class=\"si\">}</span><span class=\"s1\">&#39;</span><span class=\"p\">)</span>\n\n<span class=\"c1\"># Visualizzazione interpretazione</span>\n<span class=\"n\">fig</span><span class=\"p\">,</span> <span class=\"n\">ax</span> <span class=\"o\">=</span> <span class=\"n\">plt</span><span class=\"o\">.</span><span class=\"n\">subplots</span><span class=\"p\">(</span><span class=\"n\">figsize</span><span class=\"o\">=</span><span class=\"p\">(</span><span class=\"mi\">10</span><span class=\"p\">,</span> <span class=\"mi\">6</span><span class=\"p\">))</span>\n<span class=\"n\">categories</span> <span class=\"o\">=</span> <span class=\"p\">[</span><span class=\"s1\">&#39;Reali</span><span class=\"se\">\\n</span><span class=\"s1\">Positivi&#39;</span><span class=\"p\">,</span> <span class=\"s1\">&#39;di cui Identificati</span><span class=\"se\">\\n</span><span class=\"s1\">(TP)&#39;</span><span class=\"p\">,</span> <span class=\"s1\">&#39;di cui Mancati</span><span class=\"se\">\\n</span><span class=\"s1\">(FN)&#39;</span><span class=\"p\">]</span>\n<span class=\"n\">values</span> <span class=\"o\">=</span> <span class=\"p\">[</span><span class=\"n\">tp</span> <span class=\"o\">+</span> <span class=\"n\">fn</span><span class=\"p\">,</span> <span class=\"n\">tp</span><span class=\"p\">,</span> <span class=\"n\">fn</span><span class=\"p\">]</span>\n<span class=\"n\">colors</span> <span class=\"o\">=</span> <span class=\"p\">[</span><span class=\"s1\">&#39;lightblue&#39;</span><span class=\"p\">,</span> <span class=\"s1\">&#39;green&#39;</span><span class=\"p\">,</span> <span class=\"s1\">&#39;orange&#39;</span><span class=\"p\">]</span>\n\n<span class=\"n\">bars</span> <span class=\"o\">=</span> <span class=\"n\">ax</span><span class=\"o\">.</span><span class=\"n\">bar</span><span class=\"p\">(</span><span class=\"n\">categories</span><span class=\"p\">,</span> <span class=\"n\">values</span><span class=\"p\">,</span> <span class=\"n\">color</span><span class=\"o\">=</span><span class=\"n\">colors</span><span class=\"p\">,</span> <span class=\"n\">alpha</span><span class=\"o\">=</span><span class=\"mf\">0.7</span><span class=\"p\">,</span> <span class=\"n\">edgecolor</span><span class=\"o\">=</span><span class=\"s1\">&#39;black&#39;</span><span class=\"p\">,</span> <span class=\"n\">linewidth</span><span class=\"o\">=</span><span class=\"mi\">2</span><span class=\"p\">)</span>\n<span class=\"n\">ax</span><span class=\"o\">.</span><span class=\"n\">set_ylabel</span><span class=\"p\">(</span><span class=\"s1\">&#39;Numero di Campioni&#39;</span><span class=\"p\">,</span> <span class=\"n\">fontsize</span><span class=\"o\">=</span><span class=\"mi\">12</span><span class=\"p\">)</span>\n<span class=\"n\">ax</span><span class=\"o\">.</span><span class=\"n\">set_title</span><span class=\"p\">(</span><span class=\"sa\">f</span><span class=\"s1\">&#39;Recall = TP / (TP + FN) = </span><span class=\"si\">{</span><span class=\"n\">tp</span><span class=\"si\">}</span><span class=\"s1\">/</span><span class=\"si\">{</span><span class=\"n\">tp</span><span class=\"o\">+</span><span class=\"n\">fn</span><span class=\"si\">}</span><span class=\"s1\"> = </span><span class=\"si\">{</span><span class=\"n\">recall</span><span class=\"si\">:</span><span class=\"s1\">.3f</span><span class=\"si\">}</span><span class=\"s1\">&#39;</span><span class=\"p\">,</span> <span class=\"n\">fontsize</span><span class=\"o\">=</span><span class=\"mi\">14</span><span class=\"p\">)</span>\n\n<span class=\"k\">for</span> <span class=\"n\">bar</span><span class=\"p\">,</span> <span class=\"n\">val</span> <span class=\"ow\">in</span> <span class=\"nb\">zip</span><span class=\"p\">(</span><span class=\"n\">bars</span><span class=\"p\">,</span> <span class=\"n\">values</span><span class=\"p\">):</span>\n    <span class=\"n\">height</span> <span class=\"o\">=</span> <span class=\"n\">bar</span><span class=\"o\">.</span><span class=\"n\">get_height</span><span class=\"p\">()</span>\n    <span class=\"n\">ax</span><span class=\"o\">.</span><span class=\"n\">text</span><span class=\"p\">(</span><span class=\"n\">bar</span><span class=\"o\">.</span><span class=\"n\">get_x</span><span class=\"p\">()</span> <span class=\"o\">+</span> <span class=\"n\">bar</span><span class=\"o\">.</span><span class=\"n\">get_width</span><span class=\"p\">()</span><span class=\"o\">/</span><span class=\"mf\">2.</span><span class=\"p\">,</span> <span class=\"n\">height</span><span class=\"p\">,</span>\n            <span class=\"sa\">f</span><span class=\"s1\">&#39;</span><span class=\"si\">{</span><span class=\"n\">val</span><span class=\"si\">}</span><span class=\"s1\">&#39;</span><span class=\"p\">,</span> <span class=\"n\">ha</span><span class=\"o\">=</span><span class=\"s1\">&#39;center&#39;</span><span class=\"p\">,</span> <span class=\"n\">va</span><span class=\"o\">=</span><span class=\"s1\">&#39;bottom&#39;</span><span class=\"p\">,</span> <span class=\"n\">fontsize</span><span class=\"o\">=</span><span class=\"mi\">12</span><span class=\"p\">,</span> <span class=\"n\">fontweight</span><span class=\"o\">=</span><span class=\"s1\">&#39;bold&#39;</span><span class=\"p\">)</span>\n\n<span class=\"n\">plt</span><span class=\"o\">.</span><span class=\"n\">tight_layout</span><span class=\"p\">()</span>\n<span class=\"n\">plt</span><span class=\"o\">.</span><span class=\"n\">show</span><span class=\"p\">()</span>\n</code></pre></div>\n</div>\n</details>\n\n<h3 id=\"44-specificity-specificita-true-negative-rate\">4.4 Specificity (Specificità, True Negative Rate)</h3>\n<p>La <strong>specificity</strong> misura la proporzione di istanze negative correttamente identificate:</p>\n$$\\text{Specificity} = \\text{TNR} = \\frac{TN}{TN + FP}$$\n<p><strong>Relazione con FPR</strong>:\n$$\\text{FPR} = 1 - \\text{Specificity} = \\frac{FP}{FP + TN}$$</p>\n<details class=\"code-container\">\n<summary>Code</summary>\n<div class=\"code-wrapper\">\n<button class=\"copy-button\" onclick=\"\n                const code = this.parentElement.querySelector('pre');\n                if (code) {\n                    navigator.clipboard.writeText(code.innerText);\n                    this.textContent = 'Copied!';\n                    setTimeout(() => this.textContent = 'Copy', 2000);\n                }\n            \">Copy</button>\n<div class=\"codehilite\"><pre><span></span><code><span class=\"n\">specificity</span> <span class=\"o\">=</span> <span class=\"n\">tn</span> <span class=\"o\">/</span> <span class=\"p\">(</span><span class=\"n\">tn</span> <span class=\"o\">+</span> <span class=\"n\">fp</span><span class=\"p\">)</span>\n<span class=\"n\">fpr</span> <span class=\"o\">=</span> <span class=\"n\">fp</span> <span class=\"o\">/</span> <span class=\"p\">(</span><span class=\"n\">fp</span> <span class=\"o\">+</span> <span class=\"n\">tn</span><span class=\"p\">)</span>\n<span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"sa\">f</span><span class=\"s1\">&#39;Specificity: </span><span class=\"si\">{</span><span class=\"n\">specificity</span><span class=\"si\">:</span><span class=\"s1\">.4f</span><span class=\"si\">}</span><span class=\"s1\">&#39;</span><span class=\"p\">)</span>\n<span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"sa\">f</span><span class=\"s1\">&#39;FPR (1-Specificity): </span><span class=\"si\">{</span><span class=\"n\">fpr</span><span class=\"si\">:</span><span class=\"s1\">.4f</span><span class=\"si\">}</span><span class=\"s1\">&#39;</span><span class=\"p\">)</span>\n</code></pre></div>\n</div>\n</details>\n\n<h3 id=\"45-trade-off-precision-vs-recall\">4.5 Trade-off Precision vs Recall</h3>\n<p>Precision e Recall sono tipicamente in trade-off: migliorare una peggiora l&rsquo;altra.</p>\n<details class=\"code-container\">\n<summary>Code</summary>\n<div class=\"code-wrapper\">\n<button class=\"copy-button\" onclick=\"\n                const code = this.parentElement.querySelector('pre');\n                if (code) {\n                    navigator.clipboard.writeText(code.innerText);\n                    this.textContent = 'Copied!';\n                    setTimeout(() => this.textContent = 'Copy', 2000);\n                }\n            \">Copy</button>\n<div class=\"codehilite\"><pre><span></span><code><span class=\"kn\">from</span><span class=\"w\"> </span><span class=\"nn\">sklearn.metrics</span><span class=\"w\"> </span><span class=\"kn\">import</span> <span class=\"n\">precision_recall_curve</span>\n\n<span class=\"n\">y_proba</span> <span class=\"o\">=</span> <span class=\"n\">clf</span><span class=\"o\">.</span><span class=\"n\">predict_proba</span><span class=\"p\">(</span><span class=\"n\">X_test</span><span class=\"p\">)[:,</span> <span class=\"mi\">1</span><span class=\"p\">]</span>\n<span class=\"n\">precisions</span><span class=\"p\">,</span> <span class=\"n\">recalls</span><span class=\"p\">,</span> <span class=\"n\">thresholds</span> <span class=\"o\">=</span> <span class=\"n\">precision_recall_curve</span><span class=\"p\">(</span><span class=\"n\">y_test</span><span class=\"p\">,</span> <span class=\"n\">y_proba</span><span class=\"p\">)</span>\n\n<span class=\"n\">fig</span><span class=\"p\">,</span> <span class=\"n\">axes</span> <span class=\"o\">=</span> <span class=\"n\">plt</span><span class=\"o\">.</span><span class=\"n\">subplots</span><span class=\"p\">(</span><span class=\"mi\">1</span><span class=\"p\">,</span> <span class=\"mi\">2</span><span class=\"p\">,</span> <span class=\"n\">figsize</span><span class=\"o\">=</span><span class=\"p\">(</span><span class=\"mi\">15</span><span class=\"p\">,</span> <span class=\"mi\">5</span><span class=\"p\">))</span>\n\n<span class=\"c1\"># Curva Precision-Recall</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">plot</span><span class=\"p\">(</span><span class=\"n\">recalls</span><span class=\"p\">,</span> <span class=\"n\">precisions</span><span class=\"p\">,</span> <span class=\"n\">linewidth</span><span class=\"o\">=</span><span class=\"mi\">2</span><span class=\"p\">,</span> <span class=\"n\">color</span><span class=\"o\">=</span><span class=\"s1\">&#39;purple&#39;</span><span class=\"p\">)</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">scatter</span><span class=\"p\">([</span><span class=\"n\">recall</span><span class=\"p\">],</span> <span class=\"p\">[</span><span class=\"n\">precision</span><span class=\"p\">],</span> <span class=\"n\">color</span><span class=\"o\">=</span><span class=\"s1\">&#39;red&#39;</span><span class=\"p\">,</span> <span class=\"n\">s</span><span class=\"o\">=</span><span class=\"mi\">200</span><span class=\"p\">,</span> <span class=\"n\">zorder</span><span class=\"o\">=</span><span class=\"mi\">5</span><span class=\"p\">,</span> \n               <span class=\"n\">label</span><span class=\"o\">=</span><span class=\"sa\">f</span><span class=\"s1\">&#39;Soglia attuale</span><span class=\"se\">\\n</span><span class=\"s1\">P=</span><span class=\"si\">{</span><span class=\"n\">precision</span><span class=\"si\">:</span><span class=\"s1\">.3f</span><span class=\"si\">}</span><span class=\"s1\">, R=</span><span class=\"si\">{</span><span class=\"n\">recall</span><span class=\"si\">:</span><span class=\"s1\">.3f</span><span class=\"si\">}</span><span class=\"s1\">&#39;</span><span class=\"p\">)</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">set_xlabel</span><span class=\"p\">(</span><span class=\"s1\">&#39;Recall&#39;</span><span class=\"p\">,</span> <span class=\"n\">fontsize</span><span class=\"o\">=</span><span class=\"mi\">12</span><span class=\"p\">)</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">set_ylabel</span><span class=\"p\">(</span><span class=\"s1\">&#39;Precision&#39;</span><span class=\"p\">,</span> <span class=\"n\">fontsize</span><span class=\"o\">=</span><span class=\"mi\">12</span><span class=\"p\">)</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">set_title</span><span class=\"p\">(</span><span class=\"s1\">&#39;Trade-off Precision-Recall&#39;</span><span class=\"p\">,</span> <span class=\"n\">fontsize</span><span class=\"o\">=</span><span class=\"mi\">14</span><span class=\"p\">)</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">grid</span><span class=\"p\">(</span><span class=\"n\">alpha</span><span class=\"o\">=</span><span class=\"mf\">0.3</span><span class=\"p\">)</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">legend</span><span class=\"p\">()</span>\n\n<span class=\"c1\"># Precision e Recall vs Soglia</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">plot</span><span class=\"p\">(</span><span class=\"n\">thresholds</span><span class=\"p\">,</span> <span class=\"n\">precisions</span><span class=\"p\">[:</span><span class=\"o\">-</span><span class=\"mi\">1</span><span class=\"p\">],</span> <span class=\"n\">label</span><span class=\"o\">=</span><span class=\"s1\">&#39;Precision&#39;</span><span class=\"p\">,</span> <span class=\"n\">linewidth</span><span class=\"o\">=</span><span class=\"mi\">2</span><span class=\"p\">)</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">plot</span><span class=\"p\">(</span><span class=\"n\">thresholds</span><span class=\"p\">,</span> <span class=\"n\">recalls</span><span class=\"p\">[:</span><span class=\"o\">-</span><span class=\"mi\">1</span><span class=\"p\">],</span> <span class=\"n\">label</span><span class=\"o\">=</span><span class=\"s1\">&#39;Recall&#39;</span><span class=\"p\">,</span> <span class=\"n\">linewidth</span><span class=\"o\">=</span><span class=\"mi\">2</span><span class=\"p\">)</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">set_xlabel</span><span class=\"p\">(</span><span class=\"s1\">&#39;Soglia di Classificazione&#39;</span><span class=\"p\">,</span> <span class=\"n\">fontsize</span><span class=\"o\">=</span><span class=\"mi\">12</span><span class=\"p\">)</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">set_ylabel</span><span class=\"p\">(</span><span class=\"s1\">&#39;Valore Metrica&#39;</span><span class=\"p\">,</span> <span class=\"n\">fontsize</span><span class=\"o\">=</span><span class=\"mi\">12</span><span class=\"p\">)</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">set_title</span><span class=\"p\">(</span><span class=\"s1\">&#39;Precision e Recall al variare della Soglia&#39;</span><span class=\"p\">,</span> <span class=\"n\">fontsize</span><span class=\"o\">=</span><span class=\"mi\">14</span><span class=\"p\">)</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">legend</span><span class=\"p\">()</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">grid</span><span class=\"p\">(</span><span class=\"n\">alpha</span><span class=\"o\">=</span><span class=\"mf\">0.3</span><span class=\"p\">)</span>\n\n<span class=\"n\">plt</span><span class=\"o\">.</span><span class=\"n\">tight_layout</span><span class=\"p\">()</span>\n<span class=\"n\">plt</span><span class=\"o\">.</span><span class=\"n\">show</span><span class=\"p\">()</span>\n</code></pre></div>\n</div>\n</details>\n\n<h3 id=\"46-f1-score\">4.6 F1-Score</h3>\n<p>L&rsquo;<strong>F1-score</strong> è la media armonica di precision e recall, bilanciando i due aspetti:</p>\n$$F_1 = 2 \\cdot \\frac{\\text{Precision} \\cdot \\text{Recall}}{\\text{Precision} + \\text{Recall}} = \\frac{2TP}{2TP + FP + FN}$$\n<p>La media armonica penalizza valori estremi: se Precision o Recall è bassa, anche F1 sarà bassa.</p>\n<p><strong>Perché media armonica?</strong> \n$$\\text{Media Aritmetica} = \\frac{P + R}{2} \\quad \\text{vs} \\quad \\text{Media Armonica} = \\frac{2}{\\frac{1}{P} + \\frac{1}{R}}$$</p>\n<p>La media armonica è più severa con valori sbilanciati.</p>\n<details class=\"code-container\">\n<summary>Code</summary>\n<div class=\"code-wrapper\">\n<button class=\"copy-button\" onclick=\"\n                const code = this.parentElement.querySelector('pre');\n                if (code) {\n                    navigator.clipboard.writeText(code.innerText);\n                    this.textContent = 'Copied!';\n                    setTimeout(() => this.textContent = 'Copy', 2000);\n                }\n            \">Copy</button>\n<div class=\"codehilite\"><pre><span></span><code><span class=\"kn\">from</span><span class=\"w\"> </span><span class=\"nn\">sklearn.metrics</span><span class=\"w\"> </span><span class=\"kn\">import</span> <span class=\"n\">f1_score</span>\n\n<span class=\"n\">f1</span> <span class=\"o\">=</span> <span class=\"n\">f1_score</span><span class=\"p\">(</span><span class=\"n\">y_test</span><span class=\"p\">,</span> <span class=\"n\">y_pred</span><span class=\"p\">)</span>\n<span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"sa\">f</span><span class=\"s1\">&#39;F1-Score: </span><span class=\"si\">{</span><span class=\"n\">f1</span><span class=\"si\">:</span><span class=\"s1\">.4f</span><span class=\"si\">}</span><span class=\"s1\">&#39;</span><span class=\"p\">)</span>\n\n<span class=\"c1\"># Confronto medie</span>\n<span class=\"n\">test_cases</span> <span class=\"o\">=</span> <span class=\"p\">[(</span><span class=\"mf\">0.9</span><span class=\"p\">,</span> <span class=\"mf\">0.9</span><span class=\"p\">),</span> <span class=\"p\">(</span><span class=\"mf\">0.9</span><span class=\"p\">,</span> <span class=\"mf\">0.5</span><span class=\"p\">),</span> <span class=\"p\">(</span><span class=\"mf\">0.9</span><span class=\"p\">,</span> <span class=\"mf\">0.1</span><span class=\"p\">),</span> <span class=\"p\">(</span><span class=\"mf\">0.5</span><span class=\"p\">,</span> <span class=\"mf\">0.5</span><span class=\"p\">)]</span>\n<span class=\"n\">fig</span><span class=\"p\">,</span> <span class=\"n\">ax</span> <span class=\"o\">=</span> <span class=\"n\">plt</span><span class=\"o\">.</span><span class=\"n\">subplots</span><span class=\"p\">(</span><span class=\"n\">figsize</span><span class=\"o\">=</span><span class=\"p\">(</span><span class=\"mi\">10</span><span class=\"p\">,</span> <span class=\"mi\">6</span><span class=\"p\">))</span>\n\n<span class=\"k\">for</span> <span class=\"n\">i</span><span class=\"p\">,</span> <span class=\"p\">(</span><span class=\"n\">p</span><span class=\"p\">,</span> <span class=\"n\">r</span><span class=\"p\">)</span> <span class=\"ow\">in</span> <span class=\"nb\">enumerate</span><span class=\"p\">(</span><span class=\"n\">test_cases</span><span class=\"p\">):</span>\n    <span class=\"n\">harmonic</span> <span class=\"o\">=</span> <span class=\"mi\">2</span> <span class=\"o\">*</span> <span class=\"n\">p</span> <span class=\"o\">*</span> <span class=\"n\">r</span> <span class=\"o\">/</span> <span class=\"p\">(</span><span class=\"n\">p</span> <span class=\"o\">+</span> <span class=\"n\">r</span><span class=\"p\">)</span> <span class=\"k\">if</span> <span class=\"p\">(</span><span class=\"n\">p</span> <span class=\"o\">+</span> <span class=\"n\">r</span><span class=\"p\">)</span> <span class=\"o\">&gt;</span> <span class=\"mi\">0</span> <span class=\"k\">else</span> <span class=\"mi\">0</span>\n    <span class=\"n\">arithmetic</span> <span class=\"o\">=</span> <span class=\"p\">(</span><span class=\"n\">p</span> <span class=\"o\">+</span> <span class=\"n\">r</span><span class=\"p\">)</span> <span class=\"o\">/</span> <span class=\"mi\">2</span>\n\n    <span class=\"n\">x_pos</span> <span class=\"o\">=</span> <span class=\"p\">[</span><span class=\"n\">i</span><span class=\"o\">*</span><span class=\"mi\">3</span><span class=\"p\">,</span> <span class=\"n\">i</span><span class=\"o\">*</span><span class=\"mi\">3</span><span class=\"o\">+</span><span class=\"mi\">1</span><span class=\"p\">]</span>\n    <span class=\"n\">ax</span><span class=\"o\">.</span><span class=\"n\">bar</span><span class=\"p\">(</span><span class=\"n\">x_pos</span><span class=\"p\">,</span> <span class=\"p\">[</span><span class=\"n\">arithmetic</span><span class=\"p\">,</span> <span class=\"n\">harmonic</span><span class=\"p\">],</span> <span class=\"n\">width</span><span class=\"o\">=</span><span class=\"mf\">0.8</span><span class=\"p\">,</span> \n           <span class=\"n\">color</span><span class=\"o\">=</span><span class=\"p\">[</span><span class=\"s1\">&#39;lightblue&#39;</span><span class=\"p\">,</span> <span class=\"s1\">&#39;orange&#39;</span><span class=\"p\">],</span> <span class=\"n\">alpha</span><span class=\"o\">=</span><span class=\"mf\">0.7</span><span class=\"p\">,</span>\n           <span class=\"n\">label</span><span class=\"o\">=</span><span class=\"p\">[</span><span class=\"s1\">&#39;Media Aritmetica&#39;</span><span class=\"p\">,</span> <span class=\"s1\">&#39;Media Armonica (F1)&#39;</span><span class=\"p\">]</span> <span class=\"k\">if</span> <span class=\"n\">i</span> <span class=\"o\">==</span> <span class=\"mi\">0</span> <span class=\"k\">else</span> <span class=\"s1\">&#39;&#39;</span><span class=\"p\">)</span>\n    <span class=\"n\">ax</span><span class=\"o\">.</span><span class=\"n\">text</span><span class=\"p\">(</span><span class=\"n\">i</span><span class=\"o\">*</span><span class=\"mi\">3</span> <span class=\"o\">+</span> <span class=\"mf\">0.5</span><span class=\"p\">,</span> <span class=\"nb\">max</span><span class=\"p\">(</span><span class=\"n\">arithmetic</span><span class=\"p\">,</span> <span class=\"n\">harmonic</span><span class=\"p\">)</span> <span class=\"o\">+</span> <span class=\"mf\">0.05</span><span class=\"p\">,</span> \n           <span class=\"sa\">f</span><span class=\"s1\">&#39;P=</span><span class=\"si\">{</span><span class=\"n\">p</span><span class=\"si\">}</span><span class=\"s1\">, R=</span><span class=\"si\">{</span><span class=\"n\">r</span><span class=\"si\">}</span><span class=\"s1\">&#39;</span><span class=\"p\">,</span> <span class=\"n\">ha</span><span class=\"o\">=</span><span class=\"s1\">&#39;center&#39;</span><span class=\"p\">,</span> <span class=\"n\">fontsize</span><span class=\"o\">=</span><span class=\"mi\">10</span><span class=\"p\">,</span> <span class=\"n\">fontweight</span><span class=\"o\">=</span><span class=\"s1\">&#39;bold&#39;</span><span class=\"p\">)</span>\n\n<span class=\"n\">ax</span><span class=\"o\">.</span><span class=\"n\">set_xticks</span><span class=\"p\">([</span><span class=\"n\">i</span><span class=\"o\">*</span><span class=\"mi\">3</span> <span class=\"o\">+</span> <span class=\"mf\">0.5</span> <span class=\"k\">for</span> <span class=\"n\">i</span> <span class=\"ow\">in</span> <span class=\"nb\">range</span><span class=\"p\">(</span><span class=\"nb\">len</span><span class=\"p\">(</span><span class=\"n\">test_cases</span><span class=\"p\">))])</span>\n<span class=\"n\">ax</span><span class=\"o\">.</span><span class=\"n\">set_xticklabels</span><span class=\"p\">([</span><span class=\"sa\">f</span><span class=\"s1\">&#39;Caso </span><span class=\"si\">{</span><span class=\"n\">i</span><span class=\"o\">+</span><span class=\"mi\">1</span><span class=\"si\">}</span><span class=\"s1\">&#39;</span> <span class=\"k\">for</span> <span class=\"n\">i</span> <span class=\"ow\">in</span> <span class=\"nb\">range</span><span class=\"p\">(</span><span class=\"nb\">len</span><span class=\"p\">(</span><span class=\"n\">test_cases</span><span class=\"p\">))])</span>\n<span class=\"n\">ax</span><span class=\"o\">.</span><span class=\"n\">set_ylabel</span><span class=\"p\">(</span><span class=\"s1\">&#39;Valore&#39;</span><span class=\"p\">,</span> <span class=\"n\">fontsize</span><span class=\"o\">=</span><span class=\"mi\">12</span><span class=\"p\">)</span>\n<span class=\"n\">ax</span><span class=\"o\">.</span><span class=\"n\">set_title</span><span class=\"p\">(</span><span class=\"s1\">&#39;F1 (Media Armonica) penalizza valori sbilanciati&#39;</span><span class=\"p\">,</span> <span class=\"n\">fontsize</span><span class=\"o\">=</span><span class=\"mi\">14</span><span class=\"p\">)</span>\n<span class=\"n\">ax</span><span class=\"o\">.</span><span class=\"n\">legend</span><span class=\"p\">()</span>\n<span class=\"n\">ax</span><span class=\"o\">.</span><span class=\"n\">grid</span><span class=\"p\">(</span><span class=\"n\">axis</span><span class=\"o\">=</span><span class=\"s1\">&#39;y&#39;</span><span class=\"p\">,</span> <span class=\"n\">alpha</span><span class=\"o\">=</span><span class=\"mf\">0.3</span><span class=\"p\">)</span>\n<span class=\"n\">plt</span><span class=\"o\">.</span><span class=\"n\">tight_layout</span><span class=\"p\">()</span>\n<span class=\"n\">plt</span><span class=\"o\">.</span><span class=\"n\">show</span><span class=\"p\">()</span>\n</code></pre></div>\n</div>\n</details>\n\n<h3 id=\"47-f-beta-score\">4.7 F-Beta Score</h3>\n<p>Generalizzazione dell&rsquo;F1-score che permette di pesare diversamente precision e recall:</p>\n$$F_\\beta = (1 + \\beta^2) \\cdot \\frac{\\text{Precision} \\cdot \\text{Recall}}{\\beta^2 \\cdot \\text{Precision} + \\text{Recall}}$$\n<ul>\n<li><strong>β &lt; 1</strong>: Maggior peso alla precision (favorire specificità)</li>\n<li><strong>β &gt; 1</strong>: Maggior peso al recall (favorire sensibilità)</li>\n<li><strong>β = 1</strong>: F1-score standard (bilanciamento)</li>\n<li><strong>β = 2</strong>: F2-score (recall conta il doppio)</li>\n<li><strong>β = 0.5</strong>: F0.5-score (precision conta il doppio)</li>\n</ul>\n<details class=\"code-container\">\n<summary>Code</summary>\n<div class=\"code-wrapper\">\n<button class=\"copy-button\" onclick=\"\n                const code = this.parentElement.querySelector('pre');\n                if (code) {\n                    navigator.clipboard.writeText(code.innerText);\n                    this.textContent = 'Copied!';\n                    setTimeout(() => this.textContent = 'Copy', 2000);\n                }\n            \">Copy</button>\n<div class=\"codehilite\"><pre><span></span><code><span class=\"kn\">from</span><span class=\"w\"> </span><span class=\"nn\">sklearn.metrics</span><span class=\"w\"> </span><span class=\"kn\">import</span> <span class=\"n\">fbeta_score</span>\n\n<span class=\"n\">betas</span> <span class=\"o\">=</span> <span class=\"p\">[</span><span class=\"mf\">0.5</span><span class=\"p\">,</span> <span class=\"mi\">1</span><span class=\"p\">,</span> <span class=\"mi\">2</span><span class=\"p\">,</span> <span class=\"mi\">3</span><span class=\"p\">]</span>\n<span class=\"n\">f_scores</span> <span class=\"o\">=</span> <span class=\"p\">[</span><span class=\"n\">fbeta_score</span><span class=\"p\">(</span><span class=\"n\">y_test</span><span class=\"p\">,</span> <span class=\"n\">y_pred</span><span class=\"p\">,</span> <span class=\"n\">beta</span><span class=\"o\">=</span><span class=\"n\">b</span><span class=\"p\">)</span> <span class=\"k\">for</span> <span class=\"n\">b</span> <span class=\"ow\">in</span> <span class=\"n\">betas</span><span class=\"p\">]</span>\n\n<span class=\"n\">fig</span><span class=\"p\">,</span> <span class=\"n\">ax</span> <span class=\"o\">=</span> <span class=\"n\">plt</span><span class=\"o\">.</span><span class=\"n\">subplots</span><span class=\"p\">(</span><span class=\"n\">figsize</span><span class=\"o\">=</span><span class=\"p\">(</span><span class=\"mi\">10</span><span class=\"p\">,</span> <span class=\"mi\">6</span><span class=\"p\">))</span>\n<span class=\"n\">bars</span> <span class=\"o\">=</span> <span class=\"n\">ax</span><span class=\"o\">.</span><span class=\"n\">bar</span><span class=\"p\">([</span><span class=\"sa\">f</span><span class=\"s1\">&#39;F</span><span class=\"si\">{</span><span class=\"n\">b</span><span class=\"si\">}</span><span class=\"s1\">&#39;</span> <span class=\"k\">for</span> <span class=\"n\">b</span> <span class=\"ow\">in</span> <span class=\"n\">betas</span><span class=\"p\">],</span> <span class=\"n\">f_scores</span><span class=\"p\">,</span> <span class=\"n\">color</span><span class=\"o\">=</span><span class=\"p\">[</span><span class=\"s1\">&#39;red&#39;</span><span class=\"p\">,</span> <span class=\"s1\">&#39;purple&#39;</span><span class=\"p\">,</span> <span class=\"s1\">&#39;blue&#39;</span><span class=\"p\">,</span> <span class=\"s1\">&#39;green&#39;</span><span class=\"p\">],</span> <span class=\"n\">alpha</span><span class=\"o\">=</span><span class=\"mf\">0.7</span><span class=\"p\">)</span>\n<span class=\"n\">ax</span><span class=\"o\">.</span><span class=\"n\">axhline</span><span class=\"p\">(</span><span class=\"n\">precision</span><span class=\"p\">,</span> <span class=\"n\">color</span><span class=\"o\">=</span><span class=\"s1\">&#39;red&#39;</span><span class=\"p\">,</span> <span class=\"n\">linestyle</span><span class=\"o\">=</span><span class=\"s1\">&#39;--&#39;</span><span class=\"p\">,</span> <span class=\"n\">label</span><span class=\"o\">=</span><span class=\"sa\">f</span><span class=\"s1\">&#39;Precision: </span><span class=\"si\">{</span><span class=\"n\">precision</span><span class=\"si\">:</span><span class=\"s1\">.3f</span><span class=\"si\">}</span><span class=\"s1\">&#39;</span><span class=\"p\">)</span>\n<span class=\"n\">ax</span><span class=\"o\">.</span><span class=\"n\">axhline</span><span class=\"p\">(</span><span class=\"n\">recall</span><span class=\"p\">,</span> <span class=\"n\">color</span><span class=\"o\">=</span><span class=\"s1\">&#39;blue&#39;</span><span class=\"p\">,</span> <span class=\"n\">linestyle</span><span class=\"o\">=</span><span class=\"s1\">&#39;--&#39;</span><span class=\"p\">,</span> <span class=\"n\">label</span><span class=\"o\">=</span><span class=\"sa\">f</span><span class=\"s1\">&#39;Recall: </span><span class=\"si\">{</span><span class=\"n\">recall</span><span class=\"si\">:</span><span class=\"s1\">.3f</span><span class=\"si\">}</span><span class=\"s1\">&#39;</span><span class=\"p\">)</span>\n<span class=\"n\">ax</span><span class=\"o\">.</span><span class=\"n\">set_ylabel</span><span class=\"p\">(</span><span class=\"s1\">&#39;Score&#39;</span><span class=\"p\">,</span> <span class=\"n\">fontsize</span><span class=\"o\">=</span><span class=\"mi\">12</span><span class=\"p\">)</span>\n<span class=\"n\">ax</span><span class=\"o\">.</span><span class=\"n\">set_title</span><span class=\"p\">(</span><span class=\"s1\">&#39;F-Beta Score: Bilanciamento tra Precision e Recall&#39;</span><span class=\"p\">,</span> <span class=\"n\">fontsize</span><span class=\"o\">=</span><span class=\"mi\">14</span><span class=\"p\">)</span>\n<span class=\"n\">ax</span><span class=\"o\">.</span><span class=\"n\">legend</span><span class=\"p\">()</span>\n<span class=\"n\">ax</span><span class=\"o\">.</span><span class=\"n\">grid</span><span class=\"p\">(</span><span class=\"n\">axis</span><span class=\"o\">=</span><span class=\"s1\">&#39;y&#39;</span><span class=\"p\">,</span> <span class=\"n\">alpha</span><span class=\"o\">=</span><span class=\"mf\">0.3</span><span class=\"p\">)</span>\n\n<span class=\"k\">for</span> <span class=\"n\">bar</span><span class=\"p\">,</span> <span class=\"n\">score</span> <span class=\"ow\">in</span> <span class=\"nb\">zip</span><span class=\"p\">(</span><span class=\"n\">bars</span><span class=\"p\">,</span> <span class=\"n\">f_scores</span><span class=\"p\">):</span>\n    <span class=\"n\">ax</span><span class=\"o\">.</span><span class=\"n\">text</span><span class=\"p\">(</span><span class=\"n\">bar</span><span class=\"o\">.</span><span class=\"n\">get_x</span><span class=\"p\">()</span> <span class=\"o\">+</span> <span class=\"n\">bar</span><span class=\"o\">.</span><span class=\"n\">get_width</span><span class=\"p\">()</span><span class=\"o\">/</span><span class=\"mi\">2</span><span class=\"p\">,</span> <span class=\"n\">score</span> <span class=\"o\">+</span> <span class=\"mf\">0.01</span><span class=\"p\">,</span>\n           <span class=\"sa\">f</span><span class=\"s1\">&#39;</span><span class=\"si\">{</span><span class=\"n\">score</span><span class=\"si\">:</span><span class=\"s1\">.3f</span><span class=\"si\">}</span><span class=\"s1\">&#39;</span><span class=\"p\">,</span> <span class=\"n\">ha</span><span class=\"o\">=</span><span class=\"s1\">&#39;center&#39;</span><span class=\"p\">,</span> <span class=\"n\">va</span><span class=\"o\">=</span><span class=\"s1\">&#39;bottom&#39;</span><span class=\"p\">,</span> <span class=\"n\">fontweight</span><span class=\"o\">=</span><span class=\"s1\">&#39;bold&#39;</span><span class=\"p\">)</span>\n\n<span class=\"n\">plt</span><span class=\"o\">.</span><span class=\"n\">tight_layout</span><span class=\"p\">()</span>\n<span class=\"n\">plt</span><span class=\"o\">.</span><span class=\"n\">show</span><span class=\"p\">()</span>\n\n<span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"sa\">f</span><span class=\"s1\">&#39;F0.5-Score (favorisce Precision): </span><span class=\"si\">{</span><span class=\"n\">f_scores</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">]</span><span class=\"si\">:</span><span class=\"s1\">.4f</span><span class=\"si\">}</span><span class=\"s1\">&#39;</span><span class=\"p\">)</span>\n<span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"sa\">f</span><span class=\"s1\">&#39;F1-Score (bilanciato): </span><span class=\"si\">{</span><span class=\"n\">f_scores</span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">]</span><span class=\"si\">:</span><span class=\"s1\">.4f</span><span class=\"si\">}</span><span class=\"s1\">&#39;</span><span class=\"p\">)</span>\n<span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"sa\">f</span><span class=\"s1\">&#39;F2-Score (favorisce Recall): </span><span class=\"si\">{</span><span class=\"n\">f_scores</span><span class=\"p\">[</span><span class=\"mi\">2</span><span class=\"p\">]</span><span class=\"si\">:</span><span class=\"s1\">.4f</span><span class=\"si\">}</span><span class=\"s1\">&#39;</span><span class=\"p\">)</span>\n</code></pre></div>\n</div>\n</details>\n\n<h2 id=\"5-tassi-di-errore-error-rates\">5. Tassi di Errore (Error Rates)</h2>\n<h3 id=\"51-false-positive-rate-fpr-fall-out\">5.1 False Positive Rate (FPR) - Fall-out</h3>\n<p>Il <strong>FPR</strong> misura la proporzione di istanze negative erroneamente classificate come positive:</p>\n$$\\text{FPR} = \\frac{FP}{FP + TN} = 1 - \\text{Specificity}$$\n<p><strong>In Biometria</strong>: <strong>FAR</strong> (False Acceptance Rate) - Tasso di accettazione di impostori</p>\n<p>Se FAR = 0.1% → 1 su 1000 impostori viene accettato</p>\n<h3 id=\"52-false-negative-rate-fnr-miss-rate\">5.2 False Negative Rate (FNR) - Miss Rate</h3>\n<p>Il <strong>FNR</strong> misura la proporzione di istanze positive erroneamente classificate come negative:</p>\n<p>$\\text{FNR} = \\frac{FN}{FN + TP} = 1 - \\text{Recall}$</p>\n<p><strong>In Biometria</strong>: <strong>FRR</strong> (False Rejection Rate) - Tasso di rifiuto di utenti genuini</p>\n<p>Se FRR = 0.05% → 1 su 2000 utenti autorizzati viene rifiutato</p>\n<h3 id=\"53-false-discovery-rate-fdr\">5.3 False Discovery Rate (FDR)</h3>\n<p>Il <strong>FDR</strong> misura la proporzione di predizioni positive che sono errate:</p>\n<p>$\\text{FDR} = \\frac{FP}{FP + TP} = 1 - \\text{Precision}$</p>\n<h3 id=\"54-visualizzazione-completa-dei-tassi-di-errore\">5.4 Visualizzazione Completa dei Tassi di Errore</h3>\n<details class=\"code-container\">\n<summary>Code</summary>\n<div class=\"code-wrapper\">\n<button class=\"copy-button\" onclick=\"\n                const code = this.parentElement.querySelector('pre');\n                if (code) {\n                    navigator.clipboard.writeText(code.innerText);\n                    this.textContent = 'Copied!';\n                    setTimeout(() => this.textContent = 'Copy', 2000);\n                }\n            \">Copy</button>\n<div class=\"codehilite\"><pre><span></span><code><span class=\"c1\"># Calcolo di tutti i tassi</span>\n<span class=\"n\">fpr</span> <span class=\"o\">=</span> <span class=\"n\">fp</span> <span class=\"o\">/</span> <span class=\"p\">(</span><span class=\"n\">fp</span> <span class=\"o\">+</span> <span class=\"n\">tn</span><span class=\"p\">)</span>\n<span class=\"n\">fnr</span> <span class=\"o\">=</span> <span class=\"n\">fn</span> <span class=\"o\">/</span> <span class=\"p\">(</span><span class=\"n\">fn</span> <span class=\"o\">+</span> <span class=\"n\">tp</span><span class=\"p\">)</span>\n<span class=\"n\">fdr</span> <span class=\"o\">=</span> <span class=\"n\">fp</span> <span class=\"o\">/</span> <span class=\"p\">(</span><span class=\"n\">fp</span> <span class=\"o\">+</span> <span class=\"n\">tp</span><span class=\"p\">)</span>\n<span class=\"n\">tpr</span> <span class=\"o\">=</span> <span class=\"n\">tp</span> <span class=\"o\">/</span> <span class=\"p\">(</span><span class=\"n\">tp</span> <span class=\"o\">+</span> <span class=\"n\">fn</span><span class=\"p\">)</span>  <span class=\"c1\"># = Recall</span>\n<span class=\"n\">tnr</span> <span class=\"o\">=</span> <span class=\"n\">tn</span> <span class=\"o\">/</span> <span class=\"p\">(</span><span class=\"n\">tn</span> <span class=\"o\">+</span> <span class=\"n\">fp</span><span class=\"p\">)</span>  <span class=\"c1\"># = Specificity</span>\n\n<span class=\"n\">fig</span><span class=\"p\">,</span> <span class=\"n\">axes</span> <span class=\"o\">=</span> <span class=\"n\">plt</span><span class=\"o\">.</span><span class=\"n\">subplots</span><span class=\"p\">(</span><span class=\"mi\">2</span><span class=\"p\">,</span> <span class=\"mi\">2</span><span class=\"p\">,</span> <span class=\"n\">figsize</span><span class=\"o\">=</span><span class=\"p\">(</span><span class=\"mi\">14</span><span class=\"p\">,</span> <span class=\"mi\">10</span><span class=\"p\">))</span>\n\n<span class=\"c1\"># Grafico 1: FPR vs TNR</span>\n<span class=\"n\">rates_neg</span> <span class=\"o\">=</span> <span class=\"p\">[</span><span class=\"n\">tnr</span><span class=\"p\">,</span> <span class=\"n\">fpr</span><span class=\"p\">]</span>\n<span class=\"n\">labels_neg</span> <span class=\"o\">=</span> <span class=\"p\">[</span><span class=\"s1\">&#39;TNR</span><span class=\"se\">\\n</span><span class=\"s1\">(Specificity)&#39;</span><span class=\"p\">,</span> <span class=\"s1\">&#39;FPR</span><span class=\"se\">\\n</span><span class=\"s1\">(Fall-out)&#39;</span><span class=\"p\">]</span>\n<span class=\"n\">colors_neg</span> <span class=\"o\">=</span> <span class=\"p\">[</span><span class=\"s1\">&#39;green&#39;</span><span class=\"p\">,</span> <span class=\"s1\">&#39;red&#39;</span><span class=\"p\">]</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"mi\">0</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">bar</span><span class=\"p\">(</span><span class=\"n\">labels_neg</span><span class=\"p\">,</span> <span class=\"n\">rates_neg</span><span class=\"p\">,</span> <span class=\"n\">color</span><span class=\"o\">=</span><span class=\"n\">colors_neg</span><span class=\"p\">,</span> <span class=\"n\">alpha</span><span class=\"o\">=</span><span class=\"mf\">0.7</span><span class=\"p\">,</span> <span class=\"n\">edgecolor</span><span class=\"o\">=</span><span class=\"s1\">&#39;black&#39;</span><span class=\"p\">,</span> <span class=\"n\">linewidth</span><span class=\"o\">=</span><span class=\"mi\">2</span><span class=\"p\">)</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"mi\">0</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">set_ylabel</span><span class=\"p\">(</span><span class=\"s1\">&#39;Tasso&#39;</span><span class=\"p\">,</span> <span class=\"n\">fontsize</span><span class=\"o\">=</span><span class=\"mi\">12</span><span class=\"p\">)</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"mi\">0</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">set_title</span><span class=\"p\">(</span><span class=\"s1\">&#39;Classi Negative: TNR + FPR = 1&#39;</span><span class=\"p\">,</span> <span class=\"n\">fontsize</span><span class=\"o\">=</span><span class=\"mi\">14</span><span class=\"p\">)</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"mi\">0</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">set_ylim</span><span class=\"p\">([</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"mf\">1.1</span><span class=\"p\">])</span>\n<span class=\"k\">for</span> <span class=\"n\">i</span><span class=\"p\">,</span> <span class=\"p\">(</span><span class=\"n\">label</span><span class=\"p\">,</span> <span class=\"n\">rate</span><span class=\"p\">)</span> <span class=\"ow\">in</span> <span class=\"nb\">enumerate</span><span class=\"p\">(</span><span class=\"nb\">zip</span><span class=\"p\">(</span><span class=\"n\">labels_neg</span><span class=\"p\">,</span> <span class=\"n\">rates_neg</span><span class=\"p\">)):</span>\n    <span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"mi\">0</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">text</span><span class=\"p\">(</span><span class=\"n\">i</span><span class=\"p\">,</span> <span class=\"n\">rate</span> <span class=\"o\">+</span> <span class=\"mf\">0.02</span><span class=\"p\">,</span> <span class=\"sa\">f</span><span class=\"s1\">&#39;</span><span class=\"si\">{</span><span class=\"n\">rate</span><span class=\"si\">:</span><span class=\"s1\">.3f</span><span class=\"si\">}</span><span class=\"s1\">&#39;</span><span class=\"p\">,</span> <span class=\"n\">ha</span><span class=\"o\">=</span><span class=\"s1\">&#39;center&#39;</span><span class=\"p\">,</span> <span class=\"n\">fontsize</span><span class=\"o\">=</span><span class=\"mi\">11</span><span class=\"p\">,</span> <span class=\"n\">fontweight</span><span class=\"o\">=</span><span class=\"s1\">&#39;bold&#39;</span><span class=\"p\">)</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"mi\">0</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">axhline</span><span class=\"p\">(</span><span class=\"mf\">1.0</span><span class=\"p\">,</span> <span class=\"n\">color</span><span class=\"o\">=</span><span class=\"s1\">&#39;black&#39;</span><span class=\"p\">,</span> <span class=\"n\">linestyle</span><span class=\"o\">=</span><span class=\"s1\">&#39;--&#39;</span><span class=\"p\">,</span> <span class=\"n\">alpha</span><span class=\"o\">=</span><span class=\"mf\">0.5</span><span class=\"p\">)</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"mi\">0</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">grid</span><span class=\"p\">(</span><span class=\"n\">axis</span><span class=\"o\">=</span><span class=\"s1\">&#39;y&#39;</span><span class=\"p\">,</span> <span class=\"n\">alpha</span><span class=\"o\">=</span><span class=\"mf\">0.3</span><span class=\"p\">)</span>\n\n<span class=\"c1\"># Grafico 2: FNR vs TPR</span>\n<span class=\"n\">rates_pos</span> <span class=\"o\">=</span> <span class=\"p\">[</span><span class=\"n\">tpr</span><span class=\"p\">,</span> <span class=\"n\">fnr</span><span class=\"p\">]</span>\n<span class=\"n\">labels_pos</span> <span class=\"o\">=</span> <span class=\"p\">[</span><span class=\"s1\">&#39;TPR</span><span class=\"se\">\\n</span><span class=\"s1\">(Recall)&#39;</span><span class=\"p\">,</span> <span class=\"s1\">&#39;FNR</span><span class=\"se\">\\n</span><span class=\"s1\">(Miss Rate)&#39;</span><span class=\"p\">]</span>\n<span class=\"n\">colors_pos</span> <span class=\"o\">=</span> <span class=\"p\">[</span><span class=\"s1\">&#39;green&#39;</span><span class=\"p\">,</span> <span class=\"s1\">&#39;orange&#39;</span><span class=\"p\">]</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"mi\">1</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">bar</span><span class=\"p\">(</span><span class=\"n\">labels_pos</span><span class=\"p\">,</span> <span class=\"n\">rates_pos</span><span class=\"p\">,</span> <span class=\"n\">color</span><span class=\"o\">=</span><span class=\"n\">colors_pos</span><span class=\"p\">,</span> <span class=\"n\">alpha</span><span class=\"o\">=</span><span class=\"mf\">0.7</span><span class=\"p\">,</span> <span class=\"n\">edgecolor</span><span class=\"o\">=</span><span class=\"s1\">&#39;black&#39;</span><span class=\"p\">,</span> <span class=\"n\">linewidth</span><span class=\"o\">=</span><span class=\"mi\">2</span><span class=\"p\">)</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"mi\">1</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">set_ylabel</span><span class=\"p\">(</span><span class=\"s1\">&#39;Tasso&#39;</span><span class=\"p\">,</span> <span class=\"n\">fontsize</span><span class=\"o\">=</span><span class=\"mi\">12</span><span class=\"p\">)</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"mi\">1</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">set_title</span><span class=\"p\">(</span><span class=\"s1\">&#39;Classi Positive: TPR + FNR = 1&#39;</span><span class=\"p\">,</span> <span class=\"n\">fontsize</span><span class=\"o\">=</span><span class=\"mi\">14</span><span class=\"p\">)</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"mi\">1</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">set_ylim</span><span class=\"p\">([</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"mf\">1.1</span><span class=\"p\">])</span>\n<span class=\"k\">for</span> <span class=\"n\">i</span><span class=\"p\">,</span> <span class=\"p\">(</span><span class=\"n\">label</span><span class=\"p\">,</span> <span class=\"n\">rate</span><span class=\"p\">)</span> <span class=\"ow\">in</span> <span class=\"nb\">enumerate</span><span class=\"p\">(</span><span class=\"nb\">zip</span><span class=\"p\">(</span><span class=\"n\">labels_pos</span><span class=\"p\">,</span> <span class=\"n\">rates_pos</span><span class=\"p\">)):</span>\n    <span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"mi\">1</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">text</span><span class=\"p\">(</span><span class=\"n\">i</span><span class=\"p\">,</span> <span class=\"n\">rate</span> <span class=\"o\">+</span> <span class=\"mf\">0.02</span><span class=\"p\">,</span> <span class=\"sa\">f</span><span class=\"s1\">&#39;</span><span class=\"si\">{</span><span class=\"n\">rate</span><span class=\"si\">:</span><span class=\"s1\">.3f</span><span class=\"si\">}</span><span class=\"s1\">&#39;</span><span class=\"p\">,</span> <span class=\"n\">ha</span><span class=\"o\">=</span><span class=\"s1\">&#39;center&#39;</span><span class=\"p\">,</span> <span class=\"n\">fontsize</span><span class=\"o\">=</span><span class=\"mi\">11</span><span class=\"p\">,</span> <span class=\"n\">fontweight</span><span class=\"o\">=</span><span class=\"s1\">&#39;bold&#39;</span><span class=\"p\">)</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"mi\">1</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">axhline</span><span class=\"p\">(</span><span class=\"mf\">1.0</span><span class=\"p\">,</span> <span class=\"n\">color</span><span class=\"o\">=</span><span class=\"s1\">&#39;black&#39;</span><span class=\"p\">,</span> <span class=\"n\">linestyle</span><span class=\"o\">=</span><span class=\"s1\">&#39;--&#39;</span><span class=\"p\">,</span> <span class=\"n\">alpha</span><span class=\"o\">=</span><span class=\"mf\">0.5</span><span class=\"p\">)</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"mi\">1</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">grid</span><span class=\"p\">(</span><span class=\"n\">axis</span><span class=\"o\">=</span><span class=\"s1\">&#39;y&#39;</span><span class=\"p\">,</span> <span class=\"n\">alpha</span><span class=\"o\">=</span><span class=\"mf\">0.3</span><span class=\"p\">)</span>\n\n<span class=\"c1\"># Grafico 3: Tutte le metriche complementari</span>\n<span class=\"n\">all_rates</span> <span class=\"o\">=</span> <span class=\"p\">[</span><span class=\"n\">tpr</span><span class=\"p\">,</span> <span class=\"n\">fnr</span><span class=\"p\">,</span> <span class=\"n\">tnr</span><span class=\"p\">,</span> <span class=\"n\">fpr</span><span class=\"p\">,</span> <span class=\"n\">precision</span><span class=\"p\">,</span> <span class=\"n\">fdr</span><span class=\"p\">]</span>\n<span class=\"n\">all_labels</span> <span class=\"o\">=</span> <span class=\"p\">[</span><span class=\"s1\">&#39;TPR</span><span class=\"se\">\\n</span><span class=\"s1\">(Recall)&#39;</span><span class=\"p\">,</span> <span class=\"s1\">&#39;FNR&#39;</span><span class=\"p\">,</span> <span class=\"s1\">&#39;TNR</span><span class=\"se\">\\n</span><span class=\"s1\">(Spec)&#39;</span><span class=\"p\">,</span> <span class=\"s1\">&#39;FPR&#39;</span><span class=\"p\">,</span> <span class=\"s1\">&#39;Precision&#39;</span><span class=\"p\">,</span> <span class=\"s1\">&#39;FDR&#39;</span><span class=\"p\">]</span>\n<span class=\"n\">all_colors</span> <span class=\"o\">=</span> <span class=\"p\">[</span><span class=\"s1\">&#39;green&#39;</span><span class=\"p\">,</span> <span class=\"s1\">&#39;orange&#39;</span><span class=\"p\">,</span> <span class=\"s1\">&#39;green&#39;</span><span class=\"p\">,</span> <span class=\"s1\">&#39;red&#39;</span><span class=\"p\">,</span> <span class=\"s1\">&#39;blue&#39;</span><span class=\"p\">,</span> <span class=\"s1\">&#39;purple&#39;</span><span class=\"p\">]</span>\n<span class=\"n\">bars</span> <span class=\"o\">=</span> <span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">,</span> <span class=\"mi\">0</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">bar</span><span class=\"p\">(</span><span class=\"nb\">range</span><span class=\"p\">(</span><span class=\"nb\">len</span><span class=\"p\">(</span><span class=\"n\">all_rates</span><span class=\"p\">)),</span> <span class=\"n\">all_rates</span><span class=\"p\">,</span> <span class=\"n\">color</span><span class=\"o\">=</span><span class=\"n\">all_colors</span><span class=\"p\">,</span> <span class=\"n\">alpha</span><span class=\"o\">=</span><span class=\"mf\">0.7</span><span class=\"p\">,</span> \n                      <span class=\"n\">edgecolor</span><span class=\"o\">=</span><span class=\"s1\">&#39;black&#39;</span><span class=\"p\">,</span> <span class=\"n\">linewidth</span><span class=\"o\">=</span><span class=\"mi\">2</span><span class=\"p\">)</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">,</span> <span class=\"mi\">0</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">set_xticks</span><span class=\"p\">(</span><span class=\"nb\">range</span><span class=\"p\">(</span><span class=\"nb\">len</span><span class=\"p\">(</span><span class=\"n\">all_rates</span><span class=\"p\">)))</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">,</span> <span class=\"mi\">0</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">set_xticklabels</span><span class=\"p\">(</span><span class=\"n\">all_labels</span><span class=\"p\">,</span> <span class=\"n\">fontsize</span><span class=\"o\">=</span><span class=\"mi\">10</span><span class=\"p\">)</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">,</span> <span class=\"mi\">0</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">set_ylabel</span><span class=\"p\">(</span><span class=\"s1\">&#39;Valore&#39;</span><span class=\"p\">,</span> <span class=\"n\">fontsize</span><span class=\"o\">=</span><span class=\"mi\">12</span><span class=\"p\">)</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">,</span> <span class=\"mi\">0</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">set_title</span><span class=\"p\">(</span><span class=\"s1\">&#39;Panoramica Completa delle Metriche&#39;</span><span class=\"p\">,</span> <span class=\"n\">fontsize</span><span class=\"o\">=</span><span class=\"mi\">14</span><span class=\"p\">)</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">,</span> <span class=\"mi\">0</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">set_ylim</span><span class=\"p\">([</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"mf\">1.1</span><span class=\"p\">])</span>\n<span class=\"k\">for</span> <span class=\"n\">bar</span><span class=\"p\">,</span> <span class=\"n\">rate</span> <span class=\"ow\">in</span> <span class=\"nb\">zip</span><span class=\"p\">(</span><span class=\"n\">bars</span><span class=\"p\">,</span> <span class=\"n\">all_rates</span><span class=\"p\">):</span>\n    <span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">,</span> <span class=\"mi\">0</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">text</span><span class=\"p\">(</span><span class=\"n\">bar</span><span class=\"o\">.</span><span class=\"n\">get_x</span><span class=\"p\">()</span> <span class=\"o\">+</span> <span class=\"n\">bar</span><span class=\"o\">.</span><span class=\"n\">get_width</span><span class=\"p\">()</span><span class=\"o\">/</span><span class=\"mi\">2</span><span class=\"p\">,</span> <span class=\"n\">rate</span> <span class=\"o\">+</span> <span class=\"mf\">0.02</span><span class=\"p\">,</span>\n                    <span class=\"sa\">f</span><span class=\"s1\">&#39;</span><span class=\"si\">{</span><span class=\"n\">rate</span><span class=\"si\">:</span><span class=\"s1\">.3f</span><span class=\"si\">}</span><span class=\"s1\">&#39;</span><span class=\"p\">,</span> <span class=\"n\">ha</span><span class=\"o\">=</span><span class=\"s1\">&#39;center&#39;</span><span class=\"p\">,</span> <span class=\"n\">fontsize</span><span class=\"o\">=</span><span class=\"mi\">10</span><span class=\"p\">,</span> <span class=\"n\">fontweight</span><span class=\"o\">=</span><span class=\"s1\">&#39;bold&#39;</span><span class=\"p\">)</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">,</span> <span class=\"mi\">0</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">grid</span><span class=\"p\">(</span><span class=\"n\">axis</span><span class=\"o\">=</span><span class=\"s1\">&#39;y&#39;</span><span class=\"p\">,</span> <span class=\"n\">alpha</span><span class=\"o\">=</span><span class=\"mf\">0.3</span><span class=\"p\">)</span>\n\n<span class=\"c1\"># Grafico 4: Relazioni complementari</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">,</span> <span class=\"mi\">1</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">axis</span><span class=\"p\">(</span><span class=\"s1\">&#39;off&#39;</span><span class=\"p\">)</span>\n<span class=\"n\">relations</span> <span class=\"o\">=</span> <span class=\"p\">[</span>\n    <span class=\"s1\">&#39;TPR + FNR = 1&#39;</span><span class=\"p\">,</span>\n    <span class=\"s1\">&#39;TNR + FPR = 1&#39;</span><span class=\"p\">,</span>\n    <span class=\"s1\">&#39;Precision + FDR = 1&#39;</span><span class=\"p\">,</span>\n    <span class=\"s1\">&#39;&#39;</span><span class=\"p\">,</span>\n    <span class=\"s1\">&#39;TPR = Recall = Sensitivity&#39;</span><span class=\"p\">,</span>\n    <span class=\"s1\">&#39;FPR = 1 - Specificity = Fall-out&#39;</span><span class=\"p\">,</span>\n    <span class=\"s1\">&#39;FNR = 1 - Recall = Miss Rate&#39;</span><span class=\"p\">,</span>\n    <span class=\"s1\">&#39;&#39;</span><span class=\"p\">,</span>\n    <span class=\"s1\">&#39;ML: FPR, FNR (tassi errore)&#39;</span><span class=\"p\">,</span>\n    <span class=\"s1\">&#39;Biometria: FAR ≡ FPR, FRR ≡ FNR&#39;</span>\n<span class=\"p\">]</span>\n<span class=\"n\">y_start</span> <span class=\"o\">=</span> <span class=\"mf\">0.95</span>\n<span class=\"k\">for</span> <span class=\"n\">i</span><span class=\"p\">,</span> <span class=\"n\">rel</span> <span class=\"ow\">in</span> <span class=\"nb\">enumerate</span><span class=\"p\">(</span><span class=\"n\">relations</span><span class=\"p\">):</span>\n    <span class=\"k\">if</span> <span class=\"n\">rel</span><span class=\"p\">:</span>\n        <span class=\"n\">color</span> <span class=\"o\">=</span> <span class=\"s1\">&#39;red&#39;</span> <span class=\"k\">if</span> <span class=\"s1\">&#39;Biometria&#39;</span> <span class=\"ow\">in</span> <span class=\"n\">rel</span> <span class=\"ow\">or</span> <span class=\"s1\">&#39;ML:&#39;</span> <span class=\"ow\">in</span> <span class=\"n\">rel</span> <span class=\"k\">else</span> <span class=\"s1\">&#39;black&#39;</span>\n        <span class=\"n\">weight</span> <span class=\"o\">=</span> <span class=\"s1\">&#39;bold&#39;</span> <span class=\"k\">if</span> <span class=\"s1\">&#39;Biometria&#39;</span> <span class=\"ow\">in</span> <span class=\"n\">rel</span> <span class=\"ow\">or</span> <span class=\"s1\">&#39;ML:&#39;</span> <span class=\"ow\">in</span> <span class=\"n\">rel</span> <span class=\"k\">else</span> <span class=\"s1\">&#39;normal&#39;</span>\n        <span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">,</span> <span class=\"mi\">1</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">text</span><span class=\"p\">(</span><span class=\"mf\">0.1</span><span class=\"p\">,</span> <span class=\"n\">y_start</span> <span class=\"o\">-</span> <span class=\"n\">i</span><span class=\"o\">*</span><span class=\"mf\">0.08</span><span class=\"p\">,</span> <span class=\"n\">rel</span><span class=\"p\">,</span> <span class=\"n\">fontsize</span><span class=\"o\">=</span><span class=\"mi\">11</span><span class=\"p\">,</span> \n                       <span class=\"n\">color</span><span class=\"o\">=</span><span class=\"n\">color</span><span class=\"p\">,</span> <span class=\"n\">fontweight</span><span class=\"o\">=</span><span class=\"n\">weight</span><span class=\"p\">,</span> <span class=\"n\">family</span><span class=\"o\">=</span><span class=\"s1\">&#39;monospace&#39;</span><span class=\"p\">)</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">,</span> <span class=\"mi\">1</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">set_title</span><span class=\"p\">(</span><span class=\"s1\">&#39;Relazioni e Equivalenze&#39;</span><span class=\"p\">,</span> <span class=\"n\">fontsize</span><span class=\"o\">=</span><span class=\"mi\">14</span><span class=\"p\">,</span> <span class=\"n\">fontweight</span><span class=\"o\">=</span><span class=\"s1\">&#39;bold&#39;</span><span class=\"p\">)</span>\n\n<span class=\"n\">plt</span><span class=\"o\">.</span><span class=\"n\">tight_layout</span><span class=\"p\">()</span>\n<span class=\"n\">plt</span><span class=\"o\">.</span><span class=\"n\">show</span><span class=\"p\">()</span>\n</code></pre></div>\n</div>\n</details>\n\n<h3 id=\"55-false-acceptance-rate-far-e-false-rejection-rate-frr-in-biometria\">5.5 False Acceptance Rate (FAR) e False Rejection Rate (FRR) in Biometria</h3>\n<p>In sistemi biometrici di verifica dell&rsquo;identità:</p>\n<p><strong>FAR (False Acceptance Rate)</strong>:\n$\\text{FAR} = \\frac{\\text{Numero di impostori accettati}}{\\text{Numero totale di tentativi da impostori}} = \\frac{FP}{FP + TN}$</p>\n<p><strong>FRR (False Rejection Rate)</strong>:\n$\\text{FRR} = \\frac{\\text{Numero di genuini rifiutati}}{\\text{Numero totale di tentativi genuini}} = \\frac{FN}{FN + TP}$</p>\n<p><strong>GAR (Genuine Acceptance Rate)</strong>:\n$\\text{GAR} = 1 - \\text{FRR} = \\frac{TP}{TP + FN}$</p>\n<details class=\"code-container\">\n<summary>Code</summary>\n<div class=\"code-wrapper\">\n<button class=\"copy-button\" onclick=\"\n                const code = this.parentElement.querySelector('pre');\n                if (code) {\n                    navigator.clipboard.writeText(code.innerText);\n                    this.textContent = 'Copied!';\n                    setTimeout(() => this.textContent = 'Copy', 2000);\n                }\n            \">Copy</button>\n<div class=\"codehilite\"><pre><span></span><code><span class=\"c1\"># Simulazione sistema biometrico</span>\n<span class=\"n\">thresholds</span> <span class=\"o\">=</span> <span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">linspace</span><span class=\"p\">(</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"mi\">1</span><span class=\"p\">,</span> <span class=\"mi\">100</span><span class=\"p\">)</span>\n<span class=\"n\">fars</span> <span class=\"o\">=</span> <span class=\"p\">[]</span>\n<span class=\"n\">frrs</span> <span class=\"o\">=</span> <span class=\"p\">[]</span>\n\n<span class=\"k\">for</span> <span class=\"n\">tau</span> <span class=\"ow\">in</span> <span class=\"n\">thresholds</span><span class=\"p\">:</span>\n    <span class=\"n\">y_pred_tau</span> <span class=\"o\">=</span> <span class=\"p\">(</span><span class=\"n\">y_proba</span> <span class=\"o\">&gt;=</span> <span class=\"n\">tau</span><span class=\"p\">)</span><span class=\"o\">.</span><span class=\"n\">astype</span><span class=\"p\">(</span><span class=\"nb\">int</span><span class=\"p\">)</span>\n    <span class=\"n\">cm_tau</span> <span class=\"o\">=</span> <span class=\"n\">confusion_matrix</span><span class=\"p\">(</span><span class=\"n\">y_test</span><span class=\"p\">,</span> <span class=\"n\">y_pred_tau</span><span class=\"p\">)</span>\n    <span class=\"k\">if</span> <span class=\"n\">cm_tau</span><span class=\"o\">.</span><span class=\"n\">shape</span> <span class=\"o\">==</span> <span class=\"p\">(</span><span class=\"mi\">2</span><span class=\"p\">,</span> <span class=\"mi\">2</span><span class=\"p\">):</span>\n        <span class=\"n\">tn_t</span><span class=\"p\">,</span> <span class=\"n\">fp_t</span><span class=\"p\">,</span> <span class=\"n\">fn_t</span><span class=\"p\">,</span> <span class=\"n\">tp_t</span> <span class=\"o\">=</span> <span class=\"n\">cm_tau</span><span class=\"o\">.</span><span class=\"n\">ravel</span><span class=\"p\">()</span>\n        <span class=\"n\">far</span> <span class=\"o\">=</span> <span class=\"n\">fp_t</span> <span class=\"o\">/</span> <span class=\"p\">(</span><span class=\"n\">fp_t</span> <span class=\"o\">+</span> <span class=\"n\">tn_t</span><span class=\"p\">)</span> <span class=\"k\">if</span> <span class=\"p\">(</span><span class=\"n\">fp_t</span> <span class=\"o\">+</span> <span class=\"n\">tn_t</span><span class=\"p\">)</span> <span class=\"o\">&gt;</span> <span class=\"mi\">0</span> <span class=\"k\">else</span> <span class=\"mi\">0</span>\n        <span class=\"n\">frr</span> <span class=\"o\">=</span> <span class=\"n\">fn_t</span> <span class=\"o\">/</span> <span class=\"p\">(</span><span class=\"n\">fn_t</span> <span class=\"o\">+</span> <span class=\"n\">tp_t</span><span class=\"p\">)</span> <span class=\"k\">if</span> <span class=\"p\">(</span><span class=\"n\">fn_t</span> <span class=\"o\">+</span> <span class=\"n\">tp_t</span><span class=\"p\">)</span> <span class=\"o\">&gt;</span> <span class=\"mi\">0</span> <span class=\"k\">else</span> <span class=\"mi\">0</span>\n    <span class=\"k\">else</span><span class=\"p\">:</span>\n        <span class=\"n\">far</span><span class=\"p\">,</span> <span class=\"n\">frr</span> <span class=\"o\">=</span> <span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"mi\">0</span>\n    <span class=\"n\">fars</span><span class=\"o\">.</span><span class=\"n\">append</span><span class=\"p\">(</span><span class=\"n\">far</span><span class=\"p\">)</span>\n    <span class=\"n\">frrs</span><span class=\"o\">.</span><span class=\"n\">append</span><span class=\"p\">(</span><span class=\"n\">frr</span><span class=\"p\">)</span>\n\n<span class=\"n\">fig</span><span class=\"p\">,</span> <span class=\"n\">axes</span> <span class=\"o\">=</span> <span class=\"n\">plt</span><span class=\"o\">.</span><span class=\"n\">subplots</span><span class=\"p\">(</span><span class=\"mi\">1</span><span class=\"p\">,</span> <span class=\"mi\">2</span><span class=\"p\">,</span> <span class=\"n\">figsize</span><span class=\"o\">=</span><span class=\"p\">(</span><span class=\"mi\">15</span><span class=\"p\">,</span> <span class=\"mi\">5</span><span class=\"p\">))</span>\n\n<span class=\"c1\"># FAR e FRR vs Threshold</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">plot</span><span class=\"p\">(</span><span class=\"n\">thresholds</span><span class=\"p\">,</span> <span class=\"n\">fars</span><span class=\"p\">,</span> <span class=\"n\">label</span><span class=\"o\">=</span><span class=\"s1\">&#39;FAR (False Acceptance Rate)&#39;</span><span class=\"p\">,</span> <span class=\"n\">linewidth</span><span class=\"o\">=</span><span class=\"mi\">2</span><span class=\"p\">,</span> <span class=\"n\">color</span><span class=\"o\">=</span><span class=\"s1\">&#39;red&#39;</span><span class=\"p\">)</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">plot</span><span class=\"p\">(</span><span class=\"n\">thresholds</span><span class=\"p\">,</span> <span class=\"n\">frrs</span><span class=\"p\">,</span> <span class=\"n\">label</span><span class=\"o\">=</span><span class=\"s1\">&#39;FRR (False Rejection Rate)&#39;</span><span class=\"p\">,</span> <span class=\"n\">linewidth</span><span class=\"o\">=</span><span class=\"mi\">2</span><span class=\"p\">,</span> <span class=\"n\">color</span><span class=\"o\">=</span><span class=\"s1\">&#39;orange&#39;</span><span class=\"p\">)</span>\n\n<span class=\"c1\"># Trova EER</span>\n<span class=\"n\">diff</span> <span class=\"o\">=</span> <span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">abs</span><span class=\"p\">(</span><span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">array</span><span class=\"p\">(</span><span class=\"n\">fars</span><span class=\"p\">)</span> <span class=\"o\">-</span> <span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">array</span><span class=\"p\">(</span><span class=\"n\">frrs</span><span class=\"p\">))</span>\n<span class=\"n\">eer_idx</span> <span class=\"o\">=</span> <span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">argmin</span><span class=\"p\">(</span><span class=\"n\">diff</span><span class=\"p\">)</span>\n<span class=\"n\">eer_threshold</span> <span class=\"o\">=</span> <span class=\"n\">thresholds</span><span class=\"p\">[</span><span class=\"n\">eer_idx</span><span class=\"p\">]</span>\n<span class=\"n\">eer_value</span> <span class=\"o\">=</span> <span class=\"p\">(</span><span class=\"n\">fars</span><span class=\"p\">[</span><span class=\"n\">eer_idx</span><span class=\"p\">]</span> <span class=\"o\">+</span> <span class=\"n\">frrs</span><span class=\"p\">[</span><span class=\"n\">eer_idx</span><span class=\"p\">])</span> <span class=\"o\">/</span> <span class=\"mi\">2</span>\n\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">plot</span><span class=\"p\">(</span><span class=\"n\">eer_threshold</span><span class=\"p\">,</span> <span class=\"n\">eer_value</span><span class=\"p\">,</span> <span class=\"s1\">&#39;go&#39;</span><span class=\"p\">,</span> <span class=\"n\">markersize</span><span class=\"o\">=</span><span class=\"mi\">12</span><span class=\"p\">,</span> \n            <span class=\"n\">label</span><span class=\"o\">=</span><span class=\"sa\">f</span><span class=\"s1\">&#39;EER = </span><span class=\"si\">{</span><span class=\"n\">eer_value</span><span class=\"si\">:</span><span class=\"s1\">.3f</span><span class=\"si\">}</span><span class=\"s1\"> @ τ=</span><span class=\"si\">{</span><span class=\"n\">eer_threshold</span><span class=\"si\">:</span><span class=\"s1\">.3f</span><span class=\"si\">}</span><span class=\"s1\">&#39;</span><span class=\"p\">)</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">axvline</span><span class=\"p\">(</span><span class=\"n\">eer_threshold</span><span class=\"p\">,</span> <span class=\"n\">color</span><span class=\"o\">=</span><span class=\"s1\">&#39;green&#39;</span><span class=\"p\">,</span> <span class=\"n\">linestyle</span><span class=\"o\">=</span><span class=\"s1\">&#39;--&#39;</span><span class=\"p\">,</span> <span class=\"n\">alpha</span><span class=\"o\">=</span><span class=\"mf\">0.5</span><span class=\"p\">)</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">axhline</span><span class=\"p\">(</span><span class=\"n\">eer_value</span><span class=\"p\">,</span> <span class=\"n\">color</span><span class=\"o\">=</span><span class=\"s1\">&#39;green&#39;</span><span class=\"p\">,</span> <span class=\"n\">linestyle</span><span class=\"o\">=</span><span class=\"s1\">&#39;--&#39;</span><span class=\"p\">,</span> <span class=\"n\">alpha</span><span class=\"o\">=</span><span class=\"mf\">0.5</span><span class=\"p\">)</span>\n\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">set_xlabel</span><span class=\"p\">(</span><span class=\"s1\">&#39;Soglia di Accettazione (τ)&#39;</span><span class=\"p\">,</span> <span class=\"n\">fontsize</span><span class=\"o\">=</span><span class=\"mi\">12</span><span class=\"p\">)</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">set_ylabel</span><span class=\"p\">(</span><span class=\"s1\">&#39;Tasso di Errore&#39;</span><span class=\"p\">,</span> <span class=\"n\">fontsize</span><span class=\"o\">=</span><span class=\"mi\">12</span><span class=\"p\">)</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">set_title</span><span class=\"p\">(</span><span class=\"s1\">&#39;FAR e FRR al variare della Soglia (Sistema Biometrico)&#39;</span><span class=\"p\">,</span> <span class=\"n\">fontsize</span><span class=\"o\">=</span><span class=\"mi\">14</span><span class=\"p\">)</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">legend</span><span class=\"p\">()</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">grid</span><span class=\"p\">(</span><span class=\"n\">alpha</span><span class=\"o\">=</span><span class=\"mf\">0.3</span><span class=\"p\">)</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">set_xlim</span><span class=\"p\">([</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"mi\">1</span><span class=\"p\">])</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">set_ylim</span><span class=\"p\">([</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"mi\">1</span><span class=\"p\">])</span>\n\n<span class=\"c1\"># Interpretazione</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">axis</span><span class=\"p\">(</span><span class=\"s1\">&#39;off&#39;</span><span class=\"p\">)</span>\n<span class=\"n\">info_text</span> <span class=\"o\">=</span> <span class=\"sa\">f</span><span class=\"s2\">&quot;&quot;&quot;</span>\n<span class=\"s2\">INTERPRETAZIONE SOGLIA IN BIOMETRIA:</span>\n\n<span class=\"s2\">Soglia Bassa (τ → 0):</span>\n<span class=\"s2\">  • Sistema PERMISSIVO</span>\n<span class=\"s2\">  • FRR basso (pochi genuini rifiutati)</span>\n<span class=\"s2\">  • FAR alto (molti impostori accettati)</span>\n<span class=\"s2\">  • Uso: Applicazioni con bassa sicurezza</span>\n\n<span class=\"s2\">Soglia Alta (τ → 1):</span>\n<span class=\"s2\">  • Sistema RESTRITTIVO</span>\n<span class=\"s2\">  • FAR basso (pochi impostori accettati)</span>\n<span class=\"s2\">  • FRR alto (molti genuini rifiutati)</span>\n<span class=\"s2\">  • Uso: Applicazioni ad alta sicurezza</span>\n\n<span class=\"s2\">Equal Error Rate (EER):</span>\n<span class=\"s2\">  • Soglia ottimale: τ = </span><span class=\"si\">{</span><span class=\"n\">eer_threshold</span><span class=\"si\">:</span><span class=\"s2\">.3f</span><span class=\"si\">}</span>\n<span class=\"s2\">  • EER = </span><span class=\"si\">{</span><span class=\"n\">eer_value</span><span class=\"si\">:</span><span class=\"s2\">.3f</span><span class=\"si\">}</span>\n<span class=\"s2\">  • FAR = FRR (bilanciamento)</span>\n<span class=\"s2\">  • Metrica comune per confronto sistemi</span>\n\n<span class=\"s2\">Valori Attuali:</span>\n<span class=\"s2\">  • FAR = </span><span class=\"si\">{</span><span class=\"n\">fars</span><span class=\"p\">[</span><span class=\"n\">eer_idx</span><span class=\"p\">]</span><span class=\"si\">:</span><span class=\"s2\">.4f</span><span class=\"si\">}</span><span class=\"s2\"> (</span><span class=\"si\">{</span><span class=\"n\">fars</span><span class=\"p\">[</span><span class=\"n\">eer_idx</span><span class=\"p\">]</span><span class=\"o\">*</span><span class=\"mi\">100</span><span class=\"si\">:</span><span class=\"s2\">.2f</span><span class=\"si\">}</span><span class=\"s2\">%)</span>\n<span class=\"s2\">  • FRR = </span><span class=\"si\">{</span><span class=\"n\">frrs</span><span class=\"p\">[</span><span class=\"n\">eer_idx</span><span class=\"p\">]</span><span class=\"si\">:</span><span class=\"s2\">.4f</span><span class=\"si\">}</span><span class=\"s2\"> (</span><span class=\"si\">{</span><span class=\"n\">frrs</span><span class=\"p\">[</span><span class=\"n\">eer_idx</span><span class=\"p\">]</span><span class=\"o\">*</span><span class=\"mi\">100</span><span class=\"si\">:</span><span class=\"s2\">.2f</span><span class=\"si\">}</span><span class=\"s2\">%)</span>\n<span class=\"s2\">  • GAR = </span><span class=\"si\">{</span><span class=\"mi\">1</span><span class=\"o\">-</span><span class=\"n\">frrs</span><span class=\"p\">[</span><span class=\"n\">eer_idx</span><span class=\"p\">]</span><span class=\"si\">:</span><span class=\"s2\">.4f</span><span class=\"si\">}</span><span class=\"s2\"> (</span><span class=\"si\">{</span><span class=\"p\">(</span><span class=\"mi\">1</span><span class=\"o\">-</span><span class=\"n\">frrs</span><span class=\"p\">[</span><span class=\"n\">eer_idx</span><span class=\"p\">])</span><span class=\"o\">*</span><span class=\"mi\">100</span><span class=\"si\">:</span><span class=\"s2\">.2f</span><span class=\"si\">}</span><span class=\"s2\">%)</span>\n<span class=\"s2\">&quot;&quot;&quot;</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">text</span><span class=\"p\">(</span><span class=\"mf\">0.1</span><span class=\"p\">,</span> <span class=\"mf\">0.9</span><span class=\"p\">,</span> <span class=\"n\">info_text</span><span class=\"p\">,</span> <span class=\"n\">fontsize</span><span class=\"o\">=</span><span class=\"mi\">10</span><span class=\"p\">,</span> <span class=\"n\">verticalalignment</span><span class=\"o\">=</span><span class=\"s1\">&#39;top&#39;</span><span class=\"p\">,</span>\n            <span class=\"n\">family</span><span class=\"o\">=</span><span class=\"s1\">&#39;monospace&#39;</span><span class=\"p\">,</span> <span class=\"n\">bbox</span><span class=\"o\">=</span><span class=\"nb\">dict</span><span class=\"p\">(</span><span class=\"n\">boxstyle</span><span class=\"o\">=</span><span class=\"s1\">&#39;round&#39;</span><span class=\"p\">,</span> <span class=\"n\">facecolor</span><span class=\"o\">=</span><span class=\"s1\">&#39;wheat&#39;</span><span class=\"p\">,</span> <span class=\"n\">alpha</span><span class=\"o\">=</span><span class=\"mf\">0.5</span><span class=\"p\">))</span>\n\n<span class=\"n\">plt</span><span class=\"o\">.</span><span class=\"n\">tight_layout</span><span class=\"p\">()</span>\n<span class=\"n\">plt</span><span class=\"o\">.</span><span class=\"n\">show</span><span class=\"p\">()</span>\n\n<span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"sa\">f</span><span class=\"s2\">&quot;Equal Error Rate (EER): </span><span class=\"si\">{</span><span class=\"n\">eer_value</span><span class=\"si\">:</span><span class=\"s2\">.4f</span><span class=\"si\">}</span><span class=\"s2\">&quot;</span><span class=\"p\">)</span>\n<span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"sa\">f</span><span class=\"s2\">&quot;EER Threshold: </span><span class=\"si\">{</span><span class=\"n\">eer_threshold</span><span class=\"si\">:</span><span class=\"s2\">.4f</span><span class=\"si\">}</span><span class=\"s2\">&quot;</span><span class=\"p\">)</span>\n</code></pre></div>\n</div>\n</details>\n\n<h2 id=\"6-curve-roc-e-auc\">6. Curve ROC e AUC</h2>\n<h3 id=\"61-curva-roc-receiver-operating-characteristic\">6.1 Curva ROC (Receiver Operating Characteristic)</h3>\n<p>La <strong>curva ROC</strong> visualizza il trade-off tra TPR (Recall/Sensitivity) e FPR (Fall-out) al variare della soglia di classificazione:</p>\n<ul>\n<li><strong>Asse Y</strong>: True Positive Rate (TPR) = Recall = Sensitivity = 1 - FRR</li>\n<li><strong>Asse X</strong>: False Positive Rate (FPR) = Fall-out = 1 - Specificity = FAR</li>\n</ul>\n<p>$\\text{TPR}(\\tau) = \\frac{TP(\\tau)}{TP(\\tau) + FN(\\tau)}$\n$\\text{FPR}(\\tau) = \\frac{FP(\\tau)}{FP(\\tau) + TN(\\tau)}$</p>\n<p><strong>Interpretazione</strong>:\n- Punto (0, 0): Tutto classificato come negativo (soglia infinita)\n- Punto (1, 1): Tutto classificato come positivo (soglia zero)\n- Punto (0, 1): Classificatore perfetto\n- Diagonale: Classificatore casuale</p>\n<details class=\"code-container\">\n<summary>Code</summary>\n<div class=\"code-wrapper\">\n<button class=\"copy-button\" onclick=\"\n                const code = this.parentElement.querySelector('pre');\n                if (code) {\n                    navigator.clipboard.writeText(code.innerText);\n                    this.textContent = 'Copied!';\n                    setTimeout(() => this.textContent = 'Copy', 2000);\n                }\n            \">Copy</button>\n<div class=\"codehilite\"><pre><span></span><code><span class=\"kn\">from</span><span class=\"w\"> </span><span class=\"nn\">sklearn.metrics</span><span class=\"w\"> </span><span class=\"kn\">import</span> <span class=\"n\">roc_curve</span><span class=\"p\">,</span> <span class=\"n\">auc</span>\n\n<span class=\"n\">fpr_roc</span><span class=\"p\">,</span> <span class=\"n\">tpr_roc</span><span class=\"p\">,</span> <span class=\"n\">thresholds_roc</span> <span class=\"o\">=</span> <span class=\"n\">roc_curve</span><span class=\"p\">(</span><span class=\"n\">y_test</span><span class=\"p\">,</span> <span class=\"n\">y_proba</span><span class=\"p\">)</span>\n<span class=\"n\">roc_auc</span> <span class=\"o\">=</span> <span class=\"n\">auc</span><span class=\"p\">(</span><span class=\"n\">fpr_roc</span><span class=\"p\">,</span> <span class=\"n\">tpr_roc</span><span class=\"p\">)</span>\n\n<span class=\"n\">fig</span><span class=\"p\">,</span> <span class=\"n\">axes</span> <span class=\"o\">=</span> <span class=\"n\">plt</span><span class=\"o\">.</span><span class=\"n\">subplots</span><span class=\"p\">(</span><span class=\"mi\">1</span><span class=\"p\">,</span> <span class=\"mi\">2</span><span class=\"p\">,</span> <span class=\"n\">figsize</span><span class=\"o\">=</span><span class=\"p\">(</span><span class=\"mi\">15</span><span class=\"p\">,</span> <span class=\"mi\">6</span><span class=\"p\">))</span>\n\n<span class=\"c1\"># Curva ROC standard</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">plot</span><span class=\"p\">(</span><span class=\"n\">fpr_roc</span><span class=\"p\">,</span> <span class=\"n\">tpr_roc</span><span class=\"p\">,</span> <span class=\"n\">color</span><span class=\"o\">=</span><span class=\"s1\">&#39;darkorange&#39;</span><span class=\"p\">,</span> <span class=\"n\">lw</span><span class=\"o\">=</span><span class=\"mi\">3</span><span class=\"p\">,</span> \n            <span class=\"n\">label</span><span class=\"o\">=</span><span class=\"sa\">f</span><span class=\"s1\">&#39;ROC curve (AUC = </span><span class=\"si\">{</span><span class=\"n\">roc_auc</span><span class=\"si\">:</span><span class=\"s1\">.3f</span><span class=\"si\">}</span><span class=\"s1\">)&#39;</span><span class=\"p\">)</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">plot</span><span class=\"p\">([</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"mi\">1</span><span class=\"p\">],</span> <span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"mi\">1</span><span class=\"p\">],</span> <span class=\"n\">color</span><span class=\"o\">=</span><span class=\"s1\">&#39;navy&#39;</span><span class=\"p\">,</span> <span class=\"n\">lw</span><span class=\"o\">=</span><span class=\"mi\">2</span><span class=\"p\">,</span> <span class=\"n\">linestyle</span><span class=\"o\">=</span><span class=\"s1\">&#39;--&#39;</span><span class=\"p\">,</span> \n            <span class=\"n\">label</span><span class=\"o\">=</span><span class=\"s1\">&#39;Random Classifier (AUC = 0.5)&#39;</span><span class=\"p\">)</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">fill_between</span><span class=\"p\">(</span><span class=\"n\">fpr_roc</span><span class=\"p\">,</span> <span class=\"n\">tpr_roc</span><span class=\"p\">,</span> <span class=\"n\">alpha</span><span class=\"o\">=</span><span class=\"mf\">0.3</span><span class=\"p\">,</span> <span class=\"n\">color</span><span class=\"o\">=</span><span class=\"s1\">&#39;orange&#39;</span><span class=\"p\">)</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">scatter</span><span class=\"p\">([</span><span class=\"mi\">0</span><span class=\"p\">],</span> <span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">],</span> <span class=\"n\">s</span><span class=\"o\">=</span><span class=\"mi\">200</span><span class=\"p\">,</span> <span class=\"n\">c</span><span class=\"o\">=</span><span class=\"s1\">&#39;green&#39;</span><span class=\"p\">,</span> <span class=\"n\">marker</span><span class=\"o\">=</span><span class=\"s1\">&#39;*&#39;</span><span class=\"p\">,</span> <span class=\"n\">zorder</span><span class=\"o\">=</span><span class=\"mi\">5</span><span class=\"p\">,</span> \n               <span class=\"n\">label</span><span class=\"o\">=</span><span class=\"s1\">&#39;Classificatore Perfetto&#39;</span><span class=\"p\">)</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">set_xlim</span><span class=\"p\">([</span><span class=\"mf\">0.0</span><span class=\"p\">,</span> <span class=\"mf\">1.0</span><span class=\"p\">])</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">set_ylim</span><span class=\"p\">([</span><span class=\"mf\">0.0</span><span class=\"p\">,</span> <span class=\"mf\">1.05</span><span class=\"p\">])</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">set_xlabel</span><span class=\"p\">(</span><span class=\"s1\">&#39;False Positive Rate (FPR = 1 - Specificity)&#39;</span><span class=\"p\">,</span> <span class=\"n\">fontsize</span><span class=\"o\">=</span><span class=\"mi\">12</span><span class=\"p\">)</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">set_ylabel</span><span class=\"p\">(</span><span class=\"s1\">&#39;True Positive Rate (TPR = Recall = Sensitivity)&#39;</span><span class=\"p\">,</span> <span class=\"n\">fontsize</span><span class=\"o\">=</span><span class=\"mi\">12</span><span class=\"p\">)</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">set_title</span><span class=\"p\">(</span><span class=\"s1\">&#39;Receiver Operating Characteristic (ROC)&#39;</span><span class=\"p\">,</span> <span class=\"n\">fontsize</span><span class=\"o\">=</span><span class=\"mi\">14</span><span class=\"p\">,</span> <span class=\"n\">fontweight</span><span class=\"o\">=</span><span class=\"s1\">&#39;bold&#39;</span><span class=\"p\">)</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">legend</span><span class=\"p\">(</span><span class=\"n\">loc</span><span class=\"o\">=</span><span class=\"s2\">&quot;lower right&quot;</span><span class=\"p\">)</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">grid</span><span class=\"p\">(</span><span class=\"n\">alpha</span><span class=\"o\">=</span><span class=\"mf\">0.3</span><span class=\"p\">)</span>\n\n<span class=\"c1\"># Punti notevoli sulla curva</span>\n<span class=\"n\">idx_eer</span> <span class=\"o\">=</span> <span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">argmin</span><span class=\"p\">(</span><span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">abs</span><span class=\"p\">(</span><span class=\"n\">fpr_roc</span> <span class=\"o\">-</span> <span class=\"p\">(</span><span class=\"mi\">1</span> <span class=\"o\">-</span> <span class=\"n\">tpr_roc</span><span class=\"p\">)))</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">plot</span><span class=\"p\">(</span><span class=\"n\">fpr_roc</span><span class=\"p\">[</span><span class=\"n\">idx_eer</span><span class=\"p\">],</span> <span class=\"n\">tpr_roc</span><span class=\"p\">[</span><span class=\"n\">idx_eer</span><span class=\"p\">],</span> <span class=\"s1\">&#39;ro&#39;</span><span class=\"p\">,</span> <span class=\"n\">markersize</span><span class=\"o\">=</span><span class=\"mi\">10</span><span class=\"p\">,</span> \n            <span class=\"n\">label</span><span class=\"o\">=</span><span class=\"sa\">f</span><span class=\"s1\">&#39;EER point&#39;</span><span class=\"p\">)</span>\n\n<span class=\"c1\"># ROC con annotazioni</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">plot</span><span class=\"p\">(</span><span class=\"n\">fpr_roc</span><span class=\"p\">,</span> <span class=\"n\">tpr_roc</span><span class=\"p\">,</span> <span class=\"n\">color</span><span class=\"o\">=</span><span class=\"s1\">&#39;darkorange&#39;</span><span class=\"p\">,</span> <span class=\"n\">lw</span><span class=\"o\">=</span><span class=\"mi\">3</span><span class=\"p\">)</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">plot</span><span class=\"p\">([</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"mi\">1</span><span class=\"p\">],</span> <span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"mi\">1</span><span class=\"p\">],</span> <span class=\"n\">color</span><span class=\"o\">=</span><span class=\"s1\">&#39;navy&#39;</span><span class=\"p\">,</span> <span class=\"n\">lw</span><span class=\"o\">=</span><span class=\"mi\">2</span><span class=\"p\">,</span> <span class=\"n\">linestyle</span><span class=\"o\">=</span><span class=\"s1\">&#39;--&#39;</span><span class=\"p\">)</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">fill_between</span><span class=\"p\">(</span><span class=\"n\">fpr_roc</span><span class=\"p\">,</span> <span class=\"n\">tpr_roc</span><span class=\"p\">,</span> <span class=\"n\">alpha</span><span class=\"o\">=</span><span class=\"mf\">0.2</span><span class=\"p\">,</span> <span class=\"n\">color</span><span class=\"o\">=</span><span class=\"s1\">&#39;orange&#39;</span><span class=\"p\">,</span> <span class=\"n\">label</span><span class=\"o\">=</span><span class=\"s1\">&#39;AUC&#39;</span><span class=\"p\">)</span>\n\n<span class=\"c1\"># Annotazioni interpretative</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">annotate</span><span class=\"p\">(</span><span class=\"s1\">&#39;Soglia Alta</span><span class=\"se\">\\n</span><span class=\"s1\">(Conservativo)</span><span class=\"se\">\\n</span><span class=\"s1\">FAR↓ FRR↑&#39;</span><span class=\"p\">,</span> \n                <span class=\"n\">xy</span><span class=\"o\">=</span><span class=\"p\">(</span><span class=\"mf\">0.1</span><span class=\"p\">,</span> <span class=\"mf\">0.5</span><span class=\"p\">),</span> <span class=\"n\">fontsize</span><span class=\"o\">=</span><span class=\"mi\">10</span><span class=\"p\">,</span> <span class=\"n\">ha</span><span class=\"o\">=</span><span class=\"s1\">&#39;center&#39;</span><span class=\"p\">,</span>\n                <span class=\"n\">bbox</span><span class=\"o\">=</span><span class=\"nb\">dict</span><span class=\"p\">(</span><span class=\"n\">boxstyle</span><span class=\"o\">=</span><span class=\"s1\">&#39;round&#39;</span><span class=\"p\">,</span> <span class=\"n\">facecolor</span><span class=\"o\">=</span><span class=\"s1\">&#39;lightblue&#39;</span><span class=\"p\">,</span> <span class=\"n\">alpha</span><span class=\"o\">=</span><span class=\"mf\">0.7</span><span class=\"p\">))</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">annotate</span><span class=\"p\">(</span><span class=\"s1\">&#39;Soglia Bassa</span><span class=\"se\">\\n</span><span class=\"s1\">(Permissivo)</span><span class=\"se\">\\n</span><span class=\"s1\">FAR↑ FRR↓&#39;</span><span class=\"p\">,</span> \n                <span class=\"n\">xy</span><span class=\"o\">=</span><span class=\"p\">(</span><span class=\"mf\">0.7</span><span class=\"p\">,</span> <span class=\"mf\">0.9</span><span class=\"p\">),</span> <span class=\"n\">fontsize</span><span class=\"o\">=</span><span class=\"mi\">10</span><span class=\"p\">,</span> <span class=\"n\">ha</span><span class=\"o\">=</span><span class=\"s1\">&#39;center&#39;</span><span class=\"p\">,</span>\n                <span class=\"n\">bbox</span><span class=\"o\">=</span><span class=\"nb\">dict</span><span class=\"p\">(</span><span class=\"n\">boxstyle</span><span class=\"o\">=</span><span class=\"s1\">&#39;round&#39;</span><span class=\"p\">,</span> <span class=\"n\">facecolor</span><span class=\"o\">=</span><span class=\"s1\">&#39;lightcoral&#39;</span><span class=\"p\">,</span> <span class=\"n\">alpha</span><span class=\"o\">=</span><span class=\"mf\">0.7</span><span class=\"p\">))</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">annotate</span><span class=\"p\">(</span><span class=\"s1\">&#39;EER</span><span class=\"se\">\\n</span><span class=\"s1\">Bilanciato&#39;</span><span class=\"p\">,</span> \n                <span class=\"n\">xy</span><span class=\"o\">=</span><span class=\"p\">(</span><span class=\"n\">fpr_roc</span><span class=\"p\">[</span><span class=\"n\">idx_eer</span><span class=\"p\">],</span> <span class=\"n\">tpr_roc</span><span class=\"p\">[</span><span class=\"n\">idx_eer</span><span class=\"p\">]),</span> \n                <span class=\"n\">xytext</span><span class=\"o\">=</span><span class=\"p\">(</span><span class=\"mf\">0.5</span><span class=\"p\">,</span> <span class=\"mf\">0.4</span><span class=\"p\">),</span> <span class=\"n\">fontsize</span><span class=\"o\">=</span><span class=\"mi\">10</span><span class=\"p\">,</span>\n                <span class=\"n\">arrowprops</span><span class=\"o\">=</span><span class=\"nb\">dict</span><span class=\"p\">(</span><span class=\"n\">arrowstyle</span><span class=\"o\">=</span><span class=\"s1\">&#39;-&gt;&#39;</span><span class=\"p\">,</span> <span class=\"n\">color</span><span class=\"o\">=</span><span class=\"s1\">&#39;red&#39;</span><span class=\"p\">,</span> <span class=\"n\">lw</span><span class=\"o\">=</span><span class=\"mi\">2</span><span class=\"p\">),</span>\n                <span class=\"n\">bbox</span><span class=\"o\">=</span><span class=\"nb\">dict</span><span class=\"p\">(</span><span class=\"n\">boxstyle</span><span class=\"o\">=</span><span class=\"s1\">&#39;round&#39;</span><span class=\"p\">,</span> <span class=\"n\">facecolor</span><span class=\"o\">=</span><span class=\"s1\">&#39;yellow&#39;</span><span class=\"p\">,</span> <span class=\"n\">alpha</span><span class=\"o\">=</span><span class=\"mf\">0.7</span><span class=\"p\">))</span>\n\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">set_xlim</span><span class=\"p\">([</span><span class=\"mf\">0.0</span><span class=\"p\">,</span> <span class=\"mf\">1.0</span><span class=\"p\">])</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">set_ylim</span><span class=\"p\">([</span><span class=\"mf\">0.0</span><span class=\"p\">,</span> <span class=\"mf\">1.05</span><span class=\"p\">])</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">set_xlabel</span><span class=\"p\">(</span><span class=\"s1\">&#39;FPR (False Positive Rate)&#39;</span><span class=\"p\">,</span> <span class=\"n\">fontsize</span><span class=\"o\">=</span><span class=\"mi\">12</span><span class=\"p\">)</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">set_ylabel</span><span class=\"p\">(</span><span class=\"s1\">&#39;TPR (True Positive Rate)&#39;</span><span class=\"p\">,</span> <span class=\"n\">fontsize</span><span class=\"o\">=</span><span class=\"mi\">12</span><span class=\"p\">)</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">set_title</span><span class=\"p\">(</span><span class=\"s1\">&#39;ROC: Interpretazione delle Zone&#39;</span><span class=\"p\">,</span> <span class=\"n\">fontsize</span><span class=\"o\">=</span><span class=\"mi\">14</span><span class=\"p\">,</span> <span class=\"n\">fontweight</span><span class=\"o\">=</span><span class=\"s1\">&#39;bold&#39;</span><span class=\"p\">)</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">legend</span><span class=\"p\">(</span><span class=\"n\">loc</span><span class=\"o\">=</span><span class=\"s2\">&quot;lower right&quot;</span><span class=\"p\">)</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">grid</span><span class=\"p\">(</span><span class=\"n\">alpha</span><span class=\"o\">=</span><span class=\"mf\">0.3</span><span class=\"p\">)</span>\n\n<span class=\"n\">plt</span><span class=\"o\">.</span><span class=\"n\">tight_layout</span><span class=\"p\">()</span>\n<span class=\"n\">plt</span><span class=\"o\">.</span><span class=\"n\">show</span><span class=\"p\">()</span>\n</code></pre></div>\n</div>\n</details>\n\n<h3 id=\"62-auc-area-under-the-roc-curve\">6.2 AUC (Area Under the ROC Curve)</h3>\n<p>L&rsquo;<strong>AUC</strong> quantifica l&rsquo;area sotto la curva ROC:</p>\n<p>$\\text{AUC} = \\int_0^1 \\text{TPR}(t) \\, d(\\text{FPR}(t)) = P(score_{positive} > score_{negative})$</p>\n<p>L&rsquo;AUC rappresenta la <strong>probabilità che il classificatore assegni uno score più alto a un esempio positivo casuale rispetto a uno negativo casuale</strong>.</p>\n<p><strong>Interpretazione Rigorosa</strong>:\n- <strong>AUC = 1.0</strong>: Classificatore perfetto (separa completamente le classi)\n- <strong>AUC = 0.5</strong>: Classificatore casuale (nessun potere discriminante)\n- <strong>AUC &lt; 0.5</strong>: Peggio del caso (predizioni invertite)\n- <strong>0.5 &lt; AUC &lt; 0.7</strong>: Scarso\n- <strong>0.7 ≤ AUC &lt; 0.8</strong>: Accettabile<br />\n- <strong>0.8 ≤ AUC &lt; 0.9</strong>: Eccellente\n- <strong>AUC ≥ 0.9</strong>: Outstanding</p>\n<p><strong>Proprietà matematiche</strong>:\n- Invariante alla scala (dipende solo dall&rsquo;ordinamento)\n- Robusta a classi sbilanciate (confronta distribuzioni)\n- Equivale al test di Wilcoxon-Mann-Whitney</p>\n<details class=\"code-container\">\n<summary>Code</summary>\n<div class=\"code-wrapper\">\n<button class=\"copy-button\" onclick=\"\n                const code = this.parentElement.querySelector('pre');\n                if (code) {\n                    navigator.clipboard.writeText(code.innerText);\n                    this.textContent = 'Copied!';\n                    setTimeout(() => this.textContent = 'Copy', 2000);\n                }\n            \">Copy</button>\n<div class=\"codehilite\"><pre><span></span><code><span class=\"kn\">from</span><span class=\"w\"> </span><span class=\"nn\">sklearn.metrics</span><span class=\"w\"> </span><span class=\"kn\">import</span> <span class=\"n\">roc_auc_score</span>\n\n<span class=\"n\">auc_score</span> <span class=\"o\">=</span> <span class=\"n\">roc_auc_score</span><span class=\"p\">(</span><span class=\"n\">y_test</span><span class=\"p\">,</span> <span class=\"n\">y_proba</span><span class=\"p\">)</span>\n\n<span class=\"c1\"># Visualizzazione interpretazione AUC</span>\n<span class=\"n\">fig</span><span class=\"p\">,</span> <span class=\"n\">axes</span> <span class=\"o\">=</span> <span class=\"n\">plt</span><span class=\"o\">.</span><span class=\"n\">subplots</span><span class=\"p\">(</span><span class=\"mi\">2</span><span class=\"p\">,</span> <span class=\"mi\">2</span><span class=\"p\">,</span> <span class=\"n\">figsize</span><span class=\"o\">=</span><span class=\"p\">(</span><span class=\"mi\">14</span><span class=\"p\">,</span> <span class=\"mi\">10</span><span class=\"p\">))</span>\n\n<span class=\"c1\"># Simulazione diversi classificatori</span>\n<span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">random</span><span class=\"o\">.</span><span class=\"n\">seed</span><span class=\"p\">(</span><span class=\"mi\">42</span><span class=\"p\">)</span>\n<span class=\"n\">classifiers</span> <span class=\"o\">=</span> <span class=\"p\">{</span>\n    <span class=\"s1\">&#39;Perfetto&#39;</span><span class=\"p\">:</span> <span class=\"p\">(</span><span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">random</span><span class=\"o\">.</span><span class=\"n\">beta</span><span class=\"p\">(</span><span class=\"mi\">9</span><span class=\"p\">,</span> <span class=\"mi\">1</span><span class=\"p\">,</span> <span class=\"mi\">500</span><span class=\"p\">),</span> <span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">random</span><span class=\"o\">.</span><span class=\"n\">beta</span><span class=\"p\">(</span><span class=\"mi\">1</span><span class=\"p\">,</span> <span class=\"mi\">9</span><span class=\"p\">,</span> <span class=\"mi\">500</span><span class=\"p\">)),</span>\n    <span class=\"s1\">&#39;Eccellente&#39;</span><span class=\"p\">:</span> <span class=\"p\">(</span><span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">random</span><span class=\"o\">.</span><span class=\"n\">beta</span><span class=\"p\">(</span><span class=\"mi\">7</span><span class=\"p\">,</span> <span class=\"mi\">2</span><span class=\"p\">,</span> <span class=\"mi\">500</span><span class=\"p\">),</span> <span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">random</span><span class=\"o\">.</span><span class=\"n\">beta</span><span class=\"p\">(</span><span class=\"mi\">2</span><span class=\"p\">,</span> <span class=\"mi\">7</span><span class=\"p\">,</span> <span class=\"mi\">500</span><span class=\"p\">)),</span>\n    <span class=\"s1\">&#39;Buono&#39;</span><span class=\"p\">:</span> <span class=\"p\">(</span><span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">random</span><span class=\"o\">.</span><span class=\"n\">beta</span><span class=\"p\">(</span><span class=\"mi\">5</span><span class=\"p\">,</span> <span class=\"mi\">3</span><span class=\"p\">,</span> <span class=\"mi\">500</span><span class=\"p\">),</span> <span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">random</span><span class=\"o\">.</span><span class=\"n\">beta</span><span class=\"p\">(</span><span class=\"mi\">3</span><span class=\"p\">,</span> <span class=\"mi\">5</span><span class=\"p\">,</span> <span class=\"mi\">500</span><span class=\"p\">)),</span>\n    <span class=\"s1\">&#39;Casuale&#39;</span><span class=\"p\">:</span> <span class=\"p\">(</span><span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">random</span><span class=\"o\">.</span><span class=\"n\">uniform</span><span class=\"p\">(</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"mi\">1</span><span class=\"p\">,</span> <span class=\"mi\">500</span><span class=\"p\">),</span> <span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">random</span><span class=\"o\">.</span><span class=\"n\">uniform</span><span class=\"p\">(</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"mi\">1</span><span class=\"p\">,</span> <span class=\"mi\">500</span><span class=\"p\">))</span>\n<span class=\"p\">}</span>\n\n<span class=\"k\">for</span> <span class=\"n\">idx</span><span class=\"p\">,</span> <span class=\"p\">(</span><span class=\"n\">name</span><span class=\"p\">,</span> <span class=\"p\">(</span><span class=\"n\">pos_scores</span><span class=\"p\">,</span> <span class=\"n\">neg_scores</span><span class=\"p\">))</span> <span class=\"ow\">in</span> <span class=\"nb\">enumerate</span><span class=\"p\">(</span><span class=\"n\">classifiers</span><span class=\"o\">.</span><span class=\"n\">items</span><span class=\"p\">()):</span>\n    <span class=\"n\">ax</span> <span class=\"o\">=</span> <span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"n\">idx</span> <span class=\"o\">//</span> <span class=\"mi\">2</span><span class=\"p\">,</span> <span class=\"n\">idx</span> <span class=\"o\">%</span> <span class=\"mi\">2</span><span class=\"p\">]</span>\n\n    <span class=\"c1\"># Distribuzioni</span>\n    <span class=\"n\">ax</span><span class=\"o\">.</span><span class=\"n\">hist</span><span class=\"p\">(</span><span class=\"n\">neg_scores</span><span class=\"p\">,</span> <span class=\"n\">bins</span><span class=\"o\">=</span><span class=\"mi\">30</span><span class=\"p\">,</span> <span class=\"n\">alpha</span><span class=\"o\">=</span><span class=\"mf\">0.6</span><span class=\"p\">,</span> <span class=\"n\">label</span><span class=\"o\">=</span><span class=\"s1\">&#39;Negativi&#39;</span><span class=\"p\">,</span> <span class=\"n\">color</span><span class=\"o\">=</span><span class=\"s1\">&#39;red&#39;</span><span class=\"p\">,</span> <span class=\"n\">density</span><span class=\"o\">=</span><span class=\"kc\">True</span><span class=\"p\">)</span>\n    <span class=\"n\">ax</span><span class=\"o\">.</span><span class=\"n\">hist</span><span class=\"p\">(</span><span class=\"n\">pos_scores</span><span class=\"p\">,</span> <span class=\"n\">bins</span><span class=\"o\">=</span><span class=\"mi\">30</span><span class=\"p\">,</span> <span class=\"n\">alpha</span><span class=\"o\">=</span><span class=\"mf\">0.6</span><span class=\"p\">,</span> <span class=\"n\">label</span><span class=\"o\">=</span><span class=\"s1\">&#39;Positivi&#39;</span><span class=\"p\">,</span> <span class=\"n\">color</span><span class=\"o\">=</span><span class=\"s1\">&#39;green&#39;</span><span class=\"p\">,</span> <span class=\"n\">density</span><span class=\"o\">=</span><span class=\"kc\">True</span><span class=\"p\">)</span>\n\n    <span class=\"c1\"># Calcola AUC</span>\n    <span class=\"n\">y_true</span> <span class=\"o\">=</span> <span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">concatenate</span><span class=\"p\">([</span><span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">ones</span><span class=\"p\">(</span><span class=\"nb\">len</span><span class=\"p\">(</span><span class=\"n\">pos_scores</span><span class=\"p\">)),</span> <span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">zeros</span><span class=\"p\">(</span><span class=\"nb\">len</span><span class=\"p\">(</span><span class=\"n\">neg_scores</span><span class=\"p\">))])</span>\n    <span class=\"n\">y_scores</span> <span class=\"o\">=</span> <span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">concatenate</span><span class=\"p\">([</span><span class=\"n\">pos_scores</span><span class=\"p\">,</span> <span class=\"n\">neg_scores</span><span class=\"p\">])</span>\n    <span class=\"n\">auc_val</span> <span class=\"o\">=</span> <span class=\"n\">roc_auc_score</span><span class=\"p\">(</span><span class=\"n\">y_true</span><span class=\"p\">,</span> <span class=\"n\">y_scores</span><span class=\"p\">)</span>\n\n    <span class=\"n\">ax</span><span class=\"o\">.</span><span class=\"n\">set_xlabel</span><span class=\"p\">(</span><span class=\"s1\">&#39;Score&#39;</span><span class=\"p\">,</span> <span class=\"n\">fontsize</span><span class=\"o\">=</span><span class=\"mi\">11</span><span class=\"p\">)</span>\n    <span class=\"n\">ax</span><span class=\"o\">.</span><span class=\"n\">set_ylabel</span><span class=\"p\">(</span><span class=\"s1\">&#39;Densità&#39;</span><span class=\"p\">,</span> <span class=\"n\">fontsize</span><span class=\"o\">=</span><span class=\"mi\">11</span><span class=\"p\">)</span>\n    <span class=\"n\">ax</span><span class=\"o\">.</span><span class=\"n\">set_title</span><span class=\"p\">(</span><span class=\"sa\">f</span><span class=\"s1\">&#39;</span><span class=\"si\">{</span><span class=\"n\">name</span><span class=\"si\">}</span><span class=\"s1\">: AUC = </span><span class=\"si\">{</span><span class=\"n\">auc_val</span><span class=\"si\">:</span><span class=\"s1\">.3f</span><span class=\"si\">}</span><span class=\"s1\">&#39;</span><span class=\"p\">,</span> <span class=\"n\">fontsize</span><span class=\"o\">=</span><span class=\"mi\">12</span><span class=\"p\">,</span> <span class=\"n\">fontweight</span><span class=\"o\">=</span><span class=\"s1\">&#39;bold&#39;</span><span class=\"p\">)</span>\n    <span class=\"n\">ax</span><span class=\"o\">.</span><span class=\"n\">legend</span><span class=\"p\">()</span>\n    <span class=\"n\">ax</span><span class=\"o\">.</span><span class=\"n\">grid</span><span class=\"p\">(</span><span class=\"n\">alpha</span><span class=\"o\">=</span><span class=\"mf\">0.3</span><span class=\"p\">)</span>\n\n<span class=\"n\">plt</span><span class=\"o\">.</span><span class=\"n\">suptitle</span><span class=\"p\">(</span><span class=\"s1\">&#39;AUC e Separabilità delle Distribuzioni&#39;</span><span class=\"p\">,</span> <span class=\"n\">fontsize</span><span class=\"o\">=</span><span class=\"mi\">14</span><span class=\"p\">,</span> <span class=\"n\">fontweight</span><span class=\"o\">=</span><span class=\"s1\">&#39;bold&#39;</span><span class=\"p\">,</span> <span class=\"n\">y</span><span class=\"o\">=</span><span class=\"mf\">1.02</span><span class=\"p\">)</span>\n<span class=\"n\">plt</span><span class=\"o\">.</span><span class=\"n\">tight_layout</span><span class=\"p\">()</span>\n<span class=\"n\">plt</span><span class=\"o\">.</span><span class=\"n\">show</span><span class=\"p\">()</span>\n\n<span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"sa\">f</span><span class=\"s1\">&#39;AUC Score del modello: </span><span class=\"si\">{</span><span class=\"n\">auc_score</span><span class=\"si\">:</span><span class=\"s1\">.4f</span><span class=\"si\">}</span><span class=\"s1\">&#39;</span><span class=\"p\">)</span>\n</code></pre></div>\n</div>\n</details>\n\n<h3 id=\"63-proprieta-e-vantaggi-della-rocauc\">6.3 Proprietà e Vantaggi della ROC/AUC</h3>\n<details class=\"code-container\">\n<summary>Code</summary>\n<div class=\"code-wrapper\">\n<button class=\"copy-button\" onclick=\"\n                const code = this.parentElement.querySelector('pre');\n                if (code) {\n                    navigator.clipboard.writeText(code.innerText);\n                    this.textContent = 'Copied!';\n                    setTimeout(() => this.textContent = 'Copy', 2000);\n                }\n            \">Copy</button>\n<div class=\"codehilite\"><pre><span></span><code><span class=\"c1\"># Dimostrazione robustezza a classi sbilanciate</span>\n<span class=\"kn\">from</span><span class=\"w\"> </span><span class=\"nn\">sklearn.metrics</span><span class=\"w\"> </span><span class=\"kn\">import</span> <span class=\"n\">precision_recall_curve</span><span class=\"p\">,</span> <span class=\"n\">average_precision_score</span>\n\n<span class=\"c1\"># Crea dataset sbilanciato</span>\n<span class=\"n\">imbalance_ratios</span> <span class=\"o\">=</span> <span class=\"p\">[</span><span class=\"mf\">0.5</span><span class=\"p\">,</span> <span class=\"mf\">0.7</span><span class=\"p\">,</span> <span class=\"mf\">0.9</span><span class=\"p\">,</span> <span class=\"mf\">0.95</span><span class=\"p\">]</span>\n<span class=\"n\">aucs</span> <span class=\"o\">=</span> <span class=\"p\">[]</span>\n<span class=\"n\">aps</span> <span class=\"o\">=</span> <span class=\"p\">[]</span>\n\n<span class=\"n\">fig</span><span class=\"p\">,</span> <span class=\"n\">axes</span> <span class=\"o\">=</span> <span class=\"n\">plt</span><span class=\"o\">.</span><span class=\"n\">subplots</span><span class=\"p\">(</span><span class=\"mi\">2</span><span class=\"p\">,</span> <span class=\"mi\">2</span><span class=\"p\">,</span> <span class=\"n\">figsize</span><span class=\"o\">=</span><span class=\"p\">(</span><span class=\"mi\">14</span><span class=\"p\">,</span> <span class=\"mi\">10</span><span class=\"p\">))</span>\n\n<span class=\"k\">for</span> <span class=\"n\">idx</span><span class=\"p\">,</span> <span class=\"n\">ratio</span> <span class=\"ow\">in</span> <span class=\"nb\">enumerate</span><span class=\"p\">(</span><span class=\"n\">imbalance_ratios</span><span class=\"p\">):</span>\n    <span class=\"c1\"># Genera dati sbilanciati</span>\n    <span class=\"n\">n_samples</span> <span class=\"o\">=</span> <span class=\"mi\">1000</span>\n    <span class=\"n\">n_positive</span> <span class=\"o\">=</span> <span class=\"nb\">int</span><span class=\"p\">(</span><span class=\"n\">n_samples</span> <span class=\"o\">*</span> <span class=\"p\">(</span><span class=\"mi\">1</span> <span class=\"o\">-</span> <span class=\"n\">ratio</span><span class=\"p\">))</span>\n    <span class=\"n\">n_negative</span> <span class=\"o\">=</span> <span class=\"n\">n_samples</span> <span class=\"o\">-</span> <span class=\"n\">n_positive</span>\n\n    <span class=\"n\">X_imb</span><span class=\"p\">,</span> <span class=\"n\">y_imb</span> <span class=\"o\">=</span> <span class=\"n\">make_classification</span><span class=\"p\">(</span><span class=\"n\">n_samples</span><span class=\"o\">=</span><span class=\"n\">n_samples</span><span class=\"p\">,</span> <span class=\"n\">n_features</span><span class=\"o\">=</span><span class=\"mi\">20</span><span class=\"p\">,</span>\n                                       <span class=\"n\">n_informative</span><span class=\"o\">=</span><span class=\"mi\">15</span><span class=\"p\">,</span> <span class=\"n\">weights</span><span class=\"o\">=</span><span class=\"p\">[</span><span class=\"n\">ratio</span><span class=\"p\">,</span> <span class=\"mi\">1</span><span class=\"o\">-</span><span class=\"n\">ratio</span><span class=\"p\">],</span>\n                                       <span class=\"n\">random_state</span><span class=\"o\">=</span><span class=\"mi\">42</span><span class=\"p\">)</span>\n    <span class=\"n\">X_tr</span><span class=\"p\">,</span> <span class=\"n\">X_te</span><span class=\"p\">,</span> <span class=\"n\">y_tr</span><span class=\"p\">,</span> <span class=\"n\">y_te</span> <span class=\"o\">=</span> <span class=\"n\">train_test_split</span><span class=\"p\">(</span><span class=\"n\">X_imb</span><span class=\"p\">,</span> <span class=\"n\">y_imb</span><span class=\"p\">,</span> <span class=\"n\">test_size</span><span class=\"o\">=</span><span class=\"mf\">0.3</span><span class=\"p\">,</span> <span class=\"n\">random_state</span><span class=\"o\">=</span><span class=\"mi\">42</span><span class=\"p\">)</span>\n\n    <span class=\"n\">clf_imb</span> <span class=\"o\">=</span> <span class=\"n\">RandomForestClassifier</span><span class=\"p\">(</span><span class=\"n\">random_state</span><span class=\"o\">=</span><span class=\"mi\">42</span><span class=\"p\">)</span>\n    <span class=\"n\">clf_imb</span><span class=\"o\">.</span><span class=\"n\">fit</span><span class=\"p\">(</span><span class=\"n\">X_tr</span><span class=\"p\">,</span> <span class=\"n\">y_tr</span><span class=\"p\">)</span>\n    <span class=\"n\">y_prob_imb</span> <span class=\"o\">=</span> <span class=\"n\">clf_imb</span><span class=\"o\">.</span><span class=\"n\">predict_proba</span><span class=\"p\">(</span><span class=\"n\">X_te</span><span class=\"p\">)[:,</span> <span class=\"mi\">1</span><span class=\"p\">]</span>\n\n    <span class=\"c1\"># ROC</span>\n    <span class=\"n\">fpr_imb</span><span class=\"p\">,</span> <span class=\"n\">tpr_imb</span><span class=\"p\">,</span> <span class=\"n\">_</span> <span class=\"o\">=</span> <span class=\"n\">roc_curve</span><span class=\"p\">(</span><span class=\"n\">y_te</span><span class=\"p\">,</span> <span class=\"n\">y_prob_imb</span><span class=\"p\">)</span>\n    <span class=\"n\">auc_imb</span> <span class=\"o\">=</span> <span class=\"n\">auc</span><span class=\"p\">(</span><span class=\"n\">fpr_imb</span><span class=\"p\">,</span> <span class=\"n\">tpr_imb</span><span class=\"p\">)</span>\n    <span class=\"n\">aucs</span><span class=\"o\">.</span><span class=\"n\">append</span><span class=\"p\">(</span><span class=\"n\">auc_imb</span><span class=\"p\">)</span>\n\n    <span class=\"c1\"># Precision-Recall</span>\n    <span class=\"n\">prec_imb</span><span class=\"p\">,</span> <span class=\"n\">rec_imb</span><span class=\"p\">,</span> <span class=\"n\">_</span> <span class=\"o\">=</span> <span class=\"n\">precision_recall_curve</span><span class=\"p\">(</span><span class=\"n\">y_te</span><span class=\"p\">,</span> <span class=\"n\">y_prob_imb</span><span class=\"p\">)</span>\n    <span class=\"n\">ap_imb</span> <span class=\"o\">=</span> <span class=\"n\">average_precision_score</span><span class=\"p\">(</span><span class=\"n\">y_te</span><span class=\"p\">,</span> <span class=\"n\">y_prob_imb</span><span class=\"p\">)</span>\n    <span class=\"n\">aps</span><span class=\"o\">.</span><span class=\"n\">append</span><span class=\"p\">(</span><span class=\"n\">ap_imb</span><span class=\"p\">)</span>\n\n    <span class=\"n\">ax</span> <span class=\"o\">=</span> <span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"n\">idx</span> <span class=\"o\">//</span> <span class=\"mi\">2</span><span class=\"p\">,</span> <span class=\"n\">idx</span> <span class=\"o\">%</span> <span class=\"mi\">2</span><span class=\"p\">]</span>\n    <span class=\"n\">ax</span><span class=\"o\">.</span><span class=\"n\">plot</span><span class=\"p\">(</span><span class=\"n\">fpr_imb</span><span class=\"p\">,</span> <span class=\"n\">tpr_imb</span><span class=\"p\">,</span> <span class=\"n\">lw</span><span class=\"o\">=</span><span class=\"mi\">2</span><span class=\"p\">,</span> <span class=\"n\">label</span><span class=\"o\">=</span><span class=\"sa\">f</span><span class=\"s1\">&#39;ROC (AUC=</span><span class=\"si\">{</span><span class=\"n\">auc_imb</span><span class=\"si\">:</span><span class=\"s1\">.3f</span><span class=\"si\">}</span><span class=\"s1\">)&#39;</span><span class=\"p\">)</span>\n    <span class=\"n\">ax</span><span class=\"o\">.</span><span class=\"n\">plot</span><span class=\"p\">([</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"mi\">1</span><span class=\"p\">],</span> <span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"mi\">1</span><span class=\"p\">],</span> <span class=\"s1\">&#39;k--&#39;</span><span class=\"p\">,</span> <span class=\"n\">lw</span><span class=\"o\">=</span><span class=\"mi\">1</span><span class=\"p\">)</span>\n    <span class=\"n\">ax</span><span class=\"o\">.</span><span class=\"n\">set_xlabel</span><span class=\"p\">(</span><span class=\"s1\">&#39;FPR&#39;</span><span class=\"p\">,</span> <span class=\"n\">fontsize</span><span class=\"o\">=</span><span class=\"mi\">11</span><span class=\"p\">)</span>\n    <span class=\"n\">ax</span><span class=\"o\">.</span><span class=\"n\">set_ylabel</span><span class=\"p\">(</span><span class=\"s1\">&#39;TPR&#39;</span><span class=\"p\">,</span> <span class=\"n\">fontsize</span><span class=\"o\">=</span><span class=\"mi\">11</span><span class=\"p\">)</span>\n    <span class=\"n\">ax</span><span class=\"o\">.</span><span class=\"n\">set_title</span><span class=\"p\">(</span><span class=\"sa\">f</span><span class=\"s1\">&#39;Classe Pos: </span><span class=\"si\">{</span><span class=\"p\">(</span><span class=\"mi\">1</span><span class=\"o\">-</span><span class=\"n\">ratio</span><span class=\"p\">)</span><span class=\"o\">*</span><span class=\"mi\">100</span><span class=\"si\">:</span><span class=\"s1\">.0f</span><span class=\"si\">}</span><span class=\"s1\">% (Ratio 1:</span><span class=\"si\">{</span><span class=\"n\">ratio</span><span class=\"o\">/</span><span class=\"p\">(</span><span class=\"mi\">1</span><span class=\"o\">-</span><span class=\"n\">ratio</span><span class=\"p\">)</span><span class=\"si\">:</span><span class=\"s1\">.1f</span><span class=\"si\">}</span><span class=\"s1\">)&#39;</span><span class=\"p\">,</span> \n                <span class=\"n\">fontsize</span><span class=\"o\">=</span><span class=\"mi\">12</span><span class=\"p\">,</span> <span class=\"n\">fontweight</span><span class=\"o\">=</span><span class=\"s1\">&#39;bold&#39;</span><span class=\"p\">)</span>\n    <span class=\"n\">ax</span><span class=\"o\">.</span><span class=\"n\">legend</span><span class=\"p\">()</span>\n    <span class=\"n\">ax</span><span class=\"o\">.</span><span class=\"n\">grid</span><span class=\"p\">(</span><span class=\"n\">alpha</span><span class=\"o\">=</span><span class=\"mf\">0.3</span><span class=\"p\">)</span>\n\n<span class=\"n\">plt</span><span class=\"o\">.</span><span class=\"n\">suptitle</span><span class=\"p\">(</span><span class=\"s1\">&#39;ROC-AUC è robusta a classi sbilanciate&#39;</span><span class=\"p\">,</span> <span class=\"n\">fontsize</span><span class=\"o\">=</span><span class=\"mi\">14</span><span class=\"p\">,</span> <span class=\"n\">fontweight</span><span class=\"o\">=</span><span class=\"s1\">&#39;bold&#39;</span><span class=\"p\">,</span> <span class=\"n\">y</span><span class=\"o\">=</span><span class=\"mf\">1.02</span><span class=\"p\">)</span>\n<span class=\"n\">plt</span><span class=\"o\">.</span><span class=\"n\">tight_layout</span><span class=\"p\">()</span>\n<span class=\"n\">plt</span><span class=\"o\">.</span><span class=\"n\">show</span><span class=\"p\">()</span>\n\n<span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"s2\">&quot;</span><span class=\"se\">\\n</span><span class=\"s2\">Robustezza AUC vs Sbilanciamento:&quot;</span><span class=\"p\">)</span>\n<span class=\"k\">for</span> <span class=\"n\">ratio</span><span class=\"p\">,</span> <span class=\"n\">auc_val</span><span class=\"p\">,</span> <span class=\"n\">ap_val</span> <span class=\"ow\">in</span> <span class=\"nb\">zip</span><span class=\"p\">(</span><span class=\"n\">imbalance_ratios</span><span class=\"p\">,</span> <span class=\"n\">aucs</span><span class=\"p\">,</span> <span class=\"n\">aps</span><span class=\"p\">):</span>\n    <span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"sa\">f</span><span class=\"s2\">&quot;  Positivi: </span><span class=\"si\">{</span><span class=\"p\">(</span><span class=\"mi\">1</span><span class=\"o\">-</span><span class=\"n\">ratio</span><span class=\"p\">)</span><span class=\"o\">*</span><span class=\"mi\">100</span><span class=\"si\">:</span><span class=\"s2\">5.1f</span><span class=\"si\">}</span><span class=\"s2\">% | AUC: </span><span class=\"si\">{</span><span class=\"n\">auc_val</span><span class=\"si\">:</span><span class=\"s2\">.4f</span><span class=\"si\">}</span><span class=\"s2\"> | AP: </span><span class=\"si\">{</span><span class=\"n\">ap_val</span><span class=\"si\">:</span><span class=\"s2\">.4f</span><span class=\"si\">}</span><span class=\"s2\">&quot;</span><span class=\"p\">)</span>\n</code></pre></div>\n</div>\n</details>\n\n<h2 id=\"7-curva-det-detection-error-trade-off\">7. Curva DET (Detection Error Trade-off)</h2>\n<p>La <strong>curva DET</strong> è una variante della ROC usata in biometria che plotta FRR vs FAR in scala logaritmica:</p>\n<ul>\n<li><strong>Asse Y</strong>: FRR (False Rejection Rate) = FNR = 1 - TPR</li>\n<li><strong>Asse X</strong>: FAR (False Acceptance Rate) = FPR</li>\n</ul>\n<p>A differenza della ROC (che mostra il positivo), la DET enfatizza gli errori.</p>\n<details class=\"code-container\">\n<summary>Code</summary>\n<div class=\"code-wrapper\">\n<button class=\"copy-button\" onclick=\"\n                const code = this.parentElement.querySelector('pre');\n                if (code) {\n                    navigator.clipboard.writeText(code.innerText);\n                    this.textContent = 'Copied!';\n                    setTimeout(() => this.textContent = 'Copy', 2000);\n                }\n            \">Copy</button>\n<div class=\"codehilite\"><pre><span></span><code><span class=\"kn\">from</span><span class=\"w\"> </span><span class=\"nn\">scipy.stats</span><span class=\"w\"> </span><span class=\"kn\">import</span> <span class=\"n\">norm</span>\n\n<span class=\"n\">fig</span><span class=\"p\">,</span> <span class=\"n\">axes</span> <span class=\"o\">=</span> <span class=\"n\">plt</span><span class=\"o\">.</span><span class=\"n\">subplots</span><span class=\"p\">(</span><span class=\"mi\">1</span><span class=\"p\">,</span> <span class=\"mi\">2</span><span class=\"p\">,</span> <span class=\"n\">figsize</span><span class=\"o\">=</span><span class=\"p\">(</span><span class=\"mi\">15</span><span class=\"p\">,</span> <span class=\"mi\">6</span><span class=\"p\">))</span>\n\n<span class=\"c1\"># Curva DET lineare</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">plot</span><span class=\"p\">(</span><span class=\"n\">fpr_roc</span><span class=\"p\">,</span> <span class=\"mi\">1</span> <span class=\"o\">-</span> <span class=\"n\">tpr_roc</span><span class=\"p\">,</span> <span class=\"s1\">&#39;b-&#39;</span><span class=\"p\">,</span> <span class=\"n\">lw</span><span class=\"o\">=</span><span class=\"mi\">3</span><span class=\"p\">,</span> <span class=\"n\">label</span><span class=\"o\">=</span><span class=\"s1\">&#39;Curva DET&#39;</span><span class=\"p\">)</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">set_xlabel</span><span class=\"p\">(</span><span class=\"s1\">&#39;FAR (False Acceptance Rate)&#39;</span><span class=\"p\">,</span> <span class=\"n\">fontsize</span><span class=\"o\">=</span><span class=\"mi\">12</span><span class=\"p\">)</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">set_ylabel</span><span class=\"p\">(</span><span class=\"s1\">&#39;FRR (False Rejection Rate)&#39;</span><span class=\"p\">,</span> <span class=\"n\">fontsize</span><span class=\"o\">=</span><span class=\"mi\">12</span><span class=\"p\">)</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">set_title</span><span class=\"p\">(</span><span class=\"s1\">&#39;DET Curve (scala lineare)&#39;</span><span class=\"p\">,</span> <span class=\"n\">fontsize</span><span class=\"o\">=</span><span class=\"mi\">14</span><span class=\"p\">,</span> <span class=\"n\">fontweight</span><span class=\"o\">=</span><span class=\"s1\">&#39;bold&#39;</span><span class=\"p\">)</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">grid</span><span class=\"p\">(</span><span class=\"n\">alpha</span><span class=\"o\">=</span><span class=\"mf\">0.3</span><span class=\"p\">)</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">legend</span><span class=\"p\">()</span>\n\n<span class=\"c1\"># EER point</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">plot</span><span class=\"p\">(</span><span class=\"n\">fpr_roc</span><span class=\"p\">[</span><span class=\"n\">idx_eer</span><span class=\"p\">],</span> <span class=\"mi\">1</span><span class=\"o\">-</span><span class=\"n\">tpr_roc</span><span class=\"p\">[</span><span class=\"n\">idx_eer</span><span class=\"p\">],</span> <span class=\"s1\">&#39;ro&#39;</span><span class=\"p\">,</span> <span class=\"n\">markersize</span><span class=\"o\">=</span><span class=\"mi\">12</span><span class=\"p\">,</span> \n            <span class=\"n\">label</span><span class=\"o\">=</span><span class=\"sa\">f</span><span class=\"s1\">&#39;EER = </span><span class=\"si\">{</span><span class=\"p\">(</span><span class=\"n\">fpr_roc</span><span class=\"p\">[</span><span class=\"n\">idx_eer</span><span class=\"p\">])</span><span class=\"si\">:</span><span class=\"s1\">.3f</span><span class=\"si\">}</span><span class=\"s1\">&#39;</span><span class=\"p\">)</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">plot</span><span class=\"p\">([</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"mi\">1</span><span class=\"p\">],</span> <span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"mi\">1</span><span class=\"p\">],</span> <span class=\"s1\">&#39;k--&#39;</span><span class=\"p\">,</span> <span class=\"n\">lw</span><span class=\"o\">=</span><span class=\"mi\">1</span><span class=\"p\">,</span> <span class=\"n\">alpha</span><span class=\"o\">=</span><span class=\"mf\">0.5</span><span class=\"p\">)</span>\n\n<span class=\"c1\"># Curva DET logaritmica</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">plot</span><span class=\"p\">(</span><span class=\"n\">fpr_roc</span><span class=\"p\">,</span> <span class=\"mi\">1</span> <span class=\"o\">-</span> <span class=\"n\">tpr_roc</span><span class=\"p\">,</span> <span class=\"s1\">&#39;b-&#39;</span><span class=\"p\">,</span> <span class=\"n\">lw</span><span class=\"o\">=</span><span class=\"mi\">3</span><span class=\"p\">,</span> <span class=\"n\">label</span><span class=\"o\">=</span><span class=\"s1\">&#39;Curva DET&#39;</span><span class=\"p\">)</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">set_xscale</span><span class=\"p\">(</span><span class=\"s1\">&#39;log&#39;</span><span class=\"p\">)</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">set_yscale</span><span class=\"p\">(</span><span class=\"s1\">&#39;log&#39;</span><span class=\"p\">)</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">set_xlabel</span><span class=\"p\">(</span><span class=\"s1\">&#39;FAR (False Acceptance Rate) [log]&#39;</span><span class=\"p\">,</span> <span class=\"n\">fontsize</span><span class=\"o\">=</span><span class=\"mi\">12</span><span class=\"p\">)</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">set_ylabel</span><span class=\"p\">(</span><span class=\"s1\">&#39;FRR (False Rejection Rate) [log]&#39;</span><span class=\"p\">,</span> <span class=\"n\">fontsize</span><span class=\"o\">=</span><span class=\"mi\">12</span><span class=\"p\">)</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">set_title</span><span class=\"p\">(</span><span class=\"s1\">&#39;DET Curve (scala logaritmica)&#39;</span><span class=\"p\">,</span> <span class=\"n\">fontsize</span><span class=\"o\">=</span><span class=\"mi\">14</span><span class=\"p\">,</span> <span class=\"n\">fontweight</span><span class=\"o\">=</span><span class=\"s1\">&#39;bold&#39;</span><span class=\"p\">)</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">grid</span><span class=\"p\">(</span><span class=\"kc\">True</span><span class=\"p\">,</span> <span class=\"n\">which</span><span class=\"o\">=</span><span class=\"s2\">&quot;both&quot;</span><span class=\"p\">,</span> <span class=\"n\">alpha</span><span class=\"o\">=</span><span class=\"mf\">0.3</span><span class=\"p\">)</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">legend</span><span class=\"p\">()</span>\n\n<span class=\"n\">plt</span><span class=\"o\">.</span><span class=\"n\">tight_layout</span><span class=\"p\">()</span>\n<span class=\"n\">plt</span><span class=\"o\">.</span><span class=\"n\">show</span><span class=\"p\">()</span>\n</code></pre></div>\n</div>\n</details>\n\n<h2 id=\"8-curva-precision-recall\">8. Curva Precision-Recall</h2>\n<p>La <strong>curva Precision-Recall</strong> è particolarmente utile per dataset sbilanciati dove la classe positiva è rara:</p>\n<details class=\"code-container\">\n<summary>Code</summary>\n<div class=\"code-wrapper\">\n<button class=\"copy-button\" onclick=\"\n                const code = this.parentElement.querySelector('pre');\n                if (code) {\n                    navigator.clipboard.writeText(code.innerText);\n                    this.textContent = 'Copied!';\n                    setTimeout(() => this.textContent = 'Copy', 2000);\n                }\n            \">Copy</button>\n<div class=\"codehilite\"><pre><span></span><code><span class=\"n\">precision_curve</span><span class=\"p\">,</span> <span class=\"n\">recall_curve</span><span class=\"p\">,</span> <span class=\"n\">thresholds_pr</span> <span class=\"o\">=</span> <span class=\"n\">precision_recall_curve</span><span class=\"p\">(</span><span class=\"n\">y_test</span><span class=\"p\">,</span> <span class=\"n\">y_proba</span><span class=\"p\">)</span>\n<span class=\"n\">avg_precision</span> <span class=\"o\">=</span> <span class=\"n\">average_precision_score</span><span class=\"p\">(</span><span class=\"n\">y_test</span><span class=\"p\">,</span> <span class=\"n\">y_proba</span><span class=\"p\">)</span>\n\n<span class=\"n\">fig</span><span class=\"p\">,</span> <span class=\"n\">axes</span> <span class=\"o\">=</span> <span class=\"n\">plt</span><span class=\"o\">.</span><span class=\"n\">subplots</span><span class=\"p\">(</span><span class=\"mi\">1</span><span class=\"p\">,</span> <span class=\"mi\">2</span><span class=\"p\">,</span> <span class=\"n\">figsize</span><span class=\"o\">=</span><span class=\"p\">(</span><span class=\"mi\">15</span><span class=\"p\">,</span> <span class=\"mi\">6</span><span class=\"p\">))</span>\n\n<span class=\"c1\"># Curva PR</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">plot</span><span class=\"p\">(</span><span class=\"n\">recall_curve</span><span class=\"p\">,</span> <span class=\"n\">precision_curve</span><span class=\"p\">,</span> <span class=\"n\">color</span><span class=\"o\">=</span><span class=\"s1\">&#39;blue&#39;</span><span class=\"p\">,</span> <span class=\"n\">lw</span><span class=\"o\">=</span><span class=\"mi\">3</span><span class=\"p\">,</span>\n            <span class=\"n\">label</span><span class=\"o\">=</span><span class=\"sa\">f</span><span class=\"s1\">&#39;PR curve (AP = </span><span class=\"si\">{</span><span class=\"n\">avg_precision</span><span class=\"si\">:</span><span class=\"s1\">.3f</span><span class=\"si\">}</span><span class=\"s1\">)&#39;</span><span class=\"p\">)</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">fill_between</span><span class=\"p\">(</span><span class=\"n\">recall_curve</span><span class=\"p\">,</span> <span class=\"n\">precision_curve</span><span class=\"p\">,</span> <span class=\"n\">alpha</span><span class=\"o\">=</span><span class=\"mf\">0.3</span><span class=\"p\">,</span> <span class=\"n\">color</span><span class=\"o\">=</span><span class=\"s1\">&#39;blue&#39;</span><span class=\"p\">)</span>\n\n<span class=\"n\">baseline</span> <span class=\"o\">=</span> <span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">sum</span><span class=\"p\">(</span><span class=\"n\">y_test</span><span class=\"p\">)</span> <span class=\"o\">/</span> <span class=\"nb\">len</span><span class=\"p\">(</span><span class=\"n\">y_test</span><span class=\"p\">)</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">axhline</span><span class=\"p\">(</span><span class=\"n\">baseline</span><span class=\"p\">,</span> <span class=\"n\">color</span><span class=\"o\">=</span><span class=\"s1\">&#39;red&#39;</span><span class=\"p\">,</span> <span class=\"n\">linestyle</span><span class=\"o\">=</span><span class=\"s1\">&#39;--&#39;</span><span class=\"p\">,</span> <span class=\"n\">lw</span><span class=\"o\">=</span><span class=\"mi\">2</span><span class=\"p\">,</span>\n               <span class=\"n\">label</span><span class=\"o\">=</span><span class=\"sa\">f</span><span class=\"s1\">&#39;Baseline (prevalenza = </span><span class=\"si\">{</span><span class=\"n\">baseline</span><span class=\"si\">:</span><span class=\"s1\">.3f</span><span class=\"si\">}</span><span class=\"s1\">)&#39;</span><span class=\"p\">)</span>\n\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">set_xlabel</span><span class=\"p\">(</span><span class=\"s1\">&#39;Recall (TPR)&#39;</span><span class=\"p\">,</span> <span class=\"n\">fontsize</span><span class=\"o\">=</span><span class=\"mi\">12</span><span class=\"p\">)</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">set_ylabel</span><span class=\"p\">(</span><span class=\"s1\">&#39;Precision (PPV)&#39;</span><span class=\"p\">,</span> <span class=\"n\">fontsize</span><span class=\"o\">=</span><span class=\"mi\">12</span><span class=\"p\">)</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">set_title</span><span class=\"p\">(</span><span class=\"s1\">&#39;Precision-Recall Curve&#39;</span><span class=\"p\">,</span> <span class=\"n\">fontsize</span><span class=\"o\">=</span><span class=\"mi\">14</span><span class=\"p\">,</span> <span class=\"n\">fontweight</span><span class=\"o\">=</span><span class=\"s1\">&#39;bold&#39;</span><span class=\"p\">)</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">legend</span><span class=\"p\">(</span><span class=\"n\">loc</span><span class=\"o\">=</span><span class=\"s2\">&quot;lower left&quot;</span><span class=\"p\">)</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">grid</span><span class=\"p\">(</span><span class=\"n\">alpha</span><span class=\"o\">=</span><span class=\"mf\">0.3</span><span class=\"p\">)</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">set_xlim</span><span class=\"p\">([</span><span class=\"mf\">0.0</span><span class=\"p\">,</span> <span class=\"mf\">1.0</span><span class=\"p\">])</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">set_ylim</span><span class=\"p\">([</span><span class=\"mf\">0.0</span><span class=\"p\">,</span> <span class=\"mf\">1.05</span><span class=\"p\">])</span>\n\n<span class=\"c1\"># Confronto ROC vs PR per dataset sbilanciato</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">plot</span><span class=\"p\">(</span><span class=\"n\">fpr_roc</span><span class=\"p\">,</span> <span class=\"n\">tpr_roc</span><span class=\"p\">,</span> <span class=\"s1\">&#39;r-&#39;</span><span class=\"p\">,</span> <span class=\"n\">lw</span><span class=\"o\">=</span><span class=\"mi\">2</span><span class=\"p\">,</span> <span class=\"n\">label</span><span class=\"o\">=</span><span class=\"sa\">f</span><span class=\"s1\">&#39;ROC (AUC=</span><span class=\"si\">{</span><span class=\"n\">roc_auc</span><span class=\"si\">:</span><span class=\"s1\">.3f</span><span class=\"si\">}</span><span class=\"s1\">)&#39;</span><span class=\"p\">,</span> <span class=\"n\">alpha</span><span class=\"o\">=</span><span class=\"mf\">0.7</span><span class=\"p\">)</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">set_xlabel</span><span class=\"p\">(</span><span class=\"s1\">&#39;FPR / Recall*&#39;</span><span class=\"p\">,</span> <span class=\"n\">fontsize</span><span class=\"o\">=</span><span class=\"mi\">12</span><span class=\"p\">)</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">set_ylabel</span><span class=\"p\">(</span><span class=\"s1\">&#39;TPR / Precision*&#39;</span><span class=\"p\">,</span> <span class=\"n\">fontsize</span><span class=\"o\">=</span><span class=\"mi\">12</span><span class=\"p\">)</span>\n\n<span class=\"c1\"># Sovrapponi PR (scalata)</span>\n<span class=\"n\">recall_scaled</span> <span class=\"o\">=</span> <span class=\"n\">recall_curve</span>\n<span class=\"n\">precision_scaled</span> <span class=\"o\">=</span> <span class=\"n\">precision_curve</span>  \n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">plot</span><span class=\"p\">(</span><span class=\"n\">recall_scaled</span><span class=\"p\">,</span> <span class=\"n\">precision_scaled</span><span class=\"p\">,</span> <span class=\"s1\">&#39;b-&#39;</span><span class=\"p\">,</span> <span class=\"n\">lw</span><span class=\"o\">=</span><span class=\"mi\">2</span><span class=\"p\">,</span> \n            <span class=\"n\">label</span><span class=\"o\">=</span><span class=\"sa\">f</span><span class=\"s1\">&#39;PR (AP=</span><span class=\"si\">{</span><span class=\"n\">avg_precision</span><span class=\"si\">:</span><span class=\"s1\">.3f</span><span class=\"si\">}</span><span class=\"s1\">)&#39;</span><span class=\"p\">,</span> <span class=\"n\">alpha</span><span class=\"o\">=</span><span class=\"mf\">0.7</span><span class=\"p\">)</span>\n\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">set_title</span><span class=\"p\">(</span><span class=\"s1\">&#39;ROC vs PR: Visualizzazione Comparativa&#39;</span><span class=\"p\">,</span> <span class=\"n\">fontsize</span><span class=\"o\">=</span><span class=\"mi\">14</span><span class=\"p\">,</span> <span class=\"n\">fontweight</span><span class=\"o\">=</span><span class=\"s1\">&#39;bold&#39;</span><span class=\"p\">)</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">legend</span><span class=\"p\">()</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">grid</span><span class=\"p\">(</span><span class=\"n\">alpha</span><span class=\"o\">=</span><span class=\"mf\">0.3</span><span class=\"p\">)</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">set_xlim</span><span class=\"p\">([</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"mi\">1</span><span class=\"p\">])</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">set_ylim</span><span class=\"p\">([</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"mf\">1.05</span><span class=\"p\">])</span>\n\n<span class=\"n\">plt</span><span class=\"o\">.</span><span class=\"n\">tight_layout</span><span class=\"p\">()</span>\n<span class=\"n\">plt</span><span class=\"o\">.</span><span class=\"n\">show</span><span class=\"p\">()</span>\n</code></pre></div>\n</div>\n</details>\n\n<h3 id=\"81-average-precision-ap\">8.1 Average Precision (AP)</h3>\n<p>L&rsquo;<strong>Average Precision</strong> riassume la curva PR come la media pesata delle precision a ogni soglia:</p>\n<p>$\\text{AP} = \\sum_n (R_n - R_{n-1}) \\cdot P_n$</p>\n<p>dove $P_n$ e $R_n$ sono precision e recall alla soglia $n$.</p>\n<p><strong>Differenza con AUC</strong>:\n- AUC-ROC: Buona per dataset bilanciati, mostra trade-off TPR/FPR\n- AUC-PR (AP): Preferibile per dataset sbilanciati, focus su classe positiva</p>\n<details class=\"code-container\">\n<summary>Code</summary>\n<div class=\"code-wrapper\">\n<button class=\"copy-button\" onclick=\"\n                const code = this.parentElement.querySelector('pre');\n                if (code) {\n                    navigator.clipboard.writeText(code.innerText);\n                    this.textContent = 'Copied!';\n                    setTimeout(() => this.textContent = 'Copy', 2000);\n                }\n            \">Copy</button>\n<div class=\"codehilite\"><pre><span></span><code><span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"sa\">f</span><span class=\"s2\">&quot;Average Precision: </span><span class=\"si\">{</span><span class=\"n\">avg_precision</span><span class=\"si\">:</span><span class=\"s2\">.4f</span><span class=\"si\">}</span><span class=\"s2\">&quot;</span><span class=\"p\">)</span>\n<span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"sa\">f</span><span class=\"s2\">&quot;ROC-AUC: </span><span class=\"si\">{</span><span class=\"n\">roc_auc</span><span class=\"si\">:</span><span class=\"s2\">.4f</span><span class=\"si\">}</span><span class=\"s2\">&quot;</span><span class=\"p\">)</span>\n<span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"sa\">f</span><span class=\"s2\">&quot;</span><span class=\"se\">\\n</span><span class=\"s2\">Per dataset sbilanciato (classe positiva </span><span class=\"si\">{</span><span class=\"n\">baseline</span><span class=\"o\">*</span><span class=\"mi\">100</span><span class=\"si\">:</span><span class=\"s2\">.1f</span><span class=\"si\">}</span><span class=\"s2\">%):&quot;</span><span class=\"p\">)</span>\n<span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"sa\">f</span><span class=\"s2\">&quot;  → AP è più informativa di AUC&quot;</span><span class=\"p\">)</span>\n</code></pre></div>\n</div>\n</details>\n\n<h2 id=\"9-equal-error-rate-eer-e-punti-operativi\">9. Equal Error Rate (EER) e Punti Operativi</h2>\n<h3 id=\"91-equal-error-rate-eer\">9.1 Equal Error Rate (EER)</h3>\n<p>L&rsquo;<strong>EER</strong> è il punto dove FAR = FRR (o FPR = FNR), rappresentando un bilanciamento tra i due tipi di errore:</p>\n<p>$\\text{EER} = \\text{FAR}(\\tau^*) = \\text{FRR}(\\tau^*) \\quad \\text{dove} \\quad \\tau^* : \\text{FAR}(\\tau) = \\text{FRR}(\\tau)$</p>\n<details class=\"code-container\">\n<summary>Code</summary>\n<div class=\"code-wrapper\">\n<button class=\"copy-button\" onclick=\"\n                const code = this.parentElement.querySelector('pre');\n                if (code) {\n                    navigator.clipboard.writeText(code.innerText);\n                    this.textContent = 'Copied!';\n                    setTimeout(() => this.textContent = 'Copy', 2000);\n                }\n            \">Copy</button>\n<div class=\"codehilite\"><pre><span></span><code><span class=\"c1\"># Calcolo preciso EER</span>\n<span class=\"n\">eer_value_precise</span> <span class=\"o\">=</span> <span class=\"p\">(</span><span class=\"n\">fars</span><span class=\"p\">[</span><span class=\"n\">eer_idx</span><span class=\"p\">]</span> <span class=\"o\">+</span> <span class=\"n\">frrs</span><span class=\"p\">[</span><span class=\"n\">eer_idx</span><span class=\"p\">])</span> <span class=\"o\">/</span> <span class=\"mi\">2</span>\n<span class=\"n\">eer_threshold_precise</span> <span class=\"o\">=</span> <span class=\"n\">thresholds</span><span class=\"p\">[</span><span class=\"n\">eer_idx</span><span class=\"p\">]</span>\n\n<span class=\"n\">fig</span><span class=\"p\">,</span> <span class=\"n\">axes</span> <span class=\"o\">=</span> <span class=\"n\">plt</span><span class=\"o\">.</span><span class=\"n\">subplots</span><span class=\"p\">(</span><span class=\"mi\">2</span><span class=\"p\">,</span> <span class=\"mi\">2</span><span class=\"p\">,</span> <span class=\"n\">figsize</span><span class=\"o\">=</span><span class=\"p\">(</span><span class=\"mi\">14</span><span class=\"p\">,</span> <span class=\"mi\">10</span><span class=\"p\">))</span>\n\n<span class=\"c1\"># FAR e FRR</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"mi\">0</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">plot</span><span class=\"p\">(</span><span class=\"n\">thresholds</span><span class=\"p\">,</span> <span class=\"n\">fars</span><span class=\"p\">,</span> <span class=\"s1\">&#39;r-&#39;</span><span class=\"p\">,</span> <span class=\"n\">lw</span><span class=\"o\">=</span><span class=\"mi\">2</span><span class=\"p\">,</span> <span class=\"n\">label</span><span class=\"o\">=</span><span class=\"s1\">&#39;FAR&#39;</span><span class=\"p\">)</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"mi\">0</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">plot</span><span class=\"p\">(</span><span class=\"n\">thresholds</span><span class=\"p\">,</span> <span class=\"n\">frrs</span><span class=\"p\">,</span> <span class=\"s1\">&#39;orange&#39;</span><span class=\"p\">,</span> <span class=\"n\">lw</span><span class=\"o\">=</span><span class=\"mi\">2</span><span class=\"p\">,</span> <span class=\"n\">label</span><span class=\"o\">=</span><span class=\"s1\">&#39;FRR&#39;</span><span class=\"p\">)</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"mi\">0</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">plot</span><span class=\"p\">(</span><span class=\"n\">eer_threshold_precise</span><span class=\"p\">,</span> <span class=\"n\">eer_value_precise</span><span class=\"p\">,</span> <span class=\"s1\">&#39;go&#39;</span><span class=\"p\">,</span> <span class=\"n\">markersize</span><span class=\"o\">=</span><span class=\"mi\">12</span><span class=\"p\">,</span> \n               <span class=\"n\">label</span><span class=\"o\">=</span><span class=\"sa\">f</span><span class=\"s1\">&#39;EER=</span><span class=\"si\">{</span><span class=\"n\">eer_value_precise</span><span class=\"si\">:</span><span class=\"s1\">.4f</span><span class=\"si\">}</span><span class=\"s1\">&#39;</span><span class=\"p\">)</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"mi\">0</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">axvline</span><span class=\"p\">(</span><span class=\"n\">eer_threshold_precise</span><span class=\"p\">,</span> <span class=\"n\">color</span><span class=\"o\">=</span><span class=\"s1\">&#39;green&#39;</span><span class=\"p\">,</span> <span class=\"n\">linestyle</span><span class=\"o\">=</span><span class=\"s1\">&#39;--&#39;</span><span class=\"p\">,</span> <span class=\"n\">alpha</span><span class=\"o\">=</span><span class=\"mf\">0.5</span><span class=\"p\">)</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"mi\">0</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">axhline</span><span class=\"p\">(</span><span class=\"n\">eer_value_precise</span><span class=\"p\">,</span> <span class=\"n\">color</span><span class=\"o\">=</span><span class=\"s1\">&#39;green&#39;</span><span class=\"p\">,</span> <span class=\"n\">linestyle</span><span class=\"o\">=</span><span class=\"s1\">&#39;--&#39;</span><span class=\"p\">,</span> <span class=\"n\">alpha</span><span class=\"o\">=</span><span class=\"mf\">0.5</span><span class=\"p\">)</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"mi\">0</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">set_xlabel</span><span class=\"p\">(</span><span class=\"s1\">&#39;Soglia τ&#39;</span><span class=\"p\">,</span> <span class=\"n\">fontsize</span><span class=\"o\">=</span><span class=\"mi\">12</span><span class=\"p\">)</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"mi\">0</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">set_ylabel</span><span class=\"p\">(</span><span class=\"s1\">&#39;Tasso di Errore&#39;</span><span class=\"p\">,</span> <span class=\"n\">fontsize</span><span class=\"o\">=</span><span class=\"mi\">12</span><span class=\"p\">)</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"mi\">0</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">set_title</span><span class=\"p\">(</span><span class=\"s1\">&#39;Equal Error Rate (EER)&#39;</span><span class=\"p\">,</span> <span class=\"n\">fontsize</span><span class=\"o\">=</span><span class=\"mi\">14</span><span class=\"p\">,</span> <span class=\"n\">fontweight</span><span class=\"o\">=</span><span class=\"s1\">&#39;bold&#39;</span><span class=\"p\">)</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"mi\">0</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">legend</span><span class=\"p\">()</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"mi\">0</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">grid</span><span class=\"p\">(</span><span class=\"n\">alpha</span><span class=\"o\">=</span><span class=\"mf\">0.3</span><span class=\"p\">)</span>\n\n<span class=\"c1\"># ROC con punto EER</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"mi\">1</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">plot</span><span class=\"p\">(</span><span class=\"n\">fpr_roc</span><span class=\"p\">,</span> <span class=\"n\">tpr_roc</span><span class=\"p\">,</span> <span class=\"s1\">&#39;b-&#39;</span><span class=\"p\">,</span> <span class=\"n\">lw</span><span class=\"o\">=</span><span class=\"mi\">2</span><span class=\"p\">,</span> <span class=\"n\">label</span><span class=\"o\">=</span><span class=\"s1\">&#39;ROC&#39;</span><span class=\"p\">)</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"mi\">1</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">plot</span><span class=\"p\">([</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"mi\">1</span><span class=\"p\">],</span> <span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">,</span> <span class=\"mi\">0</span><span class=\"p\">],</span> <span class=\"s1\">&#39;k--&#39;</span><span class=\"p\">,</span> <span class=\"n\">lw</span><span class=\"o\">=</span><span class=\"mi\">1</span><span class=\"p\">,</span> <span class=\"n\">alpha</span><span class=\"o\">=</span><span class=\"mf\">0.5</span><span class=\"p\">,</span> <span class=\"n\">label</span><span class=\"o\">=</span><span class=\"s1\">&#39;FAR = 1-TPR line&#39;</span><span class=\"p\">)</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"mi\">1</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">plot</span><span class=\"p\">(</span><span class=\"n\">fpr_roc</span><span class=\"p\">[</span><span class=\"n\">idx_eer</span><span class=\"p\">],</span> <span class=\"n\">tpr_roc</span><span class=\"p\">[</span><span class=\"n\">idx_eer</span><span class=\"p\">],</span> <span class=\"s1\">&#39;ro&#39;</span><span class=\"p\">,</span> <span class=\"n\">markersize</span><span class=\"o\">=</span><span class=\"mi\">12</span><span class=\"p\">,</span> \n               <span class=\"n\">label</span><span class=\"o\">=</span><span class=\"sa\">f</span><span class=\"s1\">&#39;EER point&#39;</span><span class=\"p\">)</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"mi\">1</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">set_xlabel</span><span class=\"p\">(</span><span class=\"s1\">&#39;FPR (FAR)&#39;</span><span class=\"p\">,</span> <span class=\"n\">fontsize</span><span class=\"o\">=</span><span class=\"mi\">12</span><span class=\"p\">)</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"mi\">1</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">set_ylabel</span><span class=\"p\">(</span><span class=\"s1\">&#39;TPR (1-FRR)&#39;</span><span class=\"p\">,</span> <span class=\"n\">fontsize</span><span class=\"o\">=</span><span class=\"mi\">12</span><span class=\"p\">)</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"mi\">1</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">set_title</span><span class=\"p\">(</span><span class=\"s1\">&#39;EER sulla Curva ROC&#39;</span><span class=\"p\">,</span> <span class=\"n\">fontsize</span><span class=\"o\">=</span><span class=\"mi\">14</span><span class=\"p\">,</span> <span class=\"n\">fontweight</span><span class=\"o\">=</span><span class=\"s1\">&#39;bold&#39;</span><span class=\"p\">)</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"mi\">1</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">legend</span><span class=\"p\">()</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"mi\">1</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">grid</span><span class=\"p\">(</span><span class=\"n\">alpha</span><span class=\"o\">=</span><span class=\"mf\">0.3</span><span class=\"p\">)</span>\n\n<span class=\"c1\"># ZeroFRR e ZeroFAR</span>\n<span class=\"n\">zero_frr_idx</span> <span class=\"o\">=</span> <span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">where</span><span class=\"p\">(</span><span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">array</span><span class=\"p\">(</span><span class=\"n\">frrs</span><span class=\"p\">)</span> <span class=\"o\">==</span> <span class=\"mi\">0</span><span class=\"p\">)[</span><span class=\"mi\">0</span><span class=\"p\">]</span>\n<span class=\"n\">zero_far_idx</span> <span class=\"o\">=</span> <span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">where</span><span class=\"p\">(</span><span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">array</span><span class=\"p\">(</span><span class=\"n\">fars</span><span class=\"p\">)</span> <span class=\"o\">==</span> <span class=\"mi\">0</span><span class=\"p\">)[</span><span class=\"mi\">0</span><span class=\"p\">]</span>\n\n<span class=\"k\">if</span> <span class=\"nb\">len</span><span class=\"p\">(</span><span class=\"n\">zero_frr_idx</span><span class=\"p\">)</span> <span class=\"o\">&gt;</span> <span class=\"mi\">0</span><span class=\"p\">:</span>\n    <span class=\"n\">zerofrr_far</span> <span class=\"o\">=</span> <span class=\"n\">fars</span><span class=\"p\">[</span><span class=\"n\">zero_frr_idx</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">]]</span>\n    <span class=\"n\">zerofrr_tau</span> <span class=\"o\">=</span> <span class=\"n\">thresholds</span><span class=\"p\">[</span><span class=\"n\">zero_frr_idx</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">]]</span>\n<span class=\"k\">else</span><span class=\"p\">:</span>\n    <span class=\"n\">zerofrr_far</span><span class=\"p\">,</span> <span class=\"n\">zerofrr_tau</span> <span class=\"o\">=</span> <span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">nan</span><span class=\"p\">,</span> <span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">nan</span>\n\n<span class=\"k\">if</span> <span class=\"nb\">len</span><span class=\"p\">(</span><span class=\"n\">zero_far_idx</span><span class=\"p\">)</span> <span class=\"o\">&gt;</span> <span class=\"mi\">0</span><span class=\"p\">:</span>\n    <span class=\"n\">zerofar_frr</span> <span class=\"o\">=</span> <span class=\"n\">frrs</span><span class=\"p\">[</span><span class=\"n\">zero_far_idx</span><span class=\"p\">[</span><span class=\"o\">-</span><span class=\"mi\">1</span><span class=\"p\">]]</span>\n    <span class=\"n\">zerofar_tau</span> <span class=\"o\">=</span> <span class=\"n\">thresholds</span><span class=\"p\">[</span><span class=\"n\">zero_far_idx</span><span class=\"p\">[</span><span class=\"o\">-</span><span class=\"mi\">1</span><span class=\"p\">]]</span>\n<span class=\"k\">else</span><span class=\"p\">:</span>\n    <span class=\"n\">zerofar_frr</span><span class=\"p\">,</span> <span class=\"n\">zerofar_tau</span> <span class=\"o\">=</span> <span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">nan</span><span class=\"p\">,</span> <span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">nan</span>\n\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">,</span> <span class=\"mi\">0</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">plot</span><span class=\"p\">(</span><span class=\"n\">thresholds</span><span class=\"p\">,</span> <span class=\"n\">fars</span><span class=\"p\">,</span> <span class=\"s1\">&#39;r-&#39;</span><span class=\"p\">,</span> <span class=\"n\">lw</span><span class=\"o\">=</span><span class=\"mi\">2</span><span class=\"p\">,</span> <span class=\"n\">label</span><span class=\"o\">=</span><span class=\"s1\">&#39;FAR&#39;</span><span class=\"p\">)</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">,</span> <span class=\"mi\">0</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">plot</span><span class=\"p\">(</span><span class=\"n\">thresholds</span><span class=\"p\">,</span> <span class=\"n\">frrs</span><span class=\"p\">,</span> <span class=\"s1\">&#39;orange&#39;</span><span class=\"p\">,</span> <span class=\"n\">lw</span><span class=\"o\">=</span><span class=\"mi\">2</span><span class=\"p\">,</span> <span class=\"n\">label</span><span class=\"o\">=</span><span class=\"s1\">&#39;FRR&#39;</span><span class=\"p\">)</span>\n\n<span class=\"k\">if</span> <span class=\"ow\">not</span> <span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">isnan</span><span class=\"p\">(</span><span class=\"n\">zerofrr_tau</span><span class=\"p\">):</span>\n    <span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">,</span> <span class=\"mi\">0</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">plot</span><span class=\"p\">(</span><span class=\"n\">zerofrr_tau</span><span class=\"p\">,</span> <span class=\"n\">zerofrr_far</span><span class=\"p\">,</span> <span class=\"s1\">&#39;bs&#39;</span><span class=\"p\">,</span> <span class=\"n\">markersize</span><span class=\"o\">=</span><span class=\"mi\">10</span><span class=\"p\">,</span> \n                   <span class=\"n\">label</span><span class=\"o\">=</span><span class=\"sa\">f</span><span class=\"s1\">&#39;ZeroFRR: FAR=</span><span class=\"si\">{</span><span class=\"n\">zerofrr_far</span><span class=\"si\">:</span><span class=\"s1\">.4f</span><span class=\"si\">}</span><span class=\"s1\">&#39;</span><span class=\"p\">)</span>\n<span class=\"k\">if</span> <span class=\"ow\">not</span> <span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">isnan</span><span class=\"p\">(</span><span class=\"n\">zerofar_tau</span><span class=\"p\">):</span>\n    <span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">,</span> <span class=\"mi\">0</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">plot</span><span class=\"p\">(</span><span class=\"n\">zerofar_tau</span><span class=\"p\">,</span> <span class=\"n\">zerofar_frr</span><span class=\"p\">,</span> <span class=\"s1\">&#39;m^&#39;</span><span class=\"p\">,</span> <span class=\"n\">markersize</span><span class=\"o\">=</span><span class=\"mi\">10</span><span class=\"p\">,</span> \n                   <span class=\"n\">label</span><span class=\"o\">=</span><span class=\"sa\">f</span><span class=\"s1\">&#39;ZeroFAR: FRR=</span><span class=\"si\">{</span><span class=\"n\">zerofar_frr</span><span class=\"si\">:</span><span class=\"s1\">.4f</span><span class=\"si\">}</span><span class=\"s1\">&#39;</span><span class=\"p\">)</span>\n\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">,</span> <span class=\"mi\">0</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">set_xlabel</span><span class=\"p\">(</span><span class=\"s1\">&#39;Soglia τ&#39;</span><span class=\"p\">,</span> <span class=\"n\">fontsize</span><span class=\"o\">=</span><span class=\"mi\">12</span><span class=\"p\">)</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">,</span> <span class=\"mi\">0</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">set_ylabel</span><span class=\"p\">(</span><span class=\"s1\">&#39;Tasso di Errore&#39;</span><span class=\"p\">,</span> <span class=\"n\">fontsize</span><span class=\"o\">=</span><span class=\"mi\">12</span><span class=\"p\">)</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">,</span> <span class=\"mi\">0</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">set_title</span><span class=\"p\">(</span><span class=\"s1\">&#39;Punti Operativi: ZeroFRR e ZeroFAR&#39;</span><span class=\"p\">,</span> <span class=\"n\">fontsize</span><span class=\"o\">=</span><span class=\"mi\">14</span><span class=\"p\">,</span> <span class=\"n\">fontweight</span><span class=\"o\">=</span><span class=\"s1\">&#39;bold&#39;</span><span class=\"p\">)</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">,</span> <span class=\"mi\">0</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">legend</span><span class=\"p\">()</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">,</span> <span class=\"mi\">0</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">grid</span><span class=\"p\">(</span><span class=\"n\">alpha</span><span class=\"o\">=</span><span class=\"mf\">0.3</span><span class=\"p\">)</span>\n\n<span class=\"c1\"># Tabella riassuntiva</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">,</span> <span class=\"mi\">1</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">axis</span><span class=\"p\">(</span><span class=\"s1\">&#39;off&#39;</span><span class=\"p\">)</span>\n<span class=\"n\">summary_text</span> <span class=\"o\">=</span> <span class=\"sa\">f</span><span class=\"s2\">&quot;&quot;&quot;</span>\n<span class=\"s2\">PUNTI OPERATIVI NOTEVOLI</span>\n\n<span class=\"s2\">Equal Error Rate (EER):</span>\n<span class=\"s2\">  • Soglia: τ = </span><span class=\"si\">{</span><span class=\"n\">eer_threshold_precise</span><span class=\"si\">:</span><span class=\"s2\">.4f</span><span class=\"si\">}</span>\n<span class=\"s2\">  • EER = </span><span class=\"si\">{</span><span class=\"n\">eer_value_precise</span><span class=\"si\">:</span><span class=\"s2\">.4f</span><span class=\"si\">}</span>\n<span class=\"s2\">  • FAR = FRR (bilanciato)</span>\n<span class=\"s2\">  • Uso: Confronto sistemi biometrici</span>\n\n<span class=\"s2\">ZeroFRR (Zero False Rejection):</span>\n<span class=\"s2\">  • Soglia: τ = </span><span class=\"si\">{</span><span class=\"n\">zerofrr_tau</span><span class=\"si\">:</span><span class=\"s2\">.4f if not np.isnan(zerofrr_tau) else &#39;N/A&#39;</span><span class=\"si\">}</span>\n<span class=\"s2\">  • FAR = </span><span class=\"si\">{</span><span class=\"n\">zerofrr_far</span><span class=\"si\">:</span><span class=\"s2\">.4f if not np.isnan(zerofrr_far) else &#39;N/A&#39;</span><span class=\"si\">}</span>\n<span class=\"s2\">  • FRR = 0 (nessun genuino rifiutato)</span>\n<span class=\"s2\">  • Uso: Max convenienza utente</span>\n\n<span class=\"s2\">ZeroFAR (Zero False Acceptance):</span>\n<span class=\"s2\">  • Soglia: τ = </span><span class=\"si\">{</span><span class=\"n\">zerofar_tau</span><span class=\"si\">:</span><span class=\"s2\">.4f if not np.isnan(zerofar_tau) else &#39;N/A&#39;</span><span class=\"si\">}</span>\n<span class=\"s2\">  • FRR = </span><span class=\"si\">{</span><span class=\"n\">zerofar_frr</span><span class=\"si\">:</span><span class=\"s2\">.4f if not np.isnan(zerofar_frr) else &#39;N/A&#39;</span><span class=\"si\">}</span>\n<span class=\"s2\">  • FAR = 0 (nessun impostor accettato)</span>\n<span class=\"s2\">  • Uso: Max sicurezza</span>\n\n<span class=\"s2\">SCELTA DELLA SOGLIA:</span>\n<span class=\"s2\">✓ EER → Bilanciamento generale</span>\n<span class=\"s2\">✓ ZeroFRR → Priorità UX (es. smartphone)</span>\n<span class=\"s2\">✓ ZeroFAR → Priorità sicurezza (es. banca)</span>\n<span class=\"s2\">✓ Custom → Bilanciamento specifico</span>\n<span class=\"s2\">&quot;&quot;&quot;</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">,</span> <span class=\"mi\">1</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">text</span><span class=\"p\">(</span><span class=\"mf\">0.05</span><span class=\"p\">,</span> <span class=\"mf\">0.95</span><span class=\"p\">,</span> <span class=\"n\">summary_text</span><span class=\"p\">,</span> <span class=\"n\">fontsize</span><span class=\"o\">=</span><span class=\"mi\">10</span><span class=\"p\">,</span> <span class=\"n\">verticalalignment</span><span class=\"o\">=</span><span class=\"s1\">&#39;top&#39;</span><span class=\"p\">,</span>\n               <span class=\"n\">family</span><span class=\"o\">=</span><span class=\"s1\">&#39;monospace&#39;</span><span class=\"p\">,</span> \n               <span class=\"n\">bbox</span><span class=\"o\">=</span><span class=\"nb\">dict</span><span class=\"p\">(</span><span class=\"n\">boxstyle</span><span class=\"o\">=</span><span class=\"s1\">&#39;round&#39;</span><span class=\"p\">,</span> <span class=\"n\">facecolor</span><span class=\"o\">=</span><span class=\"s1\">&#39;lightblue&#39;</span><span class=\"p\">,</span> <span class=\"n\">alpha</span><span class=\"o\">=</span><span class=\"mf\">0.7</span><span class=\"p\">))</span>\n\n<span class=\"n\">plt</span><span class=\"o\">.</span><span class=\"n\">tight_layout</span><span class=\"p\">()</span>\n<span class=\"n\">plt</span><span class=\"o\">.</span><span class=\"n\">show</span><span class=\"p\">()</span>\n\n<span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"sa\">f</span><span class=\"s2\">&quot;</span><span class=\"se\">\\n</span><span class=\"s2\">Punti Operativi del Sistema:&quot;</span><span class=\"p\">)</span>\n<span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"sa\">f</span><span class=\"s2\">&quot;  EER: </span><span class=\"si\">{</span><span class=\"n\">eer_value_precise</span><span class=\"si\">:</span><span class=\"s2\">.4f</span><span class=\"si\">}</span><span class=\"s2\"> @ τ=</span><span class=\"si\">{</span><span class=\"n\">eer_threshold_precise</span><span class=\"si\">:</span><span class=\"s2\">.4f</span><span class=\"si\">}</span><span class=\"s2\">&quot;</span><span class=\"p\">)</span>\n<span class=\"k\">if</span> <span class=\"ow\">not</span> <span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">isnan</span><span class=\"p\">(</span><span class=\"n\">zerofrr_tau</span><span class=\"p\">):</span>\n    <span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"sa\">f</span><span class=\"s2\">&quot;  ZeroFRR: FAR=</span><span class=\"si\">{</span><span class=\"n\">zerofrr_far</span><span class=\"si\">:</span><span class=\"s2\">.4f</span><span class=\"si\">}</span><span class=\"s2\"> @ τ=</span><span class=\"si\">{</span><span class=\"n\">zerofrr_tau</span><span class=\"si\">:</span><span class=\"s2\">.4f</span><span class=\"si\">}</span><span class=\"s2\">&quot;</span><span class=\"p\">)</span>\n<span class=\"k\">if</span> <span class=\"ow\">not</span> <span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">isnan</span><span class=\"p\">(</span><span class=\"n\">zerofar_tau</span><span class=\"p\">):</span>\n    <span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"sa\">f</span><span class=\"s2\">&quot;  ZeroFAR: FRR=</span><span class=\"si\">{</span><span class=\"n\">zerofar_frr</span><span class=\"si\">:</span><span class=\"s2\">.4f</span><span class=\"si\">}</span><span class=\"s2\"> @ τ=</span><span class=\"si\">{</span><span class=\"n\">zerofar_tau</span><span class=\"si\">:</span><span class=\"s2\">.4f</span><span class=\"si\">}</span><span class=\"s2\">&quot;</span><span class=\"p\">)</span>\n</code></pre></div>\n</div>\n</details>\n\n<h3 id=\"92-confronto-tra-sistemi-usando-eer\">9.2 Confronto tra Sistemi usando EER</h3>\n<p>L&rsquo;EER è una metrica standard per confrontare sistemi biometrici: <strong>EER più basso = sistema migliore</strong>.</p>\n<details class=\"code-container\">\n<summary>Code</summary>\n<div class=\"code-wrapper\">\n<button class=\"copy-button\" onclick=\"\n                const code = this.parentElement.querySelector('pre');\n                if (code) {\n                    navigator.clipboard.writeText(code.innerText);\n                    this.textContent = 'Copied!';\n                    setTimeout(() => this.textContent = 'Copy', 2000);\n                }\n            \">Copy</button>\n<div class=\"codehilite\"><pre><span></span><code><span class=\"c1\"># Simulazione confronto sistemi</span>\n<span class=\"n\">systems</span> <span class=\"o\">=</span> <span class=\"p\">{</span>\n    <span class=\"s1\">&#39;Sistema A (Eccellente)&#39;</span><span class=\"p\">:</span> <span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">random</span><span class=\"o\">.</span><span class=\"n\">beta</span><span class=\"p\">(</span><span class=\"mi\">8</span><span class=\"p\">,</span> <span class=\"mi\">2</span><span class=\"p\">,</span> <span class=\"mi\">1000</span><span class=\"p\">),</span>\n    <span class=\"s1\">&#39;Sistema B (Buono)&#39;</span><span class=\"p\">:</span> <span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">random</span><span class=\"o\">.</span><span class=\"n\">beta</span><span class=\"p\">(</span><span class=\"mi\">6</span><span class=\"p\">,</span> <span class=\"mi\">3</span><span class=\"p\">,</span> <span class=\"mi\">1000</span><span class=\"p\">),</span>\n    <span class=\"s1\">&#39;Sistema C (Medio)&#39;</span><span class=\"p\">:</span> <span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">random</span><span class=\"o\">.</span><span class=\"n\">beta</span><span class=\"p\">(</span><span class=\"mi\">5</span><span class=\"p\">,</span> <span class=\"mi\">4</span><span class=\"p\">,</span> <span class=\"mi\">1000</span><span class=\"p\">),</span>\n    <span class=\"s1\">&#39;Sistema D (Scarso)&#39;</span><span class=\"p\">:</span> <span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">random</span><span class=\"o\">.</span><span class=\"n\">beta</span><span class=\"p\">(</span><span class=\"mi\">4</span><span class=\"p\">,</span> <span class=\"mi\">5</span><span class=\"p\">,</span> <span class=\"mi\">1000</span><span class=\"p\">)</span>\n<span class=\"p\">}</span>\n\n<span class=\"n\">fig</span><span class=\"p\">,</span> <span class=\"n\">axes</span> <span class=\"o\">=</span> <span class=\"n\">plt</span><span class=\"o\">.</span><span class=\"n\">subplots</span><span class=\"p\">(</span><span class=\"mi\">2</span><span class=\"p\">,</span> <span class=\"mi\">2</span><span class=\"p\">,</span> <span class=\"n\">figsize</span><span class=\"o\">=</span><span class=\"p\">(</span><span class=\"mi\">14</span><span class=\"p\">,</span> <span class=\"mi\">10</span><span class=\"p\">))</span>\n\n<span class=\"n\">eers_systems</span> <span class=\"o\">=</span> <span class=\"p\">[]</span>\n<span class=\"k\">for</span> <span class=\"n\">idx</span><span class=\"p\">,</span> <span class=\"p\">(</span><span class=\"n\">name</span><span class=\"p\">,</span> <span class=\"n\">pos_scores</span><span class=\"p\">)</span> <span class=\"ow\">in</span> <span class=\"nb\">enumerate</span><span class=\"p\">(</span><span class=\"n\">systems</span><span class=\"o\">.</span><span class=\"n\">items</span><span class=\"p\">()):</span>\n    <span class=\"n\">ax</span> <span class=\"o\">=</span> <span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"n\">idx</span> <span class=\"o\">//</span> <span class=\"mi\">2</span><span class=\"p\">,</span> <span class=\"n\">idx</span> <span class=\"o\">%</span> <span class=\"mi\">2</span><span class=\"p\">]</span>\n\n    <span class=\"c1\"># Genera impostori</span>\n    <span class=\"n\">neg_scores</span> <span class=\"o\">=</span> <span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">random</span><span class=\"o\">.</span><span class=\"n\">beta</span><span class=\"p\">(</span><span class=\"mi\">2</span><span class=\"p\">,</span> <span class=\"mi\">8</span><span class=\"p\">,</span> <span class=\"mi\">1000</span><span class=\"p\">)</span>\n\n    <span class=\"c1\"># Crea labels</span>\n    <span class=\"n\">y_true_sys</span> <span class=\"o\">=</span> <span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">concatenate</span><span class=\"p\">([</span><span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">ones</span><span class=\"p\">(</span><span class=\"nb\">len</span><span class=\"p\">(</span><span class=\"n\">pos_scores</span><span class=\"p\">)),</span> <span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">zeros</span><span class=\"p\">(</span><span class=\"nb\">len</span><span class=\"p\">(</span><span class=\"n\">neg_scores</span><span class=\"p\">))])</span>\n    <span class=\"n\">y_scores_sys</span> <span class=\"o\">=</span> <span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">concatenate</span><span class=\"p\">([</span><span class=\"n\">pos_scores</span><span class=\"p\">,</span> <span class=\"n\">neg_scores</span><span class=\"p\">])</span>\n\n    <span class=\"c1\"># Calcola FAR e FRR</span>\n    <span class=\"n\">thresholds_sys</span> <span class=\"o\">=</span> <span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">linspace</span><span class=\"p\">(</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"mi\">1</span><span class=\"p\">,</span> <span class=\"mi\">200</span><span class=\"p\">)</span>\n    <span class=\"n\">fars_sys</span><span class=\"p\">,</span> <span class=\"n\">frrs_sys</span> <span class=\"o\">=</span> <span class=\"p\">[],</span> <span class=\"p\">[]</span>\n\n    <span class=\"k\">for</span> <span class=\"n\">tau</span> <span class=\"ow\">in</span> <span class=\"n\">thresholds_sys</span><span class=\"p\">:</span>\n        <span class=\"n\">fa</span> <span class=\"o\">=</span> <span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">sum</span><span class=\"p\">((</span><span class=\"n\">y_scores_sys</span><span class=\"p\">[</span><span class=\"n\">y_true_sys</span> <span class=\"o\">==</span> <span class=\"mi\">0</span><span class=\"p\">]</span> <span class=\"o\">&gt;=</span> <span class=\"n\">tau</span><span class=\"p\">))</span>\n        <span class=\"n\">fr</span> <span class=\"o\">=</span> <span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">sum</span><span class=\"p\">((</span><span class=\"n\">y_scores_sys</span><span class=\"p\">[</span><span class=\"n\">y_true_sys</span> <span class=\"o\">==</span> <span class=\"mi\">1</span><span class=\"p\">]</span> <span class=\"o\">&lt;</span> <span class=\"n\">tau</span><span class=\"p\">))</span>\n        <span class=\"n\">tn</span> <span class=\"o\">=</span> <span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">sum</span><span class=\"p\">((</span><span class=\"n\">y_scores_sys</span><span class=\"p\">[</span><span class=\"n\">y_true_sys</span> <span class=\"o\">==</span> <span class=\"mi\">0</span><span class=\"p\">]</span> <span class=\"o\">&lt;</span> <span class=\"n\">tau</span><span class=\"p\">))</span>\n        <span class=\"n\">tp</span> <span class=\"o\">=</span> <span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">sum</span><span class=\"p\">((</span><span class=\"n\">y_scores_sys</span><span class=\"p\">[</span><span class=\"n\">y_true_sys</span> <span class=\"o\">==</span> <span class=\"mi\">1</span><span class=\"p\">]</span> <span class=\"o\">&gt;=</span> <span class=\"n\">tau</span><span class=\"p\">))</span>\n\n        <span class=\"n\">far_sys</span> <span class=\"o\">=</span> <span class=\"n\">fa</span> <span class=\"o\">/</span> <span class=\"p\">(</span><span class=\"n\">fa</span> <span class=\"o\">+</span> <span class=\"n\">tn</span><span class=\"p\">)</span> <span class=\"k\">if</span> <span class=\"p\">(</span><span class=\"n\">fa</span> <span class=\"o\">+</span> <span class=\"n\">tn</span><span class=\"p\">)</span> <span class=\"o\">&gt;</span> <span class=\"mi\">0</span> <span class=\"k\">else</span> <span class=\"mi\">0</span>\n        <span class=\"n\">frr_sys</span> <span class=\"o\">=</span> <span class=\"n\">fr</span> <span class=\"o\">/</span> <span class=\"p\">(</span><span class=\"n\">fr</span> <span class=\"o\">+</span> <span class=\"n\">tp</span><span class=\"p\">)</span> <span class=\"k\">if</span> <span class=\"p\">(</span><span class=\"n\">fr</span> <span class=\"o\">+</span> <span class=\"n\">tp</span><span class=\"p\">)</span> <span class=\"o\">&gt;</span> <span class=\"mi\">0</span> <span class=\"k\">else</span> <span class=\"mi\">0</span>\n        <span class=\"n\">fars_sys</span><span class=\"o\">.</span><span class=\"n\">append</span><span class=\"p\">(</span><span class=\"n\">far_sys</span><span class=\"p\">)</span>\n        <span class=\"n\">frrs_sys</span><span class=\"o\">.</span><span class=\"n\">append</span><span class=\"p\">(</span><span class=\"n\">frr_sys</span><span class=\"p\">)</span>\n\n    <span class=\"c1\"># Trova EER</span>\n    <span class=\"n\">diff_sys</span> <span class=\"o\">=</span> <span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">abs</span><span class=\"p\">(</span><span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">array</span><span class=\"p\">(</span><span class=\"n\">fars_sys</span><span class=\"p\">)</span> <span class=\"o\">-</span> <span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">array</span><span class=\"p\">(</span><span class=\"n\">frrs_sys</span><span class=\"p\">))</span>\n    <span class=\"n\">eer_idx_sys</span> <span class=\"o\">=</span> <span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">argmin</span><span class=\"p\">(</span><span class=\"n\">diff_sys</span><span class=\"p\">)</span>\n    <span class=\"n\">eer_sys</span> <span class=\"o\">=</span> <span class=\"p\">(</span><span class=\"n\">fars_sys</span><span class=\"p\">[</span><span class=\"n\">eer_idx_sys</span><span class=\"p\">]</span> <span class=\"o\">+</span> <span class=\"n\">frrs_sys</span><span class=\"p\">[</span><span class=\"n\">eer_idx_sys</span><span class=\"p\">])</span> <span class=\"o\">/</span> <span class=\"mi\">2</span>\n    <span class=\"n\">eers_systems</span><span class=\"o\">.</span><span class=\"n\">append</span><span class=\"p\">((</span><span class=\"n\">name</span><span class=\"p\">,</span> <span class=\"n\">eer_sys</span><span class=\"p\">))</span>\n\n    <span class=\"n\">ax</span><span class=\"o\">.</span><span class=\"n\">plot</span><span class=\"p\">(</span><span class=\"n\">thresholds_sys</span><span class=\"p\">,</span> <span class=\"n\">fars_sys</span><span class=\"p\">,</span> <span class=\"s1\">&#39;r-&#39;</span><span class=\"p\">,</span> <span class=\"n\">lw</span><span class=\"o\">=</span><span class=\"mi\">2</span><span class=\"p\">,</span> <span class=\"n\">label</span><span class=\"o\">=</span><span class=\"s1\">&#39;FAR&#39;</span><span class=\"p\">)</span>\n    <span class=\"n\">ax</span><span class=\"o\">.</span><span class=\"n\">plot</span><span class=\"p\">(</span><span class=\"n\">thresholds_sys</span><span class=\"p\">,</span> <span class=\"n\">frrs_sys</span><span class=\"p\">,</span> <span class=\"s1\">&#39;orange&#39;</span><span class=\"p\">,</span> <span class=\"n\">lw</span><span class=\"o\">=</span><span class=\"mi\">2</span><span class=\"p\">,</span> <span class=\"n\">label</span><span class=\"o\">=</span><span class=\"s1\">&#39;FRR&#39;</span><span class=\"p\">)</span>\n    <span class=\"n\">ax</span><span class=\"o\">.</span><span class=\"n\">plot</span><span class=\"p\">(</span><span class=\"n\">thresholds_sys</span><span class=\"p\">[</span><span class=\"n\">eer_idx_sys</span><span class=\"p\">],</span> <span class=\"n\">eer_sys</span><span class=\"p\">,</span> <span class=\"s1\">&#39;go&#39;</span><span class=\"p\">,</span> <span class=\"n\">markersize</span><span class=\"o\">=</span><span class=\"mi\">10</span><span class=\"p\">,</span> \n           <span class=\"n\">label</span><span class=\"o\">=</span><span class=\"sa\">f</span><span class=\"s1\">&#39;EER=</span><span class=\"si\">{</span><span class=\"n\">eer_sys</span><span class=\"si\">:</span><span class=\"s1\">.4f</span><span class=\"si\">}</span><span class=\"s1\">&#39;</span><span class=\"p\">)</span>\n    <span class=\"n\">ax</span><span class=\"o\">.</span><span class=\"n\">axhline</span><span class=\"p\">(</span><span class=\"n\">eer_sys</span><span class=\"p\">,</span> <span class=\"n\">color</span><span class=\"o\">=</span><span class=\"s1\">&#39;green&#39;</span><span class=\"p\">,</span> <span class=\"n\">linestyle</span><span class=\"o\">=</span><span class=\"s1\">&#39;--&#39;</span><span class=\"p\">,</span> <span class=\"n\">alpha</span><span class=\"o\">=</span><span class=\"mf\">0.3</span><span class=\"p\">)</span>\n    <span class=\"n\">ax</span><span class=\"o\">.</span><span class=\"n\">set_xlabel</span><span class=\"p\">(</span><span class=\"s1\">&#39;Soglia&#39;</span><span class=\"p\">,</span> <span class=\"n\">fontsize</span><span class=\"o\">=</span><span class=\"mi\">11</span><span class=\"p\">)</span>\n    <span class=\"n\">ax</span><span class=\"o\">.</span><span class=\"n\">set_ylabel</span><span class=\"p\">(</span><span class=\"s1\">&#39;Tasso Errore&#39;</span><span class=\"p\">,</span> <span class=\"n\">fontsize</span><span class=\"o\">=</span><span class=\"mi\">11</span><span class=\"p\">)</span>\n    <span class=\"n\">ax</span><span class=\"o\">.</span><span class=\"n\">set_title</span><span class=\"p\">(</span><span class=\"n\">name</span><span class=\"p\">,</span> <span class=\"n\">fontsize</span><span class=\"o\">=</span><span class=\"mi\">12</span><span class=\"p\">,</span> <span class=\"n\">fontweight</span><span class=\"o\">=</span><span class=\"s1\">&#39;bold&#39;</span><span class=\"p\">)</span>\n    <span class=\"n\">ax</span><span class=\"o\">.</span><span class=\"n\">legend</span><span class=\"p\">(</span><span class=\"n\">loc</span><span class=\"o\">=</span><span class=\"s1\">&#39;upper right&#39;</span><span class=\"p\">)</span>\n    <span class=\"n\">ax</span><span class=\"o\">.</span><span class=\"n\">grid</span><span class=\"p\">(</span><span class=\"n\">alpha</span><span class=\"o\">=</span><span class=\"mf\">0.3</span><span class=\"p\">)</span>\n    <span class=\"n\">ax</span><span class=\"o\">.</span><span class=\"n\">set_ylim</span><span class=\"p\">([</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"mf\">0.5</span><span class=\"p\">])</span>\n\n<span class=\"n\">plt</span><span class=\"o\">.</span><span class=\"n\">suptitle</span><span class=\"p\">(</span><span class=\"s1\">&#39;Confronto Sistemi Biometrici tramite EER&#39;</span><span class=\"p\">,</span> <span class=\"n\">fontsize</span><span class=\"o\">=</span><span class=\"mi\">14</span><span class=\"p\">,</span> <span class=\"n\">fontweight</span><span class=\"o\">=</span><span class=\"s1\">&#39;bold&#39;</span><span class=\"p\">,</span> <span class=\"n\">y</span><span class=\"o\">=</span><span class=\"mf\">1.01</span><span class=\"p\">)</span>\n<span class=\"n\">plt</span><span class=\"o\">.</span><span class=\"n\">tight_layout</span><span class=\"p\">()</span>\n<span class=\"n\">plt</span><span class=\"o\">.</span><span class=\"n\">show</span><span class=\"p\">()</span>\n\n<span class=\"c1\"># Ranking</span>\n<span class=\"n\">eers_systems</span><span class=\"o\">.</span><span class=\"n\">sort</span><span class=\"p\">(</span><span class=\"n\">key</span><span class=\"o\">=</span><span class=\"k\">lambda</span> <span class=\"n\">x</span><span class=\"p\">:</span> <span class=\"n\">x</span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">])</span>\n<span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"s2\">&quot;</span><span class=\"se\">\\n</span><span class=\"s2\">Ranking Sistemi (EER crescente = migliore):&quot;</span><span class=\"p\">)</span>\n<span class=\"k\">for</span> <span class=\"n\">rank</span><span class=\"p\">,</span> <span class=\"p\">(</span><span class=\"n\">name</span><span class=\"p\">,</span> <span class=\"n\">eer</span><span class=\"p\">)</span> <span class=\"ow\">in</span> <span class=\"nb\">enumerate</span><span class=\"p\">(</span><span class=\"n\">eers_systems</span><span class=\"p\">,</span> <span class=\"mi\">1</span><span class=\"p\">):</span>\n    <span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"sa\">f</span><span class=\"s2\">&quot;  </span><span class=\"si\">{</span><span class=\"n\">rank</span><span class=\"si\">}</span><span class=\"s2\">. </span><span class=\"si\">{</span><span class=\"n\">name</span><span class=\"si\">}</span><span class=\"s2\">: EER = </span><span class=\"si\">{</span><span class=\"n\">eer</span><span class=\"si\">:</span><span class=\"s2\">.4f</span><span class=\"si\">}</span><span class=\"s2\">&quot;</span><span class=\"p\">)</span>\n</code></pre></div>\n</div>\n</details>\n\n<h2 id=\"10-metriche-avanzate\">10. Metriche Avanzate</h2>\n<h3 id=\"101-matthews-correlation-coefficient-mcc\">10.1 Matthews Correlation Coefficient (MCC)</h3>\n<p>Il <strong>MCC</strong> è considerato una delle migliori metriche per classificazione binaria, specialmente con classi sbilanciate:</p>\n<p>$\\text{MCC} = \\frac{TP \\cdot TN - FP \\cdot FN}{\\sqrt{(TP + FP)(TP + FN)(TN + FP)(TN + FN)}}$</p>\n<p><strong>Proprietà</strong>:\n- Range: [-1, 1]\n- MCC = 1: Predizione perfetta\n- MCC = 0: Predizione casuale\n- MCC = -1: Totale disaccordo\n- Simmetrico rispetto a classi positive/negative\n- Robusto a sbilanciamenti</p>\n<details class=\"code-container\">\n<summary>Code</summary>\n<div class=\"code-wrapper\">\n<button class=\"copy-button\" onclick=\"\n                const code = this.parentElement.querySelector('pre');\n                if (code) {\n                    navigator.clipboard.writeText(code.innerText);\n                    this.textContent = 'Copied!';\n                    setTimeout(() => this.textContent = 'Copy', 2000);\n                }\n            \">Copy</button>\n<div class=\"codehilite\"><pre><span></span><code><span class=\"kn\">from</span><span class=\"w\"> </span><span class=\"nn\">sklearn.metrics</span><span class=\"w\"> </span><span class=\"kn\">import</span> <span class=\"n\">matthews_corrcoef</span>\n\n<span class=\"n\">mcc</span> <span class=\"o\">=</span> <span class=\"n\">matthews_corrcoef</span><span class=\"p\">(</span><span class=\"n\">y_test</span><span class=\"p\">,</span> <span class=\"n\">y_pred</span><span class=\"p\">)</span>\n<span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"sa\">f</span><span class=\"s1\">&#39;Matthews Correlation Coefficient: </span><span class=\"si\">{</span><span class=\"n\">mcc</span><span class=\"si\">:</span><span class=\"s1\">.4f</span><span class=\"si\">}</span><span class=\"s1\">&#39;</span><span class=\"p\">)</span>\n\n<span class=\"c1\"># Comparazione MCC con altre metriche su dataset sbilanciati</span>\n<span class=\"n\">imbalance_ratios</span> <span class=\"o\">=</span> <span class=\"p\">[</span><span class=\"mf\">0.5</span><span class=\"p\">,</span> <span class=\"mf\">0.7</span><span class=\"p\">,</span> <span class=\"mf\">0.9</span><span class=\"p\">,</span> <span class=\"mf\">0.95</span><span class=\"p\">,</span> <span class=\"mf\">0.99</span><span class=\"p\">]</span>\n<span class=\"n\">metrics_comparison</span> <span class=\"o\">=</span> <span class=\"p\">{</span><span class=\"s1\">&#39;Accuracy&#39;</span><span class=\"p\">:</span> <span class=\"p\">[],</span> <span class=\"s1\">&#39;F1&#39;</span><span class=\"p\">:</span> <span class=\"p\">[],</span> <span class=\"s1\">&#39;MCC&#39;</span><span class=\"p\">:</span> <span class=\"p\">[]}</span>\n\n<span class=\"n\">fig</span><span class=\"p\">,</span> <span class=\"n\">ax</span> <span class=\"o\">=</span> <span class=\"n\">plt</span><span class=\"o\">.</span><span class=\"n\">subplots</span><span class=\"p\">(</span><span class=\"n\">figsize</span><span class=\"o\">=</span><span class=\"p\">(</span><span class=\"mi\">12</span><span class=\"p\">,</span> <span class=\"mi\">6</span><span class=\"p\">))</span>\n\n<span class=\"k\">for</span> <span class=\"n\">ratio</span> <span class=\"ow\">in</span> <span class=\"n\">imbalance_ratios</span><span class=\"p\">:</span>\n    <span class=\"n\">X_imb</span><span class=\"p\">,</span> <span class=\"n\">y_imb</span> <span class=\"o\">=</span> <span class=\"n\">make_classification</span><span class=\"p\">(</span><span class=\"n\">n_samples</span><span class=\"o\">=</span><span class=\"mi\">1000</span><span class=\"p\">,</span> <span class=\"n\">n_features</span><span class=\"o\">=</span><span class=\"mi\">20</span><span class=\"p\">,</span>\n                                       <span class=\"n\">weights</span><span class=\"o\">=</span><span class=\"p\">[</span><span class=\"n\">ratio</span><span class=\"p\">,</span> <span class=\"mi\">1</span><span class=\"o\">-</span><span class=\"n\">ratio</span><span class=\"p\">],</span> <span class=\"n\">random_state</span><span class=\"o\">=</span><span class=\"mi\">42</span><span class=\"p\">)</span>\n    <span class=\"n\">X_tr</span><span class=\"p\">,</span> <span class=\"n\">X_te</span><span class=\"p\">,</span> <span class=\"n\">y_tr</span><span class=\"p\">,</span> <span class=\"n\">y_te</span> <span class=\"o\">=</span> <span class=\"n\">train_test_split</span><span class=\"p\">(</span><span class=\"n\">X_imb</span><span class=\"p\">,</span> <span class=\"n\">y_imb</span><span class=\"p\">,</span> <span class=\"n\">test_size</span><span class=\"o\">=</span><span class=\"mf\">0.3</span><span class=\"p\">,</span> <span class=\"n\">random_state</span><span class=\"o\">=</span><span class=\"mi\">42</span><span class=\"p\">)</span>\n\n    <span class=\"n\">clf_imb</span> <span class=\"o\">=</span> <span class=\"n\">RandomForestClassifier</span><span class=\"p\">(</span><span class=\"n\">random_state</span><span class=\"o\">=</span><span class=\"mi\">42</span><span class=\"p\">)</span>\n    <span class=\"n\">clf_imb</span><span class=\"o\">.</span><span class=\"n\">fit</span><span class=\"p\">(</span><span class=\"n\">X_tr</span><span class=\"p\">,</span> <span class=\"n\">y_tr</span><span class=\"p\">)</span>\n    <span class=\"n\">y_pred_imb</span> <span class=\"o\">=</span> <span class=\"n\">clf_imb</span><span class=\"o\">.</span><span class=\"n\">predict</span><span class=\"p\">(</span><span class=\"n\">X_te</span><span class=\"p\">)</span>\n\n    <span class=\"n\">metrics_comparison</span><span class=\"p\">[</span><span class=\"s1\">&#39;Accuracy&#39;</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">append</span><span class=\"p\">(</span><span class=\"n\">accuracy_score</span><span class=\"p\">(</span><span class=\"n\">y_te</span><span class=\"p\">,</span> <span class=\"n\">y_pred_imb</span><span class=\"p\">))</span>\n    <span class=\"n\">metrics_comparison</span><span class=\"p\">[</span><span class=\"s1\">&#39;F1&#39;</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">append</span><span class=\"p\">(</span><span class=\"n\">f1_score</span><span class=\"p\">(</span><span class=\"n\">y_te</span><span class=\"p\">,</span> <span class=\"n\">y_pred_imb</span><span class=\"p\">))</span>\n    <span class=\"n\">metrics_comparison</span><span class=\"p\">[</span><span class=\"s1\">&#39;MCC&#39;</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">append</span><span class=\"p\">(</span><span class=\"n\">matthews_corrcoef</span><span class=\"p\">(</span><span class=\"n\">y_te</span><span class=\"p\">,</span> <span class=\"n\">y_pred_imb</span><span class=\"p\">))</span>\n\n<span class=\"k\">for</span> <span class=\"n\">metric</span><span class=\"p\">,</span> <span class=\"n\">values</span> <span class=\"ow\">in</span> <span class=\"n\">metrics_comparison</span><span class=\"o\">.</span><span class=\"n\">items</span><span class=\"p\">():</span>\n    <span class=\"n\">ax</span><span class=\"o\">.</span><span class=\"n\">plot</span><span class=\"p\">(</span><span class=\"n\">imbalance_ratios</span><span class=\"p\">,</span> <span class=\"n\">values</span><span class=\"p\">,</span> <span class=\"n\">marker</span><span class=\"o\">=</span><span class=\"s1\">&#39;o&#39;</span><span class=\"p\">,</span> <span class=\"n\">markersize</span><span class=\"o\">=</span><span class=\"mi\">8</span><span class=\"p\">,</span> <span class=\"n\">lw</span><span class=\"o\">=</span><span class=\"mi\">2</span><span class=\"p\">,</span> <span class=\"n\">label</span><span class=\"o\">=</span><span class=\"n\">metric</span><span class=\"p\">)</span>\n\n<span class=\"n\">ax</span><span class=\"o\">.</span><span class=\"n\">set_xlabel</span><span class=\"p\">(</span><span class=\"s1\">&#39;Proporzione Classe Maggioritaria&#39;</span><span class=\"p\">,</span> <span class=\"n\">fontsize</span><span class=\"o\">=</span><span class=\"mi\">12</span><span class=\"p\">)</span>\n<span class=\"n\">ax</span><span class=\"o\">.</span><span class=\"n\">set_ylabel</span><span class=\"p\">(</span><span class=\"s1\">&#39;Valore Metrica&#39;</span><span class=\"p\">,</span> <span class=\"n\">fontsize</span><span class=\"o\">=</span><span class=\"mi\">12</span><span class=\"p\">)</span>\n<span class=\"n\">ax</span><span class=\"o\">.</span><span class=\"n\">set_title</span><span class=\"p\">(</span><span class=\"s1\">&#39;MCC è più stabile con dataset sbilanciati rispetto ad Accuracy&#39;</span><span class=\"p\">,</span> \n            <span class=\"n\">fontsize</span><span class=\"o\">=</span><span class=\"mi\">14</span><span class=\"p\">,</span> <span class=\"n\">fontweight</span><span class=\"o\">=</span><span class=\"s1\">&#39;bold&#39;</span><span class=\"p\">)</span>\n<span class=\"n\">ax</span><span class=\"o\">.</span><span class=\"n\">legend</span><span class=\"p\">(</span><span class=\"n\">fontsize</span><span class=\"o\">=</span><span class=\"mi\">11</span><span class=\"p\">)</span>\n<span class=\"n\">ax</span><span class=\"o\">.</span><span class=\"n\">grid</span><span class=\"p\">(</span><span class=\"n\">alpha</span><span class=\"o\">=</span><span class=\"mf\">0.3</span><span class=\"p\">)</span>\n<span class=\"n\">ax</span><span class=\"o\">.</span><span class=\"n\">set_ylim</span><span class=\"p\">([</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"mf\">1.05</span><span class=\"p\">])</span>\n\n<span class=\"n\">plt</span><span class=\"o\">.</span><span class=\"n\">tight_layout</span><span class=\"p\">()</span>\n<span class=\"n\">plt</span><span class=\"o\">.</span><span class=\"n\">show</span><span class=\"p\">()</span>\n</code></pre></div>\n</div>\n</details>\n\n<h3 id=\"102-cohens-kappa\">10.2 Cohen&rsquo;s Kappa</h3>\n<p>Il <strong>Cohen&rsquo;s Kappa</strong> misura l&rsquo;accordo tra predizioni e valori reali, correggendo per l&rsquo;accordo casuale:</p>\n<p>$\\kappa = \\frac{p_o - p_e}{1 - p_e}$</p>\n<p>dove:\n- $p_o = \\frac{TP + TN}{TP + TN + FP + FN}$ : Accuratezza osservata\n- $p_e = \\frac{(TP+FP)(TP+FN) + (TN+FP)(TN+FN)}{(TP+TN+FP+FN)^2}$ : Accordo casuale atteso</p>\n<p><strong>Interpretazione</strong>:\n- κ &lt; 0: Accordo peggiore del caso\n- 0 ≤ κ &lt; 0.20: Accordo lieve\n- 0.20 ≤ κ &lt; 0.40: Accordo discreto\n- 0.40 ≤ κ &lt; 0.60: Accordo moderato\n- 0.60 ≤ κ &lt; 0.80: Accordo sostanziale\n- 0.80 ≤ κ ≤ 1.00: Accordo quasi perfetto</p>\n<details class=\"code-container\">\n<summary>Code</summary>\n<div class=\"code-wrapper\">\n<button class=\"copy-button\" onclick=\"\n                const code = this.parentElement.querySelector('pre');\n                if (code) {\n                    navigator.clipboard.writeText(code.innerText);\n                    this.textContent = 'Copied!';\n                    setTimeout(() => this.textContent = 'Copy', 2000);\n                }\n            \">Copy</button>\n<div class=\"codehilite\"><pre><span></span><code><span class=\"kn\">from</span><span class=\"w\"> </span><span class=\"nn\">sklearn.metrics</span><span class=\"w\"> </span><span class=\"kn\">import</span> <span class=\"n\">cohen_kappa_score</span>\n\n<span class=\"n\">kappa</span> <span class=\"o\">=</span> <span class=\"n\">cohen_kappa_score</span><span class=\"p\">(</span><span class=\"n\">y_test</span><span class=\"p\">,</span> <span class=\"n\">y_pred</span><span class=\"p\">)</span>\n<span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"sa\">f</span><span class=\"s2\">&quot;Cohen&#39;s Kappa: </span><span class=\"si\">{</span><span class=\"n\">kappa</span><span class=\"si\">:</span><span class=\"s2\">.4f</span><span class=\"si\">}</span><span class=\"s2\">&quot;</span><span class=\"p\">)</span>\n\n<span class=\"c1\"># Visualizzazione interpretazione</span>\n<span class=\"n\">kappa_ranges</span> <span class=\"o\">=</span> <span class=\"p\">[</span>\n    <span class=\"p\">(</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"mf\">0.20</span><span class=\"p\">,</span> <span class=\"s1\">&#39;Lieve&#39;</span><span class=\"p\">,</span> <span class=\"s1\">&#39;lightcoral&#39;</span><span class=\"p\">),</span>\n    <span class=\"p\">(</span><span class=\"mf\">0.20</span><span class=\"p\">,</span> <span class=\"mf\">0.40</span><span class=\"p\">,</span> <span class=\"s1\">&#39;Discreto&#39;</span><span class=\"p\">,</span> <span class=\"s1\">&#39;lightyellow&#39;</span><span class=\"p\">),</span>\n    <span class=\"p\">(</span><span class=\"mf\">0.40</span><span class=\"p\">,</span> <span class=\"mf\">0.60</span><span class=\"p\">,</span> <span class=\"s1\">&#39;Moderato&#39;</span><span class=\"p\">,</span> <span class=\"s1\">&#39;lightblue&#39;</span><span class=\"p\">),</span>\n    <span class=\"p\">(</span><span class=\"mf\">0.60</span><span class=\"p\">,</span> <span class=\"mf\">0.80</span><span class=\"p\">,</span> <span class=\"s1\">&#39;Sostanziale&#39;</span><span class=\"p\">,</span> <span class=\"s1\">&#39;lightgreen&#39;</span><span class=\"p\">),</span>\n    <span class=\"p\">(</span><span class=\"mf\">0.80</span><span class=\"p\">,</span> <span class=\"mf\">1.00</span><span class=\"p\">,</span> <span class=\"s1\">&#39;Quasi Perfetto&#39;</span><span class=\"p\">,</span> <span class=\"s1\">&#39;darkgreen&#39;</span><span class=\"p\">)</span>\n<span class=\"p\">]</span>\n\n<span class=\"n\">fig</span><span class=\"p\">,</span> <span class=\"n\">ax</span> <span class=\"o\">=</span> <span class=\"n\">plt</span><span class=\"o\">.</span><span class=\"n\">subplots</span><span class=\"p\">(</span><span class=\"n\">figsize</span><span class=\"o\">=</span><span class=\"p\">(</span><span class=\"mi\">12</span><span class=\"p\">,</span> <span class=\"mi\">3</span><span class=\"p\">))</span>\n\n<span class=\"k\">for</span> <span class=\"n\">start</span><span class=\"p\">,</span> <span class=\"n\">end</span><span class=\"p\">,</span> <span class=\"n\">label</span><span class=\"p\">,</span> <span class=\"n\">color</span> <span class=\"ow\">in</span> <span class=\"n\">kappa_ranges</span><span class=\"p\">:</span>\n    <span class=\"n\">ax</span><span class=\"o\">.</span><span class=\"n\">barh</span><span class=\"p\">(</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"n\">end</span> <span class=\"o\">-</span> <span class=\"n\">start</span><span class=\"p\">,</span> <span class=\"n\">left</span><span class=\"o\">=</span><span class=\"n\">start</span><span class=\"p\">,</span> <span class=\"n\">height</span><span class=\"o\">=</span><span class=\"mf\">0.5</span><span class=\"p\">,</span> <span class=\"n\">color</span><span class=\"o\">=</span><span class=\"n\">color</span><span class=\"p\">,</span> \n           <span class=\"n\">edgecolor</span><span class=\"o\">=</span><span class=\"s1\">&#39;black&#39;</span><span class=\"p\">,</span> <span class=\"n\">linewidth</span><span class=\"o\">=</span><span class=\"mi\">2</span><span class=\"p\">,</span> <span class=\"n\">alpha</span><span class=\"o\">=</span><span class=\"mf\">0.7</span><span class=\"p\">)</span>\n    <span class=\"n\">ax</span><span class=\"o\">.</span><span class=\"n\">text</span><span class=\"p\">((</span><span class=\"n\">start</span> <span class=\"o\">+</span> <span class=\"n\">end</span><span class=\"p\">)</span> <span class=\"o\">/</span> <span class=\"mi\">2</span><span class=\"p\">,</span> <span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"sa\">f</span><span class=\"s1\">&#39;</span><span class=\"si\">{</span><span class=\"n\">label</span><span class=\"si\">}</span><span class=\"se\">\\n</span><span class=\"s1\">[</span><span class=\"si\">{</span><span class=\"n\">start</span><span class=\"si\">:</span><span class=\"s1\">.1f</span><span class=\"si\">}</span><span class=\"s1\">-</span><span class=\"si\">{</span><span class=\"n\">end</span><span class=\"si\">:</span><span class=\"s1\">.1f</span><span class=\"si\">}</span><span class=\"s1\">]&#39;</span><span class=\"p\">,</span> \n           <span class=\"n\">ha</span><span class=\"o\">=</span><span class=\"s1\">&#39;center&#39;</span><span class=\"p\">,</span> <span class=\"n\">va</span><span class=\"o\">=</span><span class=\"s1\">&#39;center&#39;</span><span class=\"p\">,</span> <span class=\"n\">fontsize</span><span class=\"o\">=</span><span class=\"mi\">10</span><span class=\"p\">,</span> <span class=\"n\">fontweight</span><span class=\"o\">=</span><span class=\"s1\">&#39;bold&#39;</span><span class=\"p\">)</span>\n\n<span class=\"n\">ax</span><span class=\"o\">.</span><span class=\"n\">plot</span><span class=\"p\">([</span><span class=\"n\">kappa</span><span class=\"p\">,</span> <span class=\"n\">kappa</span><span class=\"p\">],</span> <span class=\"p\">[</span><span class=\"o\">-</span><span class=\"mf\">0.3</span><span class=\"p\">,</span> <span class=\"mf\">0.3</span><span class=\"p\">],</span> <span class=\"s1\">&#39;r-&#39;</span><span class=\"p\">,</span> <span class=\"n\">linewidth</span><span class=\"o\">=</span><span class=\"mi\">4</span><span class=\"p\">,</span> <span class=\"n\">label</span><span class=\"o\">=</span><span class=\"sa\">f</span><span class=\"s1\">&#39;Kappa=</span><span class=\"si\">{</span><span class=\"n\">kappa</span><span class=\"si\">:</span><span class=\"s1\">.3f</span><span class=\"si\">}</span><span class=\"s1\">&#39;</span><span class=\"p\">)</span>\n<span class=\"n\">ax</span><span class=\"o\">.</span><span class=\"n\">scatter</span><span class=\"p\">([</span><span class=\"n\">kappa</span><span class=\"p\">],</span> <span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">],</span> <span class=\"n\">s</span><span class=\"o\">=</span><span class=\"mi\">200</span><span class=\"p\">,</span> <span class=\"n\">c</span><span class=\"o\">=</span><span class=\"s1\">&#39;red&#39;</span><span class=\"p\">,</span> <span class=\"n\">marker</span><span class=\"o\">=</span><span class=\"s1\">&#39;v&#39;</span><span class=\"p\">,</span> <span class=\"n\">zorder</span><span class=\"o\">=</span><span class=\"mi\">5</span><span class=\"p\">,</span> <span class=\"n\">edgecolor</span><span class=\"o\">=</span><span class=\"s1\">&#39;black&#39;</span><span class=\"p\">,</span> <span class=\"n\">linewidth</span><span class=\"o\">=</span><span class=\"mi\">2</span><span class=\"p\">)</span>\n\n<span class=\"n\">ax</span><span class=\"o\">.</span><span class=\"n\">set_xlim</span><span class=\"p\">([</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"mi\">1</span><span class=\"p\">])</span>\n<span class=\"n\">ax</span><span class=\"o\">.</span><span class=\"n\">set_ylim</span><span class=\"p\">([</span><span class=\"o\">-</span><span class=\"mf\">0.4</span><span class=\"p\">,</span> <span class=\"mf\">0.4</span><span class=\"p\">])</span>\n<span class=\"n\">ax</span><span class=\"o\">.</span><span class=\"n\">set_xlabel</span><span class=\"p\">(</span><span class=\"s2\">&quot;Cohen&#39;s Kappa&quot;</span><span class=\"p\">,</span> <span class=\"n\">fontsize</span><span class=\"o\">=</span><span class=\"mi\">12</span><span class=\"p\">)</span>\n<span class=\"n\">ax</span><span class=\"o\">.</span><span class=\"n\">set_yticks</span><span class=\"p\">([])</span>\n<span class=\"n\">ax</span><span class=\"o\">.</span><span class=\"n\">set_title</span><span class=\"p\">(</span><span class=\"s2\">&quot;Interpretazione Cohen&#39;s Kappa&quot;</span><span class=\"p\">,</span> <span class=\"n\">fontsize</span><span class=\"o\">=</span><span class=\"mi\">14</span><span class=\"p\">,</span> <span class=\"n\">fontweight</span><span class=\"o\">=</span><span class=\"s1\">&#39;bold&#39;</span><span class=\"p\">)</span>\n<span class=\"n\">ax</span><span class=\"o\">.</span><span class=\"n\">legend</span><span class=\"p\">(</span><span class=\"n\">loc</span><span class=\"o\">=</span><span class=\"s1\">&#39;upper left&#39;</span><span class=\"p\">)</span>\n\n<span class=\"n\">plt</span><span class=\"o\">.</span><span class=\"n\">tight_layout</span><span class=\"p\">()</span>\n<span class=\"n\">plt</span><span class=\"o\">.</span><span class=\"n\">show</span><span class=\"p\">()</span>\n</code></pre></div>\n</div>\n</details>\n\n<h3 id=\"103-log-loss-cross-entropy-loss\">10.3 Log Loss (Cross-Entropy Loss)</h3>\n<p>La <strong>Log Loss</strong> valuta la qualità delle probabilità predette, penalizzando fortemente predizioni con alta confidenza ma errate:</p>\n<p>$\\text{Log Loss} = -\\frac{1}{N} \\sum_{i=1}^{N} \\left[ y_i \\log(p_i) + (1 - y_i) \\log(1 - p_i) \\right]$</p>\n<p>dove $p_i$ è la probabilità predetta per la classe positiva.</p>\n<p><strong>Proprietà</strong>:\n- Range: [0, ∞), valori più bassi sono migliori\n- Log Loss = 0: Predizioni probabilistiche perfette\n- Penalizza errori con alta confidenza più di altri</p>\n<details class=\"code-container\">\n<summary>Code</summary>\n<div class=\"code-wrapper\">\n<button class=\"copy-button\" onclick=\"\n                const code = this.parentElement.querySelector('pre');\n                if (code) {\n                    navigator.clipboard.writeText(code.innerText);\n                    this.textContent = 'Copied!';\n                    setTimeout(() => this.textContent = 'Copy', 2000);\n                }\n            \">Copy</button>\n<div class=\"codehilite\"><pre><span></span><code><span class=\"kn\">from</span><span class=\"w\"> </span><span class=\"nn\">sklearn.metrics</span><span class=\"w\"> </span><span class=\"kn\">import</span> <span class=\"n\">log_loss</span>\n\n<span class=\"n\">logloss</span> <span class=\"o\">=</span> <span class=\"n\">log_loss</span><span class=\"p\">(</span><span class=\"n\">y_test</span><span class=\"p\">,</span> <span class=\"n\">y_proba</span><span class=\"p\">)</span>\n<span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"sa\">f</span><span class=\"s1\">&#39;Log Loss: </span><span class=\"si\">{</span><span class=\"n\">logloss</span><span class=\"si\">:</span><span class=\"s1\">.4f</span><span class=\"si\">}</span><span class=\"s1\">&#39;</span><span class=\"p\">)</span>\n\n<span class=\"c1\"># Dimostrazione penalizzazione</span>\n<span class=\"n\">fig</span><span class=\"p\">,</span> <span class=\"n\">axes</span> <span class=\"o\">=</span> <span class=\"n\">plt</span><span class=\"o\">.</span><span class=\"n\">subplots</span><span class=\"p\">(</span><span class=\"mi\">1</span><span class=\"p\">,</span> <span class=\"mi\">2</span><span class=\"p\">,</span> <span class=\"n\">figsize</span><span class=\"o\">=</span><span class=\"p\">(</span><span class=\"mi\">14</span><span class=\"p\">,</span> <span class=\"mi\">5</span><span class=\"p\">))</span>\n\n<span class=\"c1\"># Grafico 1: Log Loss per diverse predizioni</span>\n<span class=\"n\">true_label</span> <span class=\"o\">=</span> <span class=\"mi\">1</span>\n<span class=\"n\">predicted_probs</span> <span class=\"o\">=</span> <span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">linspace</span><span class=\"p\">(</span><span class=\"mf\">0.01</span><span class=\"p\">,</span> <span class=\"mf\">0.99</span><span class=\"p\">,</span> <span class=\"mi\">100</span><span class=\"p\">)</span>\n<span class=\"n\">log_losses</span> <span class=\"o\">=</span> <span class=\"p\">[</span><span class=\"o\">-</span><span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">log</span><span class=\"p\">(</span><span class=\"n\">p</span><span class=\"p\">)</span> <span class=\"k\">if</span> <span class=\"n\">true_label</span> <span class=\"o\">==</span> <span class=\"mi\">1</span> <span class=\"k\">else</span> <span class=\"o\">-</span><span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">log</span><span class=\"p\">(</span><span class=\"mi\">1</span><span class=\"o\">-</span><span class=\"n\">p</span><span class=\"p\">)</span> <span class=\"k\">for</span> <span class=\"n\">p</span> <span class=\"ow\">in</span> <span class=\"n\">predicted_probs</span><span class=\"p\">]</span>\n\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">plot</span><span class=\"p\">(</span><span class=\"n\">predicted_probs</span><span class=\"p\">,</span> <span class=\"n\">log_losses</span><span class=\"p\">,</span> <span class=\"s1\">&#39;b-&#39;</span><span class=\"p\">,</span> <span class=\"n\">lw</span><span class=\"o\">=</span><span class=\"mi\">3</span><span class=\"p\">)</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">axvline</span><span class=\"p\">(</span><span class=\"mf\">0.5</span><span class=\"p\">,</span> <span class=\"n\">color</span><span class=\"o\">=</span><span class=\"s1\">&#39;gray&#39;</span><span class=\"p\">,</span> <span class=\"n\">linestyle</span><span class=\"o\">=</span><span class=\"s1\">&#39;--&#39;</span><span class=\"p\">,</span> <span class=\"n\">alpha</span><span class=\"o\">=</span><span class=\"mf\">0.5</span><span class=\"p\">,</span> <span class=\"n\">label</span><span class=\"o\">=</span><span class=\"s1\">&#39;Incertezza (p=0.5)&#39;</span><span class=\"p\">)</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">set_xlabel</span><span class=\"p\">(</span><span class=\"s1\">&#39;Probabilità Predetta (per classe positiva)&#39;</span><span class=\"p\">,</span> <span class=\"n\">fontsize</span><span class=\"o\">=</span><span class=\"mi\">12</span><span class=\"p\">)</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">set_ylabel</span><span class=\"p\">(</span><span class=\"s1\">&#39;Log Loss&#39;</span><span class=\"p\">,</span> <span class=\"n\">fontsize</span><span class=\"o\">=</span><span class=\"mi\">12</span><span class=\"p\">)</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">set_title</span><span class=\"p\">(</span><span class=\"s1\">&#39;Log Loss penalizza predizioni sbagliate con alta confidenza</span><span class=\"se\">\\n</span><span class=\"s1\">(Vera classe: Positiva)&#39;</span><span class=\"p\">,</span> \n                 <span class=\"n\">fontsize</span><span class=\"o\">=</span><span class=\"mi\">13</span><span class=\"p\">,</span> <span class=\"n\">fontweight</span><span class=\"o\">=</span><span class=\"s1\">&#39;bold&#39;</span><span class=\"p\">)</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">set_ylim</span><span class=\"p\">([</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"mi\">5</span><span class=\"p\">])</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">grid</span><span class=\"p\">(</span><span class=\"n\">alpha</span><span class=\"o\">=</span><span class=\"mf\">0.3</span><span class=\"p\">)</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">legend</span><span class=\"p\">()</span>\n\n<span class=\"c1\"># Annotazioni</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">annotate</span><span class=\"p\">(</span><span class=\"s1\">&#39;Predizione corretta</span><span class=\"se\">\\n</span><span class=\"s1\">con alta confidenza</span><span class=\"se\">\\n</span><span class=\"s1\">(Loss → 0)&#39;</span><span class=\"p\">,</span> \n                <span class=\"n\">xy</span><span class=\"o\">=</span><span class=\"p\">(</span><span class=\"mf\">0.95</span><span class=\"p\">,</span> <span class=\"mf\">0.1</span><span class=\"p\">),</span> <span class=\"n\">fontsize</span><span class=\"o\">=</span><span class=\"mi\">10</span><span class=\"p\">,</span> <span class=\"n\">ha</span><span class=\"o\">=</span><span class=\"s1\">&#39;center&#39;</span><span class=\"p\">,</span>\n                <span class=\"n\">bbox</span><span class=\"o\">=</span><span class=\"nb\">dict</span><span class=\"p\">(</span><span class=\"n\">boxstyle</span><span class=\"o\">=</span><span class=\"s1\">&#39;round&#39;</span><span class=\"p\">,</span> <span class=\"n\">facecolor</span><span class=\"o\">=</span><span class=\"s1\">&#39;lightgreen&#39;</span><span class=\"p\">,</span> <span class=\"n\">alpha</span><span class=\"o\">=</span><span class=\"mf\">0.7</span><span class=\"p\">))</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">annotate</span><span class=\"p\">(</span><span class=\"s1\">&#39;Predizione sbagliata</span><span class=\"se\">\\n</span><span class=\"s1\">con alta confidenza</span><span class=\"se\">\\n</span><span class=\"s1\">(Loss → ∞)&#39;</span><span class=\"p\">,</span> \n                <span class=\"n\">xy</span><span class=\"o\">=</span><span class=\"p\">(</span><span class=\"mf\">0.05</span><span class=\"p\">,</span> <span class=\"mi\">4</span><span class=\"p\">),</span> <span class=\"n\">fontsize</span><span class=\"o\">=</span><span class=\"mi\">10</span><span class=\"p\">,</span> <span class=\"n\">ha</span><span class=\"o\">=</span><span class=\"s1\">&#39;center&#39;</span><span class=\"p\">,</span>\n                <span class=\"n\">bbox</span><span class=\"o\">=</span><span class=\"nb\">dict</span><span class=\"p\">(</span><span class=\"n\">boxstyle</span><span class=\"o\">=</span><span class=\"s1\">&#39;round&#39;</span><span class=\"p\">,</span> <span class=\"n\">facecolor</span><span class=\"o\">=</span><span class=\"s1\">&#39;lightcoral&#39;</span><span class=\"p\">,</span> <span class=\"n\">alpha</span><span class=\"o\">=</span><span class=\"mf\">0.7</span><span class=\"p\">))</span>\n\n<span class=\"c1\"># Grafico 2: Esempi concreti</span>\n<span class=\"n\">scenarios</span> <span class=\"o\">=</span> <span class=\"p\">[</span>\n    <span class=\"p\">(</span><span class=\"s1\">&#39;Corretto</span><span class=\"se\">\\n</span><span class=\"s1\">confidente&#39;</span><span class=\"p\">,</span> <span class=\"mi\">1</span><span class=\"p\">,</span> <span class=\"mf\">0.95</span><span class=\"p\">,</span> <span class=\"s1\">&#39;green&#39;</span><span class=\"p\">),</span>\n    <span class=\"p\">(</span><span class=\"s1\">&#39;Corretto</span><span class=\"se\">\\n</span><span class=\"s1\">incerto&#39;</span><span class=\"p\">,</span> <span class=\"mi\">1</span><span class=\"p\">,</span> <span class=\"mf\">0.55</span><span class=\"p\">,</span> <span class=\"s1\">&#39;lightgreen&#39;</span><span class=\"p\">),</span>\n    <span class=\"p\">(</span><span class=\"s1\">&#39;Sbagliato</span><span class=\"se\">\\n</span><span class=\"s1\">incerto&#39;</span><span class=\"p\">,</span> <span class=\"mi\">1</span><span class=\"p\">,</span> <span class=\"mf\">0.45</span><span class=\"p\">,</span> <span class=\"s1\">&#39;orange&#39;</span><span class=\"p\">),</span>\n    <span class=\"p\">(</span><span class=\"s1\">&#39;Sbagliato</span><span class=\"se\">\\n</span><span class=\"s1\">confidente&#39;</span><span class=\"p\">,</span> <span class=\"mi\">1</span><span class=\"p\">,</span> <span class=\"mf\">0.05</span><span class=\"p\">,</span> <span class=\"s1\">&#39;red&#39;</span><span class=\"p\">)</span>\n<span class=\"p\">]</span>\n\n<span class=\"n\">losses_scenarios</span> <span class=\"o\">=</span> <span class=\"p\">[]</span>\n<span class=\"k\">for</span> <span class=\"n\">_</span><span class=\"p\">,</span> <span class=\"n\">true</span><span class=\"p\">,</span> <span class=\"n\">pred</span><span class=\"p\">,</span> <span class=\"n\">_</span> <span class=\"ow\">in</span> <span class=\"n\">scenarios</span><span class=\"p\">:</span>\n    <span class=\"n\">loss</span> <span class=\"o\">=</span> <span class=\"o\">-</span><span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">log</span><span class=\"p\">(</span><span class=\"n\">pred</span><span class=\"p\">)</span> <span class=\"k\">if</span> <span class=\"n\">true</span> <span class=\"o\">==</span> <span class=\"mi\">1</span> <span class=\"k\">else</span> <span class=\"o\">-</span><span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">log</span><span class=\"p\">(</span><span class=\"mi\">1</span><span class=\"o\">-</span><span class=\"n\">pred</span><span class=\"p\">)</span>\n    <span class=\"n\">losses_scenarios</span><span class=\"o\">.</span><span class=\"n\">append</span><span class=\"p\">(</span><span class=\"n\">loss</span><span class=\"p\">)</span>\n\n<span class=\"n\">bars</span> <span class=\"o\">=</span> <span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">bar</span><span class=\"p\">(</span><span class=\"nb\">range</span><span class=\"p\">(</span><span class=\"nb\">len</span><span class=\"p\">(</span><span class=\"n\">scenarios</span><span class=\"p\">)),</span> <span class=\"n\">losses_scenarios</span><span class=\"p\">,</span> \n                   <span class=\"n\">color</span><span class=\"o\">=</span><span class=\"p\">[</span><span class=\"n\">c</span> <span class=\"k\">for</span> <span class=\"n\">_</span><span class=\"p\">,</span> <span class=\"n\">_</span><span class=\"p\">,</span> <span class=\"n\">_</span><span class=\"p\">,</span> <span class=\"n\">c</span> <span class=\"ow\">in</span> <span class=\"n\">scenarios</span><span class=\"p\">],</span> <span class=\"n\">alpha</span><span class=\"o\">=</span><span class=\"mf\">0.7</span><span class=\"p\">,</span> \n                   <span class=\"n\">edgecolor</span><span class=\"o\">=</span><span class=\"s1\">&#39;black&#39;</span><span class=\"p\">,</span> <span class=\"n\">linewidth</span><span class=\"o\">=</span><span class=\"mi\">2</span><span class=\"p\">)</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">set_xticks</span><span class=\"p\">(</span><span class=\"nb\">range</span><span class=\"p\">(</span><span class=\"nb\">len</span><span class=\"p\">(</span><span class=\"n\">scenarios</span><span class=\"p\">)))</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">set_xticklabels</span><span class=\"p\">([</span><span class=\"n\">s</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">]</span> <span class=\"k\">for</span> <span class=\"n\">s</span> <span class=\"ow\">in</span> <span class=\"n\">scenarios</span><span class=\"p\">],</span> <span class=\"n\">fontsize</span><span class=\"o\">=</span><span class=\"mi\">10</span><span class=\"p\">)</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">set_ylabel</span><span class=\"p\">(</span><span class=\"s1\">&#39;Log Loss&#39;</span><span class=\"p\">,</span> <span class=\"n\">fontsize</span><span class=\"o\">=</span><span class=\"mi\">12</span><span class=\"p\">)</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">set_title</span><span class=\"p\">(</span><span class=\"s1\">&#39;Log Loss per Scenari Diversi&#39;</span><span class=\"p\">,</span> <span class=\"n\">fontsize</span><span class=\"o\">=</span><span class=\"mi\">13</span><span class=\"p\">,</span> <span class=\"n\">fontweight</span><span class=\"o\">=</span><span class=\"s1\">&#39;bold&#39;</span><span class=\"p\">)</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">grid</span><span class=\"p\">(</span><span class=\"n\">axis</span><span class=\"o\">=</span><span class=\"s1\">&#39;y&#39;</span><span class=\"p\">,</span> <span class=\"n\">alpha</span><span class=\"o\">=</span><span class=\"mf\">0.3</span><span class=\"p\">)</span>\n\n<span class=\"k\">for</span> <span class=\"n\">bar</span><span class=\"p\">,</span> <span class=\"n\">loss</span><span class=\"p\">,</span> <span class=\"p\">(</span><span class=\"n\">_</span><span class=\"p\">,</span> <span class=\"n\">_</span><span class=\"p\">,</span> <span class=\"n\">pred</span><span class=\"p\">,</span> <span class=\"n\">_</span><span class=\"p\">)</span> <span class=\"ow\">in</span> <span class=\"nb\">zip</span><span class=\"p\">(</span><span class=\"n\">bars</span><span class=\"p\">,</span> <span class=\"n\">losses_scenarios</span><span class=\"p\">,</span> <span class=\"n\">scenarios</span><span class=\"p\">):</span>\n    <span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">text</span><span class=\"p\">(</span><span class=\"n\">bar</span><span class=\"o\">.</span><span class=\"n\">get_x</span><span class=\"p\">()</span> <span class=\"o\">+</span> <span class=\"n\">bar</span><span class=\"o\">.</span><span class=\"n\">get_width</span><span class=\"p\">()</span><span class=\"o\">/</span><span class=\"mi\">2</span><span class=\"p\">,</span> <span class=\"n\">loss</span> <span class=\"o\">+</span> <span class=\"mf\">0.05</span><span class=\"p\">,</span>\n                <span class=\"sa\">f</span><span class=\"s1\">&#39;</span><span class=\"si\">{</span><span class=\"n\">loss</span><span class=\"si\">:</span><span class=\"s1\">.3f</span><span class=\"si\">}</span><span class=\"se\">\\n</span><span class=\"s1\">p=</span><span class=\"si\">{</span><span class=\"n\">pred</span><span class=\"si\">}</span><span class=\"s1\">&#39;</span><span class=\"p\">,</span> <span class=\"n\">ha</span><span class=\"o\">=</span><span class=\"s1\">&#39;center&#39;</span><span class=\"p\">,</span> <span class=\"n\">fontsize</span><span class=\"o\">=</span><span class=\"mi\">9</span><span class=\"p\">,</span> <span class=\"n\">fontweight</span><span class=\"o\">=</span><span class=\"s1\">&#39;bold&#39;</span><span class=\"p\">)</span>\n\n<span class=\"n\">plt</span><span class=\"o\">.</span><span class=\"n\">tight_layout</span><span class=\"p\">()</span>\n<span class=\"n\">plt</span><span class=\"o\">.</span><span class=\"n\">show</span><span class=\"p\">()</span>\n</code></pre></div>\n</div>\n</details>\n\n<h3 id=\"104-brier-score\">10.4 Brier Score</h3>\n<p>Il <strong>Brier Score</strong> misura l&rsquo;accuratezza delle predizioni probabilistiche come MSE:</p>\n<p>$\\text{Brier Score} = \\frac{1}{N} \\sum_{i=1}^{N} (p_i - y_i)^2$</p>\n<p><strong>Proprietà</strong>:\n- Range: [0, 1], valori più bassi sono migliori\n- Brier = 0: Probabilità perfette\n- Equivalente al Mean Squared Error</p>\n<details class=\"code-container\">\n<summary>Code</summary>\n<div class=\"code-wrapper\">\n<button class=\"copy-button\" onclick=\"\n                const code = this.parentElement.querySelector('pre');\n                if (code) {\n                    navigator.clipboard.writeText(code.innerText);\n                    this.textContent = 'Copied!';\n                    setTimeout(() => this.textContent = 'Copy', 2000);\n                }\n            \">Copy</button>\n<div class=\"codehilite\"><pre><span></span><code><span class=\"kn\">from</span><span class=\"w\"> </span><span class=\"nn\">sklearn.metrics</span><span class=\"w\"> </span><span class=\"kn\">import</span> <span class=\"n\">brier_score_loss</span>\n\n<span class=\"n\">brier</span> <span class=\"o\">=</span> <span class=\"n\">brier_score_loss</span><span class=\"p\">(</span><span class=\"n\">y_test</span><span class=\"p\">,</span> <span class=\"n\">y_proba</span><span class=\"p\">)</span>\n<span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"sa\">f</span><span class=\"s1\">&#39;Brier Score: </span><span class=\"si\">{</span><span class=\"n\">brier</span><span class=\"si\">:</span><span class=\"s1\">.4f</span><span class=\"si\">}</span><span class=\"s1\">&#39;</span><span class=\"p\">)</span>\n\n<span class=\"c1\"># Confronto Log Loss vs Brier Score</span>\n<span class=\"n\">fig</span><span class=\"p\">,</span> <span class=\"n\">ax</span> <span class=\"o\">=</span> <span class=\"n\">plt</span><span class=\"o\">.</span><span class=\"n\">subplots</span><span class=\"p\">(</span><span class=\"n\">figsize</span><span class=\"o\">=</span><span class=\"p\">(</span><span class=\"mi\">10</span><span class=\"p\">,</span> <span class=\"mi\">6</span><span class=\"p\">))</span>\n\n<span class=\"n\">true_label</span> <span class=\"o\">=</span> <span class=\"mi\">1</span>\n<span class=\"n\">probs</span> <span class=\"o\">=</span> <span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">linspace</span><span class=\"p\">(</span><span class=\"mf\">0.01</span><span class=\"p\">,</span> <span class=\"mf\">0.99</span><span class=\"p\">,</span> <span class=\"mi\">100</span><span class=\"p\">)</span>\n<span class=\"n\">log_losses_comp</span> <span class=\"o\">=</span> <span class=\"p\">[</span><span class=\"o\">-</span><span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">log</span><span class=\"p\">(</span><span class=\"n\">p</span><span class=\"p\">)</span> <span class=\"k\">for</span> <span class=\"n\">p</span> <span class=\"ow\">in</span> <span class=\"n\">probs</span><span class=\"p\">]</span>\n<span class=\"n\">brier_scores</span> <span class=\"o\">=</span> <span class=\"p\">[(</span><span class=\"n\">p</span> <span class=\"o\">-</span> <span class=\"n\">true_label</span><span class=\"p\">)</span><span class=\"o\">**</span><span class=\"mi\">2</span> <span class=\"k\">for</span> <span class=\"n\">p</span> <span class=\"ow\">in</span> <span class=\"n\">probs</span><span class=\"p\">]</span>\n\n<span class=\"n\">ax</span><span class=\"o\">.</span><span class=\"n\">plot</span><span class=\"p\">(</span><span class=\"n\">probs</span><span class=\"p\">,</span> <span class=\"n\">log_losses_comp</span><span class=\"p\">,</span> <span class=\"s1\">&#39;b-&#39;</span><span class=\"p\">,</span> <span class=\"n\">lw</span><span class=\"o\">=</span><span class=\"mi\">3</span><span class=\"p\">,</span> <span class=\"n\">label</span><span class=\"o\">=</span><span class=\"s1\">&#39;Log Loss&#39;</span><span class=\"p\">)</span>\n<span class=\"n\">ax2</span> <span class=\"o\">=</span> <span class=\"n\">ax</span><span class=\"o\">.</span><span class=\"n\">twinx</span><span class=\"p\">()</span>\n<span class=\"n\">ax2</span><span class=\"o\">.</span><span class=\"n\">plot</span><span class=\"p\">(</span><span class=\"n\">probs</span><span class=\"p\">,</span> <span class=\"n\">brier_scores</span><span class=\"p\">,</span> <span class=\"s1\">&#39;r-&#39;</span><span class=\"p\">,</span> <span class=\"n\">lw</span><span class=\"o\">=</span><span class=\"mi\">3</span><span class=\"p\">,</span> <span class=\"n\">label</span><span class=\"o\">=</span><span class=\"s1\">&#39;Brier Score&#39;</span><span class=\"p\">)</span>\n\n<span class=\"n\">ax</span><span class=\"o\">.</span><span class=\"n\">set_xlabel</span><span class=\"p\">(</span><span class=\"s1\">&#39;Probabilità Predetta&#39;</span><span class=\"p\">,</span> <span class=\"n\">fontsize</span><span class=\"o\">=</span><span class=\"mi\">12</span><span class=\"p\">)</span>\n<span class=\"n\">ax</span><span class=\"o\">.</span><span class=\"n\">set_ylabel</span><span class=\"p\">(</span><span class=\"s1\">&#39;Log Loss&#39;</span><span class=\"p\">,</span> <span class=\"n\">fontsize</span><span class=\"o\">=</span><span class=\"mi\">12</span><span class=\"p\">,</span> <span class=\"n\">color</span><span class=\"o\">=</span><span class=\"s1\">&#39;blue&#39;</span><span class=\"p\">)</span>\n<span class=\"n\">ax2</span><span class=\"o\">.</span><span class=\"n\">set_ylabel</span><span class=\"p\">(</span><span class=\"s1\">&#39;Brier Score&#39;</span><span class=\"p\">,</span> <span class=\"n\">fontsize</span><span class=\"o\">=</span><span class=\"mi\">12</span><span class=\"p\">,</span> <span class=\"n\">color</span><span class=\"o\">=</span><span class=\"s1\">&#39;red&#39;</span><span class=\"p\">)</span>\n<span class=\"n\">ax</span><span class=\"o\">.</span><span class=\"n\">set_title</span><span class=\"p\">(</span><span class=\"s1\">&#39;Log Loss vs Brier Score</span><span class=\"se\">\\n</span><span class=\"s1\">(Log Loss penalizza più severamente)&#39;</span><span class=\"p\">,</span> \n            <span class=\"n\">fontsize</span><span class=\"o\">=</span><span class=\"mi\">14</span><span class=\"p\">,</span> <span class=\"n\">fontweight</span><span class=\"o\">=</span><span class=\"s1\">&#39;bold&#39;</span><span class=\"p\">)</span>\n<span class=\"n\">ax</span><span class=\"o\">.</span><span class=\"n\">tick_params</span><span class=\"p\">(</span><span class=\"n\">axis</span><span class=\"o\">=</span><span class=\"s1\">&#39;y&#39;</span><span class=\"p\">,</span> <span class=\"n\">labelcolor</span><span class=\"o\">=</span><span class=\"s1\">&#39;blue&#39;</span><span class=\"p\">)</span>\n<span class=\"n\">ax2</span><span class=\"o\">.</span><span class=\"n\">tick_params</span><span class=\"p\">(</span><span class=\"n\">axis</span><span class=\"o\">=</span><span class=\"s1\">&#39;y&#39;</span><span class=\"p\">,</span> <span class=\"n\">labelcolor</span><span class=\"o\">=</span><span class=\"s1\">&#39;red&#39;</span><span class=\"p\">)</span>\n<span class=\"n\">ax</span><span class=\"o\">.</span><span class=\"n\">grid</span><span class=\"p\">(</span><span class=\"n\">alpha</span><span class=\"o\">=</span><span class=\"mf\">0.3</span><span class=\"p\">)</span>\n\n<span class=\"n\">lines1</span><span class=\"p\">,</span> <span class=\"n\">labels1</span> <span class=\"o\">=</span> <span class=\"n\">ax</span><span class=\"o\">.</span><span class=\"n\">get_legend_handles_labels</span><span class=\"p\">()</span>\n<span class=\"n\">lines2</span><span class=\"p\">,</span> <span class=\"n\">labels2</span> <span class=\"o\">=</span> <span class=\"n\">ax2</span><span class=\"o\">.</span><span class=\"n\">get_legend_handles_labels</span><span class=\"p\">()</span>\n<span class=\"n\">ax</span><span class=\"o\">.</span><span class=\"n\">legend</span><span class=\"p\">(</span><span class=\"n\">lines1</span> <span class=\"o\">+</span> <span class=\"n\">lines2</span><span class=\"p\">,</span> <span class=\"n\">labels1</span> <span class=\"o\">+</span> <span class=\"n\">labels2</span><span class=\"p\">,</span> <span class=\"n\">loc</span><span class=\"o\">=</span><span class=\"s1\">&#39;upper center&#39;</span><span class=\"p\">)</span>\n\n<span class=\"n\">plt</span><span class=\"o\">.</span><span class=\"n\">tight_layout</span><span class=\"p\">()</span>\n<span class=\"n\">plt</span><span class=\"o\">.</span><span class=\"n\">show</span><span class=\"p\">()</span>\n</code></pre></div>\n</div>\n</details>\n\n<h2 id=\"11-calibrazione-delle-probabilita\">11. Calibrazione delle Probabilità</h2>\n<p>La <strong>calibration curve</strong> mostra se le probabilità predette riflettono la vera probabilità:</p>\n<details class=\"code-container\">\n<summary>Code</summary>\n<div class=\"code-wrapper\">\n<button class=\"copy-button\" onclick=\"\n                const code = this.parentElement.querySelector('pre');\n                if (code) {\n                    navigator.clipboard.writeText(code.innerText);\n                    this.textContent = 'Copied!';\n                    setTimeout(() => this.textContent = 'Copy', 2000);\n                }\n            \">Copy</button>\n<div class=\"codehilite\"><pre><span></span><code><span class=\"kn\">from</span><span class=\"w\"> </span><span class=\"nn\">sklearn.calibration</span><span class=\"w\"> </span><span class=\"kn\">import</span> <span class=\"n\">calibration_curve</span><span class=\"p\">,</span> <span class=\"n\">CalibrationDisplay</span>\n\n<span class=\"n\">fraction_of_positives</span><span class=\"p\">,</span> <span class=\"n\">mean_predicted_value</span> <span class=\"o\">=</span> <span class=\"n\">calibration_curve</span><span class=\"p\">(</span><span class=\"n\">y_test</span><span class=\"p\">,</span> <span class=\"n\">y_proba</span><span class=\"p\">,</span> <span class=\"n\">n_bins</span><span class=\"o\">=</span><span class=\"mi\">10</span><span class=\"p\">)</span>\n\n<span class=\"n\">fig</span><span class=\"p\">,</span> <span class=\"n\">axes</span> <span class=\"o\">=</span> <span class=\"n\">plt</span><span class=\"o\">.</span><span class=\"n\">subplots</span><span class=\"p\">(</span><span class=\"mi\">1</span><span class=\"p\">,</span> <span class=\"mi\">2</span><span class=\"p\">,</span> <span class=\"n\">figsize</span><span class=\"o\">=</span><span class=\"p\">(</span><span class=\"mi\">14</span><span class=\"p\">,</span> <span class=\"mi\">6</span><span class=\"p\">))</span>\n\n<span class=\"c1\"># Curva di calibrazione</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">plot</span><span class=\"p\">(</span><span class=\"n\">mean_predicted_value</span><span class=\"p\">,</span> <span class=\"n\">fraction_of_positives</span><span class=\"p\">,</span> <span class=\"s2\">&quot;s-&quot;</span><span class=\"p\">,</span> \n            <span class=\"n\">linewidth</span><span class=\"o\">=</span><span class=\"mi\">2</span><span class=\"p\">,</span> <span class=\"n\">markersize</span><span class=\"o\">=</span><span class=\"mi\">8</span><span class=\"p\">,</span> <span class=\"n\">label</span><span class=\"o\">=</span><span class=\"s2\">&quot;Modello&quot;</span><span class=\"p\">)</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">plot</span><span class=\"p\">([</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"mi\">1</span><span class=\"p\">],</span> <span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"mi\">1</span><span class=\"p\">],</span> <span class=\"s2\">&quot;k--&quot;</span><span class=\"p\">,</span> <span class=\"n\">linewidth</span><span class=\"o\">=</span><span class=\"mi\">2</span><span class=\"p\">,</span> <span class=\"n\">label</span><span class=\"o\">=</span><span class=\"s2\">&quot;Perfettamente calibrato&quot;</span><span class=\"p\">)</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">set_xlabel</span><span class=\"p\">(</span><span class=\"s2\">&quot;Probabilità Predetta&quot;</span><span class=\"p\">,</span> <span class=\"n\">fontsize</span><span class=\"o\">=</span><span class=\"mi\">12</span><span class=\"p\">)</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">set_ylabel</span><span class=\"p\">(</span><span class=\"s2\">&quot;Frazione di Positivi&quot;</span><span class=\"p\">,</span> <span class=\"n\">fontsize</span><span class=\"o\">=</span><span class=\"mi\">12</span><span class=\"p\">)</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">set_title</span><span class=\"p\">(</span><span class=\"s2\">&quot;Curva di Calibrazione&quot;</span><span class=\"p\">,</span> <span class=\"n\">fontsize</span><span class=\"o\">=</span><span class=\"mi\">14</span><span class=\"p\">,</span> <span class=\"n\">fontweight</span><span class=\"o\">=</span><span class=\"s1\">&#39;bold&#39;</span><span class=\"p\">)</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">legend</span><span class=\"p\">()</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">grid</span><span class=\"p\">(</span><span class=\"n\">alpha</span><span class=\"o\">=</span><span class=\"mf\">0.3</span><span class=\"p\">)</span>\n\n<span class=\"c1\"># Distribuzione delle probabilità</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">hist</span><span class=\"p\">(</span><span class=\"n\">y_proba</span><span class=\"p\">[</span><span class=\"n\">y_test</span> <span class=\"o\">==</span> <span class=\"mi\">0</span><span class=\"p\">],</span> <span class=\"n\">bins</span><span class=\"o\">=</span><span class=\"mi\">20</span><span class=\"p\">,</span> <span class=\"n\">alpha</span><span class=\"o\">=</span><span class=\"mf\">0.6</span><span class=\"p\">,</span> <span class=\"n\">label</span><span class=\"o\">=</span><span class=\"s1\">&#39;Negativi&#39;</span><span class=\"p\">,</span> \n            <span class=\"n\">color</span><span class=\"o\">=</span><span class=\"s1\">&#39;red&#39;</span><span class=\"p\">,</span> <span class=\"n\">density</span><span class=\"o\">=</span><span class=\"kc\">True</span><span class=\"p\">)</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">hist</span><span class=\"p\">(</span><span class=\"n\">y_proba</span><span class=\"p\">[</span><span class=\"n\">y_test</span> <span class=\"o\">==</span> <span class=\"mi\">1</span><span class=\"p\">],</span> <span class=\"n\">bins</span><span class=\"o\">=</span><span class=\"mi\">20</span><span class=\"p\">,</span> <span class=\"n\">alpha</span><span class=\"o\">=</span><span class=\"mf\">0.6</span><span class=\"p\">,</span> <span class=\"n\">label</span><span class=\"o\">=</span><span class=\"s1\">&#39;Positivi&#39;</span><span class=\"p\">,</span> \n            <span class=\"n\">color</span><span class=\"o\">=</span><span class=\"s1\">&#39;green&#39;</span><span class=\"p\">,</span> <span class=\"n\">density</span><span class=\"o\">=</span><span class=\"kc\">True</span><span class=\"p\">)</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">set_xlabel</span><span class=\"p\">(</span><span class=\"s1\">&#39;Probabilità Predetta&#39;</span><span class=\"p\">,</span> <span class=\"n\">fontsize</span><span class=\"o\">=</span><span class=\"mi\">12</span><span class=\"p\">)</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">set_ylabel</span><span class=\"p\">(</span><span class=\"s1\">&#39;Densità&#39;</span><span class=\"p\">,</span> <span class=\"n\">fontsize</span><span class=\"o\">=</span><span class=\"mi\">12</span><span class=\"p\">)</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">set_title</span><span class=\"p\">(</span><span class=\"s1\">&#39;Distribuzione delle Probabilità Predette&#39;</span><span class=\"p\">,</span> <span class=\"n\">fontsize</span><span class=\"o\">=</span><span class=\"mi\">14</span><span class=\"p\">,</span> <span class=\"n\">fontweight</span><span class=\"o\">=</span><span class=\"s1\">&#39;bold&#39;</span><span class=\"p\">)</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">legend</span><span class=\"p\">()</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">grid</span><span class=\"p\">(</span><span class=\"n\">alpha</span><span class=\"o\">=</span><span class=\"mf\">0.3</span><span class=\"p\">)</span>\n\n<span class=\"n\">plt</span><span class=\"o\">.</span><span class=\"n\">tight_layout</span><span class=\"p\">()</span>\n<span class=\"n\">plt</span><span class=\"o\">.</span><span class=\"n\">show</span><span class=\"p\">()</span>\n</code></pre></div>\n</div>\n</details>\n\n<h2 id=\"12-metriche-per-classificazione-multi-classe\">12. Metriche per Classificazione Multi-classe</h2>\n<h3 id=\"121-strategie-di-aggregazione\">12.1 Strategie di Aggregazione</h3>\n<p>Per estendere le metriche binarie al caso multi-classe:</p>\n<h4 id=\"macro-averaging\">Macro-averaging</h4>\n<p>$\\text{Metric}_{\\text{macro}} = \\frac{1}{K} \\sum_{k=1}^{K} \\text{Metric}_k$\nTutte le classi hanno lo stesso peso.</p>\n<h4 id=\"micro-averaging\">Micro-averaging</h4>\n<p>$\\text{Precision}_{\\text{micro}} = \\frac{\\sum_{k=1}^{K} TP_k}{\\sum_{k=1}^{K} (TP_k + FP_k)}$\nAggrega i contributi; favorisce classi frequenti.</p>\n<h4 id=\"weighted-averaging\">Weighted-averaging</h4>\n<p>$\\text{Metric}_{\\text{weighted}} = \\sum_{k=1}^{K} w_k \\cdot \\text{Metric}_k$\ndove $w_k$ è la frequenza della classe $k$.</p>\n<details class=\"code-container\">\n<summary>Code</summary>\n<div class=\"code-wrapper\">\n<button class=\"copy-button\" onclick=\"\n                const code = this.parentElement.querySelector('pre');\n                if (code) {\n                    navigator.clipboard.writeText(code.innerText);\n                    this.textContent = 'Copied!';\n                    setTimeout(() => this.textContent = 'Copy', 2000);\n                }\n            \">Copy</button>\n<div class=\"codehilite\"><pre><span></span><code><span class=\"kn\">from</span><span class=\"w\"> </span><span class=\"nn\">sklearn.datasets</span><span class=\"w\"> </span><span class=\"kn\">import</span> <span class=\"n\">make_classification</span>\n<span class=\"kn\">from</span><span class=\"w\"> </span><span class=\"nn\">sklearn.metrics</span><span class=\"w\"> </span><span class=\"kn\">import</span> <span class=\"n\">precision_score</span><span class=\"p\">,</span> <span class=\"n\">recall_score</span><span class=\"p\">,</span> <span class=\"n\">f1_score</span><span class=\"p\">,</span> <span class=\"n\">classification_report</span>\n\n<span class=\"c1\"># Dataset multi-classe</span>\n<span class=\"n\">X_mc</span><span class=\"p\">,</span> <span class=\"n\">y_mc</span> <span class=\"o\">=</span> <span class=\"n\">make_classification</span><span class=\"p\">(</span><span class=\"n\">n_samples</span><span class=\"o\">=</span><span class=\"mi\">1000</span><span class=\"p\">,</span> <span class=\"n\">n_features</span><span class=\"o\">=</span><span class=\"mi\">20</span><span class=\"p\">,</span> <span class=\"n\">n_classes</span><span class=\"o\">=</span><span class=\"mi\">4</span><span class=\"p\">,</span>\n                                  <span class=\"n\">n_informative</span><span class=\"o\">=</span><span class=\"mi\">15</span><span class=\"p\">,</span> <span class=\"n\">n_redundant</span><span class=\"o\">=</span><span class=\"mi\">5</span><span class=\"p\">,</span> <span class=\"n\">n_clusters_per_class</span><span class=\"o\">=</span><span class=\"mi\">1</span><span class=\"p\">,</span>\n                                  <span class=\"n\">random_state</span><span class=\"o\">=</span><span class=\"mi\">42</span><span class=\"p\">)</span>\n<span class=\"n\">X_train_mc</span><span class=\"p\">,</span> <span class=\"n\">X_test_mc</span><span class=\"p\">,</span> <span class=\"n\">y_train_mc</span><span class=\"p\">,</span> <span class=\"n\">y_test_mc</span> <span class=\"o\">=</span> <span class=\"n\">train_test_split</span><span class=\"p\">(</span>\n    <span class=\"n\">X_mc</span><span class=\"p\">,</span> <span class=\"n\">y_mc</span><span class=\"p\">,</span> <span class=\"n\">test_size</span><span class=\"o\">=</span><span class=\"mf\">0.3</span><span class=\"p\">,</span> <span class=\"n\">random_state</span><span class=\"o\">=</span><span class=\"mi\">42</span><span class=\"p\">)</span>\n\n<span class=\"n\">clf_mc</span> <span class=\"o\">=</span> <span class=\"n\">RandomForestClassifier</span><span class=\"p\">(</span><span class=\"n\">random_state</span><span class=\"o\">=</span><span class=\"mi\">42</span><span class=\"p\">)</span>\n<span class=\"n\">clf_mc</span><span class=\"o\">.</span><span class=\"n\">fit</span><span class=\"p\">(</span><span class=\"n\">X_train_mc</span><span class=\"p\">,</span> <span class=\"n\">y_train_mc</span><span class=\"p\">)</span>\n<span class=\"n\">y_pred_mc</span> <span class=\"o\">=</span> <span class=\"n\">clf_mc</span><span class=\"o\">.</span><span class=\"n\">predict</span><span class=\"p\">(</span><span class=\"n\">X_test_mc</span><span class=\"p\">)</span>\n\n<span class=\"c1\"># Calcolo metriche</span>\n<span class=\"n\">averages</span> <span class=\"o\">=</span> <span class=\"p\">[</span><span class=\"s1\">&#39;macro&#39;</span><span class=\"p\">,</span> <span class=\"s1\">&#39;micro&#39;</span><span class=\"p\">,</span> <span class=\"s1\">&#39;weighted&#39;</span><span class=\"p\">]</span>\n<span class=\"n\">metrics</span> <span class=\"o\">=</span> <span class=\"p\">{}</span>\n\n<span class=\"k\">for</span> <span class=\"n\">avg</span> <span class=\"ow\">in</span> <span class=\"n\">averages</span><span class=\"p\">:</span>\n    <span class=\"n\">metrics</span><span class=\"p\">[</span><span class=\"n\">avg</span><span class=\"p\">]</span> <span class=\"o\">=</span> <span class=\"p\">{</span>\n        <span class=\"s1\">&#39;Precision&#39;</span><span class=\"p\">:</span> <span class=\"n\">precision_score</span><span class=\"p\">(</span><span class=\"n\">y_test_mc</span><span class=\"p\">,</span> <span class=\"n\">y_pred_mc</span><span class=\"p\">,</span> <span class=\"n\">average</span><span class=\"o\">=</span><span class=\"n\">avg</span><span class=\"p\">,</span> <span class=\"n\">zero_division</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"p\">),</span>\n        <span class=\"s1\">&#39;Recall&#39;</span><span class=\"p\">:</span> <span class=\"n\">recall_score</span><span class=\"p\">(</span><span class=\"n\">y_test_mc</span><span class=\"p\">,</span> <span class=\"n\">y_pred_mc</span><span class=\"p\">,</span> <span class=\"n\">average</span><span class=\"o\">=</span><span class=\"n\">avg</span><span class=\"p\">,</span> <span class=\"n\">zero_division</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"p\">),</span>\n        <span class=\"s1\">&#39;F1-Score&#39;</span><span class=\"p\">:</span> <span class=\"n\">f1_score</span><span class=\"p\">(</span><span class=\"n\">y_test_mc</span><span class=\"p\">,</span> <span class=\"n\">y_pred_mc</span><span class=\"p\">,</span> <span class=\"n\">average</span><span class=\"o\">=</span><span class=\"n\">avg</span><span class=\"p\">,</span> <span class=\"n\">zero_division</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"p\">)</span>\n    <span class=\"p\">}</span>\n\n<span class=\"c1\"># Visualizzazione</span>\n<span class=\"n\">fig</span><span class=\"p\">,</span> <span class=\"n\">axes</span> <span class=\"o\">=</span> <span class=\"n\">plt</span><span class=\"o\">.</span><span class=\"n\">subplots</span><span class=\"p\">(</span><span class=\"mi\">1</span><span class=\"p\">,</span> <span class=\"mi\">2</span><span class=\"p\">,</span> <span class=\"n\">figsize</span><span class=\"o\">=</span><span class=\"p\">(</span><span class=\"mi\">15</span><span class=\"p\">,</span> <span class=\"mi\">6</span><span class=\"p\">))</span>\n\n<span class=\"c1\"># Grafico comparativo</span>\n<span class=\"n\">metric_names</span> <span class=\"o\">=</span> <span class=\"nb\">list</span><span class=\"p\">(</span><span class=\"n\">metrics</span><span class=\"p\">[</span><span class=\"s1\">&#39;macro&#39;</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">keys</span><span class=\"p\">())</span>\n<span class=\"n\">x</span> <span class=\"o\">=</span> <span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">arange</span><span class=\"p\">(</span><span class=\"nb\">len</span><span class=\"p\">(</span><span class=\"n\">metric_names</span><span class=\"p\">))</span>\n<span class=\"n\">width</span> <span class=\"o\">=</span> <span class=\"mf\">0.25</span>\n\n<span class=\"k\">for</span> <span class=\"n\">i</span><span class=\"p\">,</span> <span class=\"n\">avg</span> <span class=\"ow\">in</span> <span class=\"nb\">enumerate</span><span class=\"p\">(</span><span class=\"n\">averages</span><span class=\"p\">):</span>\n    <span class=\"n\">values</span> <span class=\"o\">=</span> <span class=\"p\">[</span><span class=\"n\">metrics</span><span class=\"p\">[</span><span class=\"n\">avg</span><span class=\"p\">][</span><span class=\"n\">m</span><span class=\"p\">]</span> <span class=\"k\">for</span> <span class=\"n\">m</span> <span class=\"ow\">in</span> <span class=\"n\">metric_names</span><span class=\"p\">]</span>\n    <span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">bar</span><span class=\"p\">(</span><span class=\"n\">x</span> <span class=\"o\">+</span> <span class=\"n\">i</span><span class=\"o\">*</span><span class=\"n\">width</span><span class=\"p\">,</span> <span class=\"n\">values</span><span class=\"p\">,</span> <span class=\"n\">width</span><span class=\"p\">,</span> <span class=\"n\">label</span><span class=\"o\">=</span><span class=\"n\">avg</span><span class=\"o\">.</span><span class=\"n\">capitalize</span><span class=\"p\">(),</span> <span class=\"n\">alpha</span><span class=\"o\">=</span><span class=\"mf\">0.8</span><span class=\"p\">)</span>\n\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">set_xlabel</span><span class=\"p\">(</span><span class=\"s1\">&#39;Metrica&#39;</span><span class=\"p\">,</span> <span class=\"n\">fontsize</span><span class=\"o\">=</span><span class=\"mi\">12</span><span class=\"p\">)</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">set_ylabel</span><span class=\"p\">(</span><span class=\"s1\">&#39;Valore&#39;</span><span class=\"p\">,</span> <span class=\"n\">fontsize</span><span class=\"o\">=</span><span class=\"mi\">12</span><span class=\"p\">)</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">set_title</span><span class=\"p\">(</span><span class=\"s1\">&#39;Confronto Strategie di Aggregazione (Multi-classe)&#39;</span><span class=\"p\">,</span> \n                 <span class=\"n\">fontsize</span><span class=\"o\">=</span><span class=\"mi\">14</span><span class=\"p\">,</span> <span class=\"n\">fontweight</span><span class=\"o\">=</span><span class=\"s1\">&#39;bold&#39;</span><span class=\"p\">)</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">set_xticks</span><span class=\"p\">(</span><span class=\"n\">x</span> <span class=\"o\">+</span> <span class=\"n\">width</span><span class=\"p\">)</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">set_xticklabels</span><span class=\"p\">(</span><span class=\"n\">metric_names</span><span class=\"p\">)</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">legend</span><span class=\"p\">()</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">grid</span><span class=\"p\">(</span><span class=\"n\">axis</span><span class=\"o\">=</span><span class=\"s1\">&#39;y&#39;</span><span class=\"p\">,</span> <span class=\"n\">alpha</span><span class=\"o\">=</span><span class=\"mf\">0.3</span><span class=\"p\">)</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">set_ylim</span><span class=\"p\">([</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"mf\">1.1</span><span class=\"p\">])</span>\n\n<span class=\"c1\"># Matrice di confusione</span>\n<span class=\"n\">cm_mc</span> <span class=\"o\">=</span> <span class=\"n\">confusion_matrix</span><span class=\"p\">(</span><span class=\"n\">y_test_mc</span><span class=\"p\">,</span> <span class=\"n\">y_pred_mc</span><span class=\"p\">)</span>\n<span class=\"n\">im</span> <span class=\"o\">=</span> <span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">imshow</span><span class=\"p\">(</span><span class=\"n\">cm_mc</span><span class=\"p\">,</span> <span class=\"n\">cmap</span><span class=\"o\">=</span><span class=\"s1\">&#39;Blues&#39;</span><span class=\"p\">)</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">set_xlabel</span><span class=\"p\">(</span><span class=\"s1\">&#39;Predetto&#39;</span><span class=\"p\">,</span> <span class=\"n\">fontsize</span><span class=\"o\">=</span><span class=\"mi\">12</span><span class=\"p\">)</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">set_ylabel</span><span class=\"p\">(</span><span class=\"s1\">&#39;Reale&#39;</span><span class=\"p\">,</span> <span class=\"n\">fontsize</span><span class=\"o\">=</span><span class=\"mi\">12</span><span class=\"p\">)</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">set_title</span><span class=\"p\">(</span><span class=\"s1\">&#39;Matrice di Confusione Multi-classe&#39;</span><span class=\"p\">,</span> <span class=\"n\">fontsize</span><span class=\"o\">=</span><span class=\"mi\">14</span><span class=\"p\">,</span> <span class=\"n\">fontweight</span><span class=\"o\">=</span><span class=\"s1\">&#39;bold&#39;</span><span class=\"p\">)</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">set_xticks</span><span class=\"p\">(</span><span class=\"nb\">range</span><span class=\"p\">(</span><span class=\"mi\">4</span><span class=\"p\">))</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">set_yticks</span><span class=\"p\">(</span><span class=\"nb\">range</span><span class=\"p\">(</span><span class=\"mi\">4</span><span class=\"p\">))</span>\n\n<span class=\"k\">for</span> <span class=\"n\">i</span> <span class=\"ow\">in</span> <span class=\"nb\">range</span><span class=\"p\">(</span><span class=\"mi\">4</span><span class=\"p\">):</span>\n    <span class=\"k\">for</span> <span class=\"n\">j</span> <span class=\"ow\">in</span> <span class=\"nb\">range</span><span class=\"p\">(</span><span class=\"mi\">4</span><span class=\"p\">):</span>\n        <span class=\"n\">text</span> <span class=\"o\">=</span> <span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">text</span><span class=\"p\">(</span><span class=\"n\">j</span><span class=\"p\">,</span> <span class=\"n\">i</span><span class=\"p\">,</span> <span class=\"n\">cm_mc</span><span class=\"p\">[</span><span class=\"n\">i</span><span class=\"p\">,</span> <span class=\"n\">j</span><span class=\"p\">],</span> <span class=\"n\">ha</span><span class=\"o\">=</span><span class=\"s2\">&quot;center&quot;</span><span class=\"p\">,</span> <span class=\"n\">va</span><span class=\"o\">=</span><span class=\"s2\">&quot;center&quot;</span><span class=\"p\">,</span>\n                          <span class=\"n\">color</span><span class=\"o\">=</span><span class=\"s2\">&quot;white&quot;</span> <span class=\"k\">if</span> <span class=\"n\">cm_mc</span><span class=\"p\">[</span><span class=\"n\">i</span><span class=\"p\">,</span> <span class=\"n\">j</span><span class=\"p\">]</span> <span class=\"o\">&gt;</span> <span class=\"n\">cm_mc</span><span class=\"o\">.</span><span class=\"n\">max</span><span class=\"p\">()</span><span class=\"o\">/</span><span class=\"mi\">2</span> <span class=\"k\">else</span> <span class=\"s2\">&quot;black&quot;</span><span class=\"p\">,</span>\n                          <span class=\"n\">fontsize</span><span class=\"o\">=</span><span class=\"mi\">12</span><span class=\"p\">,</span> <span class=\"n\">fontweight</span><span class=\"o\">=</span><span class=\"s1\">&#39;bold&#39;</span><span class=\"p\">)</span>\n\n<span class=\"n\">plt</span><span class=\"o\">.</span><span class=\"n\">colorbar</span><span class=\"p\">(</span><span class=\"n\">im</span><span class=\"p\">,</span> <span class=\"n\">ax</span><span class=\"o\">=</span><span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">])</span>\n<span class=\"n\">plt</span><span class=\"o\">.</span><span class=\"n\">tight_layout</span><span class=\"p\">()</span>\n<span class=\"n\">plt</span><span class=\"o\">.</span><span class=\"n\">show</span><span class=\"p\">()</span>\n\n<span class=\"c1\"># Report dettagliato</span>\n<span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"s2\">&quot;</span><span class=\"se\">\\n</span><span class=\"s2\">&quot;</span> <span class=\"o\">+</span> <span class=\"s2\">&quot;=&quot;</span><span class=\"o\">*</span><span class=\"mi\">60</span><span class=\"p\">)</span>\n<span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"s2\">&quot;CLASSIFICATION REPORT (Multi-classe)&quot;</span><span class=\"p\">)</span>\n<span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"s2\">&quot;=&quot;</span><span class=\"o\">*</span><span class=\"mi\">60</span><span class=\"p\">)</span>\n<span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"n\">classification_report</span><span class=\"p\">(</span><span class=\"n\">y_test_mc</span><span class=\"p\">,</span> <span class=\"n\">y_pred_mc</span><span class=\"p\">,</span> <span class=\"n\">digits</span><span class=\"o\">=</span><span class=\"mi\">4</span><span class=\"p\">))</span>\n</code></pre></div>\n</div>\n</details>\n\n<h2 id=\"13-ottimizzazione-della-soglia\">13. Ottimizzazione della Soglia</h2>\n<p>Analisi completa per trovare la soglia ottimale:</p>\n<details class=\"code-container\">\n<summary>Code</summary>\n<div class=\"code-wrapper\">\n<button class=\"copy-button\" onclick=\"\n                const code = this.parentElement.querySelector('pre');\n                if (code) {\n                    navigator.clipboard.writeText(code.innerText);\n                    this.textContent = 'Copied!';\n                    setTimeout(() => this.textContent = 'Copy', 2000);\n                }\n            \">Copy</button>\n<div class=\"codehilite\"><pre><span></span><code><span class=\"n\">thresholds_range</span> <span class=\"o\">=</span> <span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">linspace</span><span class=\"p\">(</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"mi\">1</span><span class=\"p\">,</span> <span class=\"mi\">200</span><span class=\"p\">)</span>\n<span class=\"n\">metrics_vs_threshold</span> <span class=\"o\">=</span> <span class=\"p\">{</span>\n    <span class=\"s1\">&#39;Precision&#39;</span><span class=\"p\">:</span> <span class=\"p\">[],</span>\n    <span class=\"s1\">&#39;Recall&#39;</span><span class=\"p\">:</span> <span class=\"p\">[],</span>\n    <span class=\"s1\">&#39;F1-Score&#39;</span><span class=\"p\">:</span> <span class=\"p\">[],</span>\n    <span class=\"s1\">&#39;F2-Score&#39;</span><span class=\"p\">:</span> <span class=\"p\">[],</span>\n    <span class=\"s1\">&#39;Accuracy&#39;</span><span class=\"p\">:</span> <span class=\"p\">[]</span>\n<span class=\"p\">}</span>\n\n<span class=\"k\">for</span> <span class=\"n\">threshold</span> <span class=\"ow\">in</span> <span class=\"n\">thresholds_range</span><span class=\"p\">:</span>\n    <span class=\"n\">y_pred_thresh</span> <span class=\"o\">=</span> <span class=\"p\">(</span><span class=\"n\">y_proba</span> <span class=\"o\">&gt;=</span> <span class=\"n\">threshold</span><span class=\"p\">)</span><span class=\"o\">.</span><span class=\"n\">astype</span><span class=\"p\">(</span><span class=\"nb\">int</span><span class=\"p\">)</span>\n\n    <span class=\"n\">metrics_vs_threshold</span><span class=\"p\">[</span><span class=\"s1\">&#39;Precision&#39;</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">append</span><span class=\"p\">(</span>\n        <span class=\"n\">precision_score</span><span class=\"p\">(</span><span class=\"n\">y_test</span><span class=\"p\">,</span> <span class=\"n\">y_pred_thresh</span><span class=\"p\">,</span> <span class=\"n\">zero_division</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"p\">))</span>\n    <span class=\"n\">metrics_vs_threshold</span><span class=\"p\">[</span><span class=\"s1\">&#39;Recall&#39;</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">append</span><span class=\"p\">(</span>\n        <span class=\"n\">recall_score</span><span class=\"p\">(</span><span class=\"n\">y_test</span><span class=\"p\">,</span> <span class=\"n\">y_pred_thresh</span><span class=\"p\">,</span> <span class=\"n\">zero_division</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"p\">))</span>\n    <span class=\"n\">metrics_vs_threshold</span><span class=\"p\">[</span><span class=\"s1\">&#39;F1-Score&#39;</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">append</span><span class=\"p\">(</span>\n        <span class=\"n\">f1_score</span><span class=\"p\">(</span><span class=\"n\">y_test</span><span class=\"p\">,</span> <span class=\"n\">y_pred_thresh</span><span class=\"p\">,</span> <span class=\"n\">zero_division</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"p\">))</span>\n    <span class=\"n\">metrics_vs_threshold</span><span class=\"p\">[</span><span class=\"s1\">&#39;F2-Score&#39;</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">append</span><span class=\"p\">(</span>\n        <span class=\"n\">fbeta_score</span><span class=\"p\">(</span><span class=\"n\">y_test</span><span class=\"p\">,</span> <span class=\"n\">y_pred_thresh</span><span class=\"p\">,</span> <span class=\"n\">beta</span><span class=\"o\">=</span><span class=\"mi\">2</span><span class=\"p\">,</span> <span class=\"n\">zero_division</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"p\">))</span>\n    <span class=\"n\">metrics_vs_threshold</span><span class=\"p\">[</span><span class=\"s1\">&#39;Accuracy&#39;</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">append</span><span class=\"p\">(</span>\n        <span class=\"n\">accuracy_score</span><span class=\"p\">(</span><span class=\"n\">y_test</span><span class=\"p\">,</span> <span class=\"n\">y_pred_thresh</span><span class=\"p\">))</span>\n\n<span class=\"n\">fig</span><span class=\"p\">,</span> <span class=\"n\">axes</span> <span class=\"o\">=</span> <span class=\"n\">plt</span><span class=\"o\">.</span><span class=\"n\">subplots</span><span class=\"p\">(</span><span class=\"mi\">2</span><span class=\"p\">,</span> <span class=\"mi\">2</span><span class=\"p\">,</span> <span class=\"n\">figsize</span><span class=\"o\">=</span><span class=\"p\">(</span><span class=\"mi\">15</span><span class=\"p\">,</span> <span class=\"mi\">10</span><span class=\"p\">))</span>\n\n<span class=\"c1\"># Grafico 1: Tutte le metriche</span>\n<span class=\"k\">for</span> <span class=\"n\">metric</span><span class=\"p\">,</span> <span class=\"n\">values</span> <span class=\"ow\">in</span> <span class=\"n\">metrics_vs_threshold</span><span class=\"o\">.</span><span class=\"n\">items</span><span class=\"p\">():</span>\n    <span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"mi\">0</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">plot</span><span class=\"p\">(</span><span class=\"n\">thresholds_range</span><span class=\"p\">,</span> <span class=\"n\">values</span><span class=\"p\">,</span> <span class=\"n\">lw</span><span class=\"o\">=</span><span class=\"mi\">2</span><span class=\"p\">,</span> <span class=\"n\">label</span><span class=\"o\">=</span><span class=\"n\">metric</span><span class=\"p\">)</span>\n\n<span class=\"n\">optimal_f1_idx</span> <span class=\"o\">=</span> <span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">argmax</span><span class=\"p\">(</span><span class=\"n\">metrics_vs_threshold</span><span class=\"p\">[</span><span class=\"s1\">&#39;F1-Score&#39;</span><span class=\"p\">])</span>\n<span class=\"n\">optimal_f1_threshold</span> <span class=\"o\">=</span> <span class=\"n\">thresholds_range</span><span class=\"p\">[</span><span class=\"n\">optimal_f1_idx</span><span class=\"p\">]</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"mi\">0</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">axvline</span><span class=\"p\">(</span><span class=\"n\">optimal_f1_threshold</span><span class=\"p\">,</span> <span class=\"n\">color</span><span class=\"o\">=</span><span class=\"s1\">&#39;red&#39;</span><span class=\"p\">,</span> <span class=\"n\">linestyle</span><span class=\"o\">=</span><span class=\"s1\">&#39;--&#39;</span><span class=\"p\">,</span> <span class=\"n\">lw</span><span class=\"o\">=</span><span class=\"mi\">2</span><span class=\"p\">,</span> \n                  <span class=\"n\">label</span><span class=\"o\">=</span><span class=\"sa\">f</span><span class=\"s1\">&#39;Ottimo F1: τ=</span><span class=\"si\">{</span><span class=\"n\">optimal_f1_threshold</span><span class=\"si\">:</span><span class=\"s1\">.3f</span><span class=\"si\">}</span><span class=\"s1\">&#39;</span><span class=\"p\">)</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"mi\">0</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">axvline</span><span class=\"p\">(</span><span class=\"mf\">0.5</span><span class=\"p\">,</span> <span class=\"n\">color</span><span class=\"o\">=</span><span class=\"s1\">&#39;gray&#39;</span><span class=\"p\">,</span> <span class=\"n\">linestyle</span><span class=\"o\">=</span><span class=\"s1\">&#39;:&#39;</span><span class=\"p\">,</span> <span class=\"n\">alpha</span><span class=\"o\">=</span><span class=\"mf\">0.5</span><span class=\"p\">,</span> <span class=\"n\">label</span><span class=\"o\">=</span><span class=\"s1\">&#39;Default (0.5)&#39;</span><span class=\"p\">)</span>\n\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"mi\">0</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">set_xlabel</span><span class=\"p\">(</span><span class=\"s1\">&#39;Soglia di Classificazione&#39;</span><span class=\"p\">,</span> <span class=\"n\">fontsize</span><span class=\"o\">=</span><span class=\"mi\">12</span><span class=\"p\">)</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"mi\">0</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">set_ylabel</span><span class=\"p\">(</span><span class=\"s1\">&#39;Valore Metrica&#39;</span><span class=\"p\">,</span> <span class=\"n\">fontsize</span><span class=\"o\">=</span><span class=\"mi\">12</span><span class=\"p\">)</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"mi\">0</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">set_title</span><span class=\"p\">(</span><span class=\"s1\">&#39;Metriche vs Soglia&#39;</span><span class=\"p\">,</span> <span class=\"n\">fontsize</span><span class=\"o\">=</span><span class=\"mi\">14</span><span class=\"p\">,</span> <span class=\"n\">fontweight</span><span class=\"o\">=</span><span class=\"s1\">&#39;bold&#39;</span><span class=\"p\">)</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"mi\">0</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">legend</span><span class=\"p\">(</span><span class=\"n\">loc</span><span class=\"o\">=</span><span class=\"s1\">&#39;best&#39;</span><span class=\"p\">)</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"mi\">0</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">grid</span><span class=\"p\">(</span><span class=\"n\">alpha</span><span class=\"o\">=</span><span class=\"mf\">0.3</span><span class=\"p\">)</span>\n\n<span class=\"c1\"># Grafico 2: Focus Precision-Recall</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"mi\">1</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">plot</span><span class=\"p\">(</span><span class=\"n\">thresholds_range</span><span class=\"p\">,</span> <span class=\"n\">metrics_vs_threshold</span><span class=\"p\">[</span><span class=\"s1\">&#39;Precision&#39;</span><span class=\"p\">],</span> \n               <span class=\"s1\">&#39;b-&#39;</span><span class=\"p\">,</span> <span class=\"n\">lw</span><span class=\"o\">=</span><span class=\"mi\">2</span><span class=\"p\">,</span> <span class=\"n\">label</span><span class=\"o\">=</span><span class=\"s1\">&#39;Precision&#39;</span><span class=\"p\">)</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"mi\">1</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">plot</span><span class=\"p\">(</span><span class=\"n\">thresholds_range</span><span class=\"p\">,</span> <span class=\"n\">metrics_vs_threshold</span><span class=\"p\">[</span><span class=\"s1\">&#39;Recall&#39;</span><span class=\"p\">],</span> \n               <span class=\"s1\">&#39;r-&#39;</span><span class=\"p\">,</span> <span class=\"n\">lw</span><span class=\"o\">=</span><span class=\"mi\">2</span><span class=\"p\">,</span> <span class=\"n\">label</span><span class=\"o\">=</span><span class=\"s1\">&#39;Recall&#39;</span><span class=\"p\">)</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"mi\">1</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">plot</span><span class=\"p\">(</span><span class=\"n\">thresholds_range</span><span class=\"p\">,</span> <span class=\"n\">metrics_vs_threshold</span><span class=\"p\">[</span><span class=\"s1\">&#39;F1-Score&#39;</span><span class=\"p\">],</span> \n               <span class=\"s1\">&#39;g-&#39;</span><span class=\"p\">,</span> <span class=\"n\">lw</span><span class=\"o\">=</span><span class=\"mi\">2</span><span class=\"p\">,</span> <span class=\"n\">label</span><span class=\"o\">=</span><span class=\"s1\">&#39;F1-Score&#39;</span><span class=\"p\">)</span>\n\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"mi\">1</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">axvline</span><span class=\"p\">(</span><span class=\"n\">optimal_f1_threshold</span><span class=\"p\">,</span> <span class=\"n\">color</span><span class=\"o\">=</span><span class=\"s1\">&#39;green&#39;</span><span class=\"p\">,</span> <span class=\"n\">linestyle</span><span class=\"o\">=</span><span class=\"s1\">&#39;--&#39;</span><span class=\"p\">,</span> <span class=\"n\">lw</span><span class=\"o\">=</span><span class=\"mi\">2</span><span class=\"p\">)</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"mi\">1</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">scatter</span><span class=\"p\">([</span><span class=\"n\">optimal_f1_threshold</span><span class=\"p\">],</span> \n                  <span class=\"p\">[</span><span class=\"n\">metrics_vs_threshold</span><span class=\"p\">[</span><span class=\"s1\">&#39;F1-Score&#39;</span><span class=\"p\">][</span><span class=\"n\">optimal_f1_idx</span><span class=\"p\">]],</span>\n                  <span class=\"n\">s</span><span class=\"o\">=</span><span class=\"mi\">200</span><span class=\"p\">,</span> <span class=\"n\">c</span><span class=\"o\">=</span><span class=\"s1\">&#39;green&#39;</span><span class=\"p\">,</span> <span class=\"n\">marker</span><span class=\"o\">=</span><span class=\"s1\">&#39;*&#39;</span><span class=\"p\">,</span> <span class=\"n\">zorder</span><span class=\"o\">=</span><span class=\"mi\">5</span><span class=\"p\">,</span> <span class=\"n\">edgecolor</span><span class=\"o\">=</span><span class=\"s1\">&#39;black&#39;</span><span class=\"p\">,</span> <span class=\"n\">linewidth</span><span class=\"o\">=</span><span class=\"mi\">2</span><span class=\"p\">)</span>\n\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"mi\">1</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">set_xlabel</span><span class=\"p\">(</span><span class=\"s1\">&#39;Soglia&#39;</span><span class=\"p\">,</span> <span class=\"n\">fontsize</span><span class=\"o\">=</span><span class=\"mi\">12</span><span class=\"p\">)</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"mi\">1</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">set_ylabel</span><span class=\"p\">(</span><span class=\"s1\">&#39;Valore&#39;</span><span class=\"p\">,</span> <span class=\"n\">fontsize</span><span class=\"o\">=</span><span class=\"mi\">12</span><span class=\"p\">)</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"mi\">1</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">set_title</span><span class=\"p\">(</span><span class=\"s1\">&#39;Trade-off Precision-Recall&#39;</span><span class=\"p\">,</span> <span class=\"n\">fontsize</span><span class=\"o\">=</span><span class=\"mi\">14</span><span class=\"p\">,</span> <span class=\"n\">fontweight</span><span class=\"o\">=</span><span class=\"s1\">&#39;bold&#39;</span><span class=\"p\">)</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"mi\">1</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">legend</span><span class=\"p\">()</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"mi\">1</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">grid</span><span class=\"p\">(</span><span class=\"n\">alpha</span><span class=\"o\">=</span><span class=\"mf\">0.3</span><span class=\"p\">)</span>\n\n<span class=\"c1\"># Grafico 3: Heatmap metriche per diversi obiettivi</span>\n<span class=\"n\">objectives</span> <span class=\"o\">=</span> <span class=\"p\">{</span>\n    <span class=\"s1\">&#39;Balanced (F1)&#39;</span><span class=\"p\">:</span> <span class=\"n\">optimal_f1_idx</span><span class=\"p\">,</span>\n    <span class=\"s1\">&#39;High Recall (F2)&#39;</span><span class=\"p\">:</span> <span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">argmax</span><span class=\"p\">(</span><span class=\"n\">metrics_vs_threshold</span><span class=\"p\">[</span><span class=\"s1\">&#39;F2-Score&#39;</span><span class=\"p\">]),</span>\n    <span class=\"s1\">&#39;High Precision&#39;</span><span class=\"p\">:</span> <span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">argmax</span><span class=\"p\">(</span><span class=\"n\">metrics_vs_threshold</span><span class=\"p\">[</span><span class=\"s1\">&#39;Precision&#39;</span><span class=\"p\">]),</span>\n    <span class=\"s1\">&#39;Max Accuracy&#39;</span><span class=\"p\">:</span> <span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">argmax</span><span class=\"p\">(</span><span class=\"n\">metrics_vs_threshold</span><span class=\"p\">[</span><span class=\"s1\">&#39;Accuracy&#39;</span><span class=\"p\">])</span>\n<span class=\"p\">}</span>\n\n<span class=\"n\">obj_data</span> <span class=\"o\">=</span> <span class=\"p\">[]</span>\n<span class=\"k\">for</span> <span class=\"n\">obj_name</span><span class=\"p\">,</span> <span class=\"n\">idx</span> <span class=\"ow\">in</span> <span class=\"n\">objectives</span><span class=\"o\">.</span><span class=\"n\">items</span><span class=\"p\">():</span>\n    <span class=\"n\">tau</span> <span class=\"o\">=</span> <span class=\"n\">thresholds_range</span><span class=\"p\">[</span><span class=\"n\">idx</span><span class=\"p\">]</span>\n    <span class=\"n\">obj_data</span><span class=\"o\">.</span><span class=\"n\">append</span><span class=\"p\">([</span>\n        <span class=\"n\">tau</span><span class=\"p\">,</span>\n        <span class=\"n\">metrics_vs_threshold</span><span class=\"p\">[</span><span class=\"s1\">&#39;Precision&#39;</span><span class=\"p\">][</span><span class=\"n\">idx</span><span class=\"p\">],</span>\n        <span class=\"n\">metrics_vs_threshold</span><span class=\"p\">[</span><span class=\"s1\">&#39;Recall&#39;</span><span class=\"p\">][</span><span class=\"n\">idx</span><span class=\"p\">],</span>\n        <span class=\"n\">metrics_vs_threshold</span><span class=\"p\">[</span><span class=\"s1\">&#39;F1-Score&#39;</span><span class=\"p\">][</span><span class=\"n\">idx</span><span class=\"p\">],</span>\n        <span class=\"n\">metrics_vs_threshold</span><span class=\"p\">[</span><span class=\"s1\">&#39;Accuracy&#39;</span><span class=\"p\">][</span><span class=\"n\">idx</span><span class=\"p\">]</span>\n    <span class=\"p\">])</span>\n\n<span class=\"n\">obj_df</span> <span class=\"o\">=</span> <span class=\"n\">pd</span><span class=\"o\">.</span><span class=\"n\">DataFrame</span><span class=\"p\">(</span><span class=\"n\">obj_data</span><span class=\"p\">,</span> \n                     <span class=\"n\">columns</span><span class=\"o\">=</span><span class=\"p\">[</span><span class=\"s1\">&#39;Soglia&#39;</span><span class=\"p\">,</span> <span class=\"s1\">&#39;Precision&#39;</span><span class=\"p\">,</span> <span class=\"s1\">&#39;Recall&#39;</span><span class=\"p\">,</span> <span class=\"s1\">&#39;F1&#39;</span><span class=\"p\">,</span> <span class=\"s1\">&#39;Accuracy&#39;</span><span class=\"p\">],</span>\n                     <span class=\"n\">index</span><span class=\"o\">=</span><span class=\"nb\">list</span><span class=\"p\">(</span><span class=\"n\">objectives</span><span class=\"o\">.</span><span class=\"n\">keys</span><span class=\"p\">()))</span>\n\n<span class=\"n\">im</span> <span class=\"o\">=</span> <span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">,</span> <span class=\"mi\">0</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">imshow</span><span class=\"p\">(</span><span class=\"n\">obj_df</span><span class=\"o\">.</span><span class=\"n\">iloc</span><span class=\"p\">[:,</span> <span class=\"mi\">1</span><span class=\"p\">:]</span><span class=\"o\">.</span><span class=\"n\">values</span><span class=\"p\">,</span> <span class=\"n\">cmap</span><span class=\"o\">=</span><span class=\"s1\">&#39;RdYlGn&#39;</span><span class=\"p\">,</span> <span class=\"n\">aspect</span><span class=\"o\">=</span><span class=\"s1\">&#39;auto&#39;</span><span class=\"p\">,</span> <span class=\"n\">vmin</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"n\">vmax</span><span class=\"o\">=</span><span class=\"mi\">1</span><span class=\"p\">)</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">,</span> <span class=\"mi\">0</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">set_xticks</span><span class=\"p\">(</span><span class=\"nb\">range</span><span class=\"p\">(</span><span class=\"mi\">4</span><span class=\"p\">))</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">,</span> <span class=\"mi\">0</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">set_xticklabels</span><span class=\"p\">([</span><span class=\"s1\">&#39;Precision&#39;</span><span class=\"p\">,</span> <span class=\"s1\">&#39;Recall&#39;</span><span class=\"p\">,</span> <span class=\"s1\">&#39;F1&#39;</span><span class=\"p\">,</span> <span class=\"s1\">&#39;Accuracy&#39;</span><span class=\"p\">],</span> <span class=\"n\">rotation</span><span class=\"o\">=</span><span class=\"mi\">45</span><span class=\"p\">)</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">,</span> <span class=\"mi\">0</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">set_yticks</span><span class=\"p\">(</span><span class=\"nb\">range</span><span class=\"p\">(</span><span class=\"nb\">len</span><span class=\"p\">(</span><span class=\"n\">objectives</span><span class=\"p\">)))</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">,</span> <span class=\"mi\">0</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">set_yticklabels</span><span class=\"p\">(</span><span class=\"nb\">list</span><span class=\"p\">(</span><span class=\"n\">objectives</span><span class=\"o\">.</span><span class=\"n\">keys</span><span class=\"p\">()))</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">,</span> <span class=\"mi\">0</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">set_title</span><span class=\"p\">(</span><span class=\"s1\">&#39;Metriche per Diversi Obiettivi&#39;</span><span class=\"p\">,</span> <span class=\"n\">fontsize</span><span class=\"o\">=</span><span class=\"mi\">14</span><span class=\"p\">,</span> <span class=\"n\">fontweight</span><span class=\"o\">=</span><span class=\"s1\">&#39;bold&#39;</span><span class=\"p\">)</span>\n\n<span class=\"k\">for</span> <span class=\"n\">i</span> <span class=\"ow\">in</span> <span class=\"nb\">range</span><span class=\"p\">(</span><span class=\"nb\">len</span><span class=\"p\">(</span><span class=\"n\">objectives</span><span class=\"p\">)):</span>\n    <span class=\"k\">for</span> <span class=\"n\">j</span> <span class=\"ow\">in</span> <span class=\"nb\">range</span><span class=\"p\">(</span><span class=\"mi\">4</span><span class=\"p\">):</span>\n        <span class=\"n\">text</span> <span class=\"o\">=</span> <span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">,</span> <span class=\"mi\">0</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">text</span><span class=\"p\">(</span><span class=\"n\">j</span><span class=\"p\">,</span> <span class=\"n\">i</span><span class=\"p\">,</span> <span class=\"sa\">f</span><span class=\"s1\">&#39;</span><span class=\"si\">{</span><span class=\"n\">obj_df</span><span class=\"o\">.</span><span class=\"n\">iloc</span><span class=\"p\">[</span><span class=\"n\">i</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">j</span><span class=\"o\">+</span><span class=\"mi\">1</span><span class=\"p\">]</span><span class=\"si\">:</span><span class=\"s1\">.3f</span><span class=\"si\">}</span><span class=\"s1\">&#39;</span><span class=\"p\">,</span>\n                              <span class=\"n\">ha</span><span class=\"o\">=</span><span class=\"s2\">&quot;center&quot;</span><span class=\"p\">,</span> <span class=\"n\">va</span><span class=\"o\">=</span><span class=\"s2\">&quot;center&quot;</span><span class=\"p\">,</span> <span class=\"n\">color</span><span class=\"o\">=</span><span class=\"s2\">&quot;black&quot;</span><span class=\"p\">,</span> <span class=\"n\">fontsize</span><span class=\"o\">=</span><span class=\"mi\">10</span><span class=\"p\">)</span>\n    <span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">,</span> <span class=\"mi\">0</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">text</span><span class=\"p\">(</span><span class=\"o\">-</span><span class=\"mf\">1.2</span><span class=\"p\">,</span> <span class=\"n\">i</span><span class=\"p\">,</span> <span class=\"sa\">f</span><span class=\"s1\">&#39;τ=</span><span class=\"si\">{</span><span class=\"n\">obj_df</span><span class=\"o\">.</span><span class=\"n\">iloc</span><span class=\"p\">[</span><span class=\"n\">i</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"p\">]</span><span class=\"si\">:</span><span class=\"s1\">.3f</span><span class=\"si\">}</span><span class=\"s1\">&#39;</span><span class=\"p\">,</span>\n                   <span class=\"n\">ha</span><span class=\"o\">=</span><span class=\"s2\">&quot;right&quot;</span><span class=\"p\">,</span> <span class=\"n\">va</span><span class=\"o\">=</span><span class=\"s2\">&quot;center&quot;</span><span class=\"p\">,</span> <span class=\"n\">fontsize</span><span class=\"o\">=</span><span class=\"mi\">9</span><span class=\"p\">,</span> <span class=\"n\">style</span><span class=\"o\">=</span><span class=\"s1\">&#39;italic&#39;</span><span class=\"p\">)</span>\n\n<span class=\"n\">plt</span><span class=\"o\">.</span><span class=\"n\">colorbar</span><span class=\"p\">(</span><span class=\"n\">im</span><span class=\"p\">,</span> <span class=\"n\">ax</span><span class=\"o\">=</span><span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">,</span> <span class=\"mi\">0</span><span class=\"p\">])</span>\n\n<span class=\"c1\"># Grafico 4: Raccomandazioni</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">,</span> <span class=\"mi\">1</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">axis</span><span class=\"p\">(</span><span class=\"s1\">&#39;off&#39;</span><span class=\"p\">)</span>\n<span class=\"n\">recommendations</span> <span class=\"o\">=</span> <span class=\"sa\">f</span><span class=\"s2\">&quot;&quot;&quot;</span>\n<span class=\"s2\">RACCOMANDAZIONI SOGLIA OTTIMALE</span>\n\n<span class=\"s2\">1. Balanced (F1 massimo):</span>\n<span class=\"s2\">   • Soglia: τ = </span><span class=\"si\">{</span><span class=\"n\">thresholds_range</span><span class=\"p\">[</span><span class=\"n\">objectives</span><span class=\"p\">[</span><span class=\"s1\">&#39;Balanced (F1)&#39;</span><span class=\"p\">]]</span><span class=\"mf\">.3</span><span class=\"n\">f</span><span class=\"si\">}</span>\n<span class=\"s2\">   • F1 = </span><span class=\"si\">{</span><span class=\"n\">metrics_vs_threshold</span><span class=\"p\">[</span><span class=\"s1\">&#39;F1-Score&#39;</span><span class=\"p\">][</span><span class=\"n\">objectives</span><span class=\"p\">[</span><span class=\"s1\">&#39;Balanced (F1)&#39;</span><span class=\"p\">]]</span><span class=\"mf\">.4</span><span class=\"n\">f</span><span class=\"si\">}</span>\n<span class=\"s2\">   • Uso: Bilanciamento generale</span>\n\n<span class=\"s2\">2. High Recall (Sensibilità):</span>\n<span class=\"s2\">   • Soglia: τ = </span><span class=\"si\">{</span><span class=\"n\">thresholds_range</span><span class=\"p\">[</span><span class=\"n\">objectives</span><span class=\"p\">[</span><span class=\"s1\">&#39;High Recall (F2)&#39;</span><span class=\"p\">]]</span><span class=\"mf\">.3</span><span class=\"n\">f</span><span class=\"si\">}</span>\n<span class=\"s2\">   • F2 = </span><span class=\"si\">{</span><span class=\"n\">metrics_vs_threshold</span><span class=\"p\">[</span><span class=\"s1\">&#39;F2-Score&#39;</span><span class=\"p\">][</span><span class=\"n\">objectives</span><span class=\"p\">[</span><span class=\"s1\">&#39;High Recall (F2)&#39;</span><span class=\"p\">]]</span><span class=\"mf\">.4</span><span class=\"n\">f</span><span class=\"si\">}</span>\n<span class=\"s2\">   • Uso: Minimizzare falsi negativi</span>\n<span class=\"s2\">   • Es: Diagnosi mediche, frodi</span>\n\n<span class=\"s2\">3. High Precision (Specificità):</span>\n<span class=\"s2\">   • Soglia: τ = </span><span class=\"si\">{</span><span class=\"n\">thresholds_range</span><span class=\"p\">[</span><span class=\"n\">objectives</span><span class=\"p\">[</span><span class=\"s1\">&#39;High Precision&#39;</span><span class=\"p\">]]</span><span class=\"mf\">.3</span><span class=\"n\">f</span><span class=\"si\">}</span>\n<span class=\"s2\">   • Prec = </span><span class=\"si\">{</span><span class=\"n\">metrics_vs_threshold</span><span class=\"p\">[</span><span class=\"s1\">&#39;Precision&#39;</span><span class=\"p\">][</span><span class=\"n\">objectives</span><span class=\"p\">[</span><span class=\"s1\">&#39;High Precision&#39;</span><span class=\"p\">]]</span><span class=\"mf\">.4</span><span class=\"n\">f</span><span class=\"si\">}</span>\n<span class=\"s2\">   • Uso: Minimizzare falsi positivi</span>\n<span class=\"s2\">   • Es: Spam detection, raccomandazioni</span>\n\n<span class=\"s2\">4. Max Accuracy:</span>\n<span class=\"s2\">   • Soglia: τ = </span><span class=\"si\">{</span><span class=\"n\">thresholds_range</span><span class=\"p\">[</span><span class=\"n\">objectives</span><span class=\"p\">[</span><span class=\"s1\">&#39;Max Accuracy&#39;</span><span class=\"p\">]]</span><span class=\"mf\">.3</span><span class=\"n\">f</span><span class=\"si\">}</span>\n<span class=\"s2\">   • Acc = </span><span class=\"si\">{</span><span class=\"n\">metrics_vs_threshold</span><span class=\"p\">[</span><span class=\"s1\">&#39;Accuracy&#39;</span><span class=\"p\">][</span><span class=\"n\">objectives</span><span class=\"p\">[</span><span class=\"s1\">&#39;Max Accuracy&#39;</span><span class=\"p\">]]</span><span class=\"mf\">.4</span><span class=\"n\">f</span><span class=\"si\">}</span>\n<span class=\"s2\">   • Uso: Solo se classi bilanciate</span>\n\n<span class=\"s2\">SCELTA PRATICA:</span>\n<span class=\"s2\">✓ Start con F1 massimo</span>\n<span class=\"s2\">✓ Aggiusta in base al costo errori</span>\n<span class=\"s2\">✓ Valida su set di validazione</span>\n<span class=\"s2\">✓ Considera vincoli di business</span>\n<span class=\"s2\">&quot;&quot;&quot;</span>\n\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">,</span> <span class=\"mi\">1</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">text</span><span class=\"p\">(</span><span class=\"mf\">0.05</span><span class=\"p\">,</span> <span class=\"mf\">0.95</span><span class=\"p\">,</span> <span class=\"n\">recommendations</span><span class=\"p\">,</span> <span class=\"n\">fontsize</span><span class=\"o\">=</span><span class=\"mi\">9</span><span class=\"p\">,</span> <span class=\"n\">verticalalignment</span><span class=\"o\">=</span><span class=\"s1\">&#39;top&#39;</span><span class=\"p\">,</span>\n               <span class=\"n\">family</span><span class=\"o\">=</span><span class=\"s1\">&#39;monospace&#39;</span><span class=\"p\">,</span> \n               <span class=\"n\">bbox</span><span class=\"o\">=</span><span class=\"nb\">dict</span><span class=\"p\">(</span><span class=\"n\">boxstyle</span><span class=\"o\">=</span><span class=\"s1\">&#39;round&#39;</span><span class=\"p\">,</span> <span class=\"n\">facecolor</span><span class=\"o\">=</span><span class=\"s1\">&#39;lightyellow&#39;</span><span class=\"p\">,</span> <span class=\"n\">alpha</span><span class=\"o\">=</span><span class=\"mf\">0.8</span><span class=\"p\">))</span>\n\n<span class=\"n\">plt</span><span class=\"o\">.</span><span class=\"n\">tight_layout</span><span class=\"p\">()</span>\n<span class=\"n\">plt</span><span class=\"o\">.</span><span class=\"n\">show</span><span class=\"p\">()</span>\n\n<span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"s2\">&quot;</span><span class=\"se\">\\n</span><span class=\"s2\">&quot;</span> <span class=\"o\">+</span> <span class=\"s2\">&quot;=&quot;</span><span class=\"o\">*</span><span class=\"mi\">70</span><span class=\"p\">)</span>\n<span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"s2\">&quot;ANALISI SOGLIE OTTIMALI&quot;</span><span class=\"p\">)</span>\n<span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"s2\">&quot;=&quot;</span><span class=\"o\">*</span><span class=\"mi\">70</span><span class=\"p\">)</span>\n<span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"n\">obj_df</span><span class=\"o\">.</span><span class=\"n\">to_string</span><span class=\"p\">())</span>\n<span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"s2\">&quot;=&quot;</span><span class=\"o\">*</span><span class=\"mi\">70</span><span class=\"p\">)</span>\n</code></pre></div>\n</div>\n</details>\n\n<h2 id=\"14-lift-e-gain-charts\">14. Lift e Gain Charts</h2>\n<h3 id=\"141-cumulative-gain-chart\">14.1 Cumulative Gain Chart</h3>\n<p>Il <strong>Cumulative Gain Chart</strong> mostra la percentuale di target catturati in funzione della popolazione contattata:</p>\n<details class=\"code-container\">\n<summary>Code</summary>\n<div class=\"code-wrapper\">\n<button class=\"copy-button\" onclick=\"\n                const code = this.parentElement.querySelector('pre');\n                if (code) {\n                    navigator.clipboard.writeText(code.innerText);\n                    this.textContent = 'Copied!';\n                    setTimeout(() => this.textContent = 'Copy', 2000);\n                }\n            \">Copy</button>\n<div class=\"codehilite\"><pre><span></span><code><span class=\"c1\"># Ordina per probabilità decrescente</span>\n<span class=\"n\">sorted_indices</span> <span class=\"o\">=</span> <span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">argsort</span><span class=\"p\">(</span><span class=\"n\">y_proba</span><span class=\"p\">)[::</span><span class=\"o\">-</span><span class=\"mi\">1</span><span class=\"p\">]</span>\n<span class=\"n\">y_sorted</span> <span class=\"o\">=</span> <span class=\"n\">y_test</span><span class=\"o\">.</span><span class=\"n\">iloc</span><span class=\"p\">[</span><span class=\"n\">sorted_indices</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">values</span> <span class=\"k\">if</span> <span class=\"nb\">hasattr</span><span class=\"p\">(</span><span class=\"n\">y_test</span><span class=\"p\">,</span> <span class=\"s1\">&#39;iloc&#39;</span><span class=\"p\">)</span> <span class=\"k\">else</span> <span class=\"n\">y_test</span><span class=\"p\">[</span><span class=\"n\">sorted_indices</span><span class=\"p\">]</span>\n\n<span class=\"n\">cumulative_gains</span> <span class=\"o\">=</span> <span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">cumsum</span><span class=\"p\">(</span><span class=\"n\">y_sorted</span><span class=\"p\">)</span> <span class=\"o\">/</span> <span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">sum</span><span class=\"p\">(</span><span class=\"n\">y_sorted</span><span class=\"p\">)</span>\n<span class=\"n\">percentage_population</span> <span class=\"o\">=</span> <span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">arange</span><span class=\"p\">(</span><span class=\"mi\">1</span><span class=\"p\">,</span> <span class=\"nb\">len</span><span class=\"p\">(</span><span class=\"n\">y_sorted</span><span class=\"p\">)</span> <span class=\"o\">+</span> <span class=\"mi\">1</span><span class=\"p\">)</span> <span class=\"o\">/</span> <span class=\"nb\">len</span><span class=\"p\">(</span><span class=\"n\">y_sorted</span><span class=\"p\">)</span>\n\n<span class=\"n\">fig</span><span class=\"p\">,</span> <span class=\"n\">axes</span> <span class=\"o\">=</span> <span class=\"n\">plt</span><span class=\"o\">.</span><span class=\"n\">subplots</span><span class=\"p\">(</span><span class=\"mi\">1</span><span class=\"p\">,</span> <span class=\"mi\">2</span><span class=\"p\">,</span> <span class=\"n\">figsize</span><span class=\"o\">=</span><span class=\"p\">(</span><span class=\"mi\">15</span><span class=\"p\">,</span> <span class=\"mi\">6</span><span class=\"p\">))</span>\n\n<span class=\"c1\"># Cumulative Gain</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">plot</span><span class=\"p\">(</span><span class=\"n\">percentage_population</span> <span class=\"o\">*</span> <span class=\"mi\">100</span><span class=\"p\">,</span> <span class=\"n\">cumulative_gains</span> <span class=\"o\">*</span> <span class=\"mi\">100</span><span class=\"p\">,</span> \n            <span class=\"n\">label</span><span class=\"o\">=</span><span class=\"s1\">&#39;Modello&#39;</span><span class=\"p\">,</span> <span class=\"n\">lw</span><span class=\"o\">=</span><span class=\"mi\">3</span><span class=\"p\">,</span> <span class=\"n\">color</span><span class=\"o\">=</span><span class=\"s1\">&#39;blue&#39;</span><span class=\"p\">)</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">plot</span><span class=\"p\">([</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"mi\">100</span><span class=\"p\">],</span> <span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"mi\">100</span><span class=\"p\">],</span> <span class=\"s1\">&#39;k--&#39;</span><span class=\"p\">,</span> <span class=\"n\">label</span><span class=\"o\">=</span><span class=\"s1\">&#39;Random&#39;</span><span class=\"p\">,</span> <span class=\"n\">lw</span><span class=\"o\">=</span><span class=\"mi\">2</span><span class=\"p\">)</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">fill_between</span><span class=\"p\">(</span><span class=\"n\">percentage_population</span> <span class=\"o\">*</span> <span class=\"mi\">100</span><span class=\"p\">,</span> <span class=\"n\">cumulative_gains</span> <span class=\"o\">*</span> <span class=\"mi\">100</span><span class=\"p\">,</span> \n                     <span class=\"n\">percentage_population</span> <span class=\"o\">*</span> <span class=\"mi\">100</span><span class=\"p\">,</span> <span class=\"n\">alpha</span><span class=\"o\">=</span><span class=\"mf\">0.3</span><span class=\"p\">,</span> <span class=\"n\">color</span><span class=\"o\">=</span><span class=\"s1\">&#39;blue&#39;</span><span class=\"p\">)</span>\n\n<span class=\"c1\"># Punto al 20% e 50%</span>\n<span class=\"n\">idx_20</span> <span class=\"o\">=</span> <span class=\"nb\">int</span><span class=\"p\">(</span><span class=\"mf\">0.2</span> <span class=\"o\">*</span> <span class=\"nb\">len</span><span class=\"p\">(</span><span class=\"n\">y_sorted</span><span class=\"p\">))</span>\n<span class=\"n\">idx_50</span> <span class=\"o\">=</span> <span class=\"nb\">int</span><span class=\"p\">(</span><span class=\"mf\">0.5</span> <span class=\"o\">*</span> <span class=\"nb\">len</span><span class=\"p\">(</span><span class=\"n\">y_sorted</span><span class=\"p\">))</span>\n<span class=\"n\">gain_20</span> <span class=\"o\">=</span> <span class=\"n\">cumulative_gains</span><span class=\"p\">[</span><span class=\"n\">idx_20</span><span class=\"p\">]</span> <span class=\"o\">*</span> <span class=\"mi\">100</span>\n<span class=\"n\">gain_50</span> <span class=\"o\">=</span> <span class=\"n\">cumulative_gains</span><span class=\"p\">[</span><span class=\"n\">idx_50</span><span class=\"p\">]</span> <span class=\"o\">*</span> <span class=\"mi\">100</span>\n\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">plot</span><span class=\"p\">(</span><span class=\"mi\">20</span><span class=\"p\">,</span> <span class=\"n\">gain_20</span><span class=\"p\">,</span> <span class=\"s1\">&#39;ro&#39;</span><span class=\"p\">,</span> <span class=\"n\">markersize</span><span class=\"o\">=</span><span class=\"mi\">12</span><span class=\"p\">)</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">plot</span><span class=\"p\">(</span><span class=\"mi\">50</span><span class=\"p\">,</span> <span class=\"n\">gain_50</span><span class=\"p\">,</span> <span class=\"s1\">&#39;go&#39;</span><span class=\"p\">,</span> <span class=\"n\">markersize</span><span class=\"o\">=</span><span class=\"mi\">12</span><span class=\"p\">)</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">annotate</span><span class=\"p\">(</span><span class=\"sa\">f</span><span class=\"s1\">&#39;</span><span class=\"si\">{</span><span class=\"n\">gain_20</span><span class=\"si\">:</span><span class=\"s1\">.1f</span><span class=\"si\">}</span><span class=\"s1\">% target</span><span class=\"se\">\\n</span><span class=\"s1\">con 20% popolazione&#39;</span><span class=\"p\">,</span> \n                <span class=\"n\">xy</span><span class=\"o\">=</span><span class=\"p\">(</span><span class=\"mi\">20</span><span class=\"p\">,</span> <span class=\"n\">gain_20</span><span class=\"p\">),</span> <span class=\"n\">xytext</span><span class=\"o\">=</span><span class=\"p\">(</span><span class=\"mi\">30</span><span class=\"p\">,</span> <span class=\"n\">gain_20</span><span class=\"o\">-</span><span class=\"mi\">15</span><span class=\"p\">),</span>\n                <span class=\"n\">arrowprops</span><span class=\"o\">=</span><span class=\"nb\">dict</span><span class=\"p\">(</span><span class=\"n\">arrowstyle</span><span class=\"o\">=</span><span class=\"s1\">&#39;-&gt;&#39;</span><span class=\"p\">,</span> <span class=\"n\">color</span><span class=\"o\">=</span><span class=\"s1\">&#39;red&#39;</span><span class=\"p\">,</span> <span class=\"n\">lw</span><span class=\"o\">=</span><span class=\"mi\">2</span><span class=\"p\">),</span>\n                <span class=\"n\">fontsize</span><span class=\"o\">=</span><span class=\"mi\">10</span><span class=\"p\">,</span> <span class=\"n\">bbox</span><span class=\"o\">=</span><span class=\"nb\">dict</span><span class=\"p\">(</span><span class=\"n\">boxstyle</span><span class=\"o\">=</span><span class=\"s1\">&#39;round&#39;</span><span class=\"p\">,</span> <span class=\"n\">facecolor</span><span class=\"o\">=</span><span class=\"s1\">&#39;pink&#39;</span><span class=\"p\">,</span> <span class=\"n\">alpha</span><span class=\"o\">=</span><span class=\"mf\">0.7</span><span class=\"p\">))</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">annotate</span><span class=\"p\">(</span><span class=\"sa\">f</span><span class=\"s1\">&#39;</span><span class=\"si\">{</span><span class=\"n\">gain_50</span><span class=\"si\">:</span><span class=\"s1\">.1f</span><span class=\"si\">}</span><span class=\"s1\">% target</span><span class=\"se\">\\n</span><span class=\"s1\">con 50% popolazione&#39;</span><span class=\"p\">,</span> \n                <span class=\"n\">xy</span><span class=\"o\">=</span><span class=\"p\">(</span><span class=\"mi\">50</span><span class=\"p\">,</span> <span class=\"n\">gain_50</span><span class=\"p\">),</span> <span class=\"n\">xytext</span><span class=\"o\">=</span><span class=\"p\">(</span><span class=\"mi\">60</span><span class=\"p\">,</span> <span class=\"n\">gain_50</span><span class=\"o\">-</span><span class=\"mi\">15</span><span class=\"p\">),</span>\n                <span class=\"n\">arrowprops</span><span class=\"o\">=</span><span class=\"nb\">dict</span><span class=\"p\">(</span><span class=\"n\">arrowstyle</span><span class=\"o\">=</span><span class=\"s1\">&#39;-&gt;&#39;</span><span class=\"p\">,</span> <span class=\"n\">color</span><span class=\"o\">=</span><span class=\"s1\">&#39;green&#39;</span><span class=\"p\">,</span> <span class=\"n\">lw</span><span class=\"o\">=</span><span class=\"mi\">2</span><span class=\"p\">),</span>\n                <span class=\"n\">fontsize</span><span class=\"o\">=</span><span class=\"mi\">10</span><span class=\"p\">,</span> <span class=\"n\">bbox</span><span class=\"o\">=</span><span class=\"nb\">dict</span><span class=\"p\">(</span><span class=\"n\">boxstyle</span><span class=\"o\">=</span><span class=\"s1\">&#39;round&#39;</span><span class=\"p\">,</span> <span class=\"n\">facecolor</span><span class=\"o\">=</span><span class=\"s1\">&#39;lightgreen&#39;</span><span class=\"p\">,</span> <span class=\"n\">alpha</span><span class=\"o\">=</span><span class=\"mf\">0.7</span><span class=\"p\">))</span>\n\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">set_xlabel</span><span class=\"p\">(</span><span class=\"s1\">&#39;Percentuale della Popolazione (%)&#39;</span><span class=\"p\">,</span> <span class=\"n\">fontsize</span><span class=\"o\">=</span><span class=\"mi\">12</span><span class=\"p\">)</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">set_ylabel</span><span class=\"p\">(</span><span class=\"s1\">&#39;Guadagno Cumulativo (%)&#39;</span><span class=\"p\">,</span> <span class=\"n\">fontsize</span><span class=\"o\">=</span><span class=\"mi\">12</span><span class=\"p\">)</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">set_title</span><span class=\"p\">(</span><span class=\"s1\">&#39;Cumulative Gain Chart&#39;</span><span class=\"p\">,</span> <span class=\"n\">fontsize</span><span class=\"o\">=</span><span class=\"mi\">14</span><span class=\"p\">,</span> <span class=\"n\">fontweight</span><span class=\"o\">=</span><span class=\"s1\">&#39;bold&#39;</span><span class=\"p\">)</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">legend</span><span class=\"p\">()</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">grid</span><span class=\"p\">(</span><span class=\"n\">alpha</span><span class=\"o\">=</span><span class=\"mf\">0.3</span><span class=\"p\">)</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">set_xlim</span><span class=\"p\">([</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"mi\">100</span><span class=\"p\">])</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">set_ylim</span><span class=\"p\">([</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"mi\">105</span><span class=\"p\">])</span>\n\n<span class=\"c1\"># Gain per decile</span>\n<span class=\"n\">n_deciles</span> <span class=\"o\">=</span> <span class=\"mi\">10</span>\n<span class=\"n\">decile_gains</span> <span class=\"o\">=</span> <span class=\"p\">[]</span>\n<span class=\"k\">for</span> <span class=\"n\">i</span> <span class=\"ow\">in</span> <span class=\"nb\">range</span><span class=\"p\">(</span><span class=\"n\">n_deciles</span><span class=\"p\">):</span>\n    <span class=\"n\">start</span> <span class=\"o\">=</span> <span class=\"nb\">int</span><span class=\"p\">(</span><span class=\"n\">i</span> <span class=\"o\">*</span> <span class=\"nb\">len</span><span class=\"p\">(</span><span class=\"n\">y_sorted</span><span class=\"p\">)</span> <span class=\"o\">/</span> <span class=\"n\">n_deciles</span><span class=\"p\">)</span>\n    <span class=\"n\">end</span> <span class=\"o\">=</span> <span class=\"nb\">int</span><span class=\"p\">((</span><span class=\"n\">i</span> <span class=\"o\">+</span> <span class=\"mi\">1</span><span class=\"p\">)</span> <span class=\"o\">*</span> <span class=\"nb\">len</span><span class=\"p\">(</span><span class=\"n\">y_sorted</span><span class=\"p\">)</span> <span class=\"o\">/</span> <span class=\"n\">n_deciles</span><span class=\"p\">)</span>\n    <span class=\"k\">if</span> <span class=\"n\">i</span> <span class=\"o\">==</span> <span class=\"mi\">0</span><span class=\"p\">:</span>\n        <span class=\"n\">gain</span> <span class=\"o\">=</span> <span class=\"n\">cumulative_gains</span><span class=\"p\">[</span><span class=\"n\">end</span><span class=\"o\">-</span><span class=\"mi\">1</span><span class=\"p\">]</span>\n    <span class=\"k\">else</span><span class=\"p\">:</span>\n        <span class=\"n\">gain</span> <span class=\"o\">=</span> <span class=\"n\">cumulative_gains</span><span class=\"p\">[</span><span class=\"n\">end</span><span class=\"o\">-</span><span class=\"mi\">1</span><span class=\"p\">]</span> <span class=\"o\">-</span> <span class=\"n\">cumulative_gains</span><span class=\"p\">[</span><span class=\"n\">start</span><span class=\"o\">-</span><span class=\"mi\">1</span><span class=\"p\">]</span>\n    <span class=\"n\">decile_gains</span><span class=\"o\">.</span><span class=\"n\">append</span><span class=\"p\">(</span><span class=\"n\">gain</span> <span class=\"o\">*</span> <span class=\"mi\">100</span><span class=\"p\">)</span>\n\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">bar</span><span class=\"p\">(</span><span class=\"nb\">range</span><span class=\"p\">(</span><span class=\"mi\">1</span><span class=\"p\">,</span> <span class=\"n\">n_deciles</span> <span class=\"o\">+</span> <span class=\"mi\">1</span><span class=\"p\">),</span> <span class=\"n\">decile_gains</span><span class=\"p\">,</span> <span class=\"n\">color</span><span class=\"o\">=</span><span class=\"s1\">&#39;steelblue&#39;</span><span class=\"p\">,</span> \n           <span class=\"n\">alpha</span><span class=\"o\">=</span><span class=\"mf\">0.7</span><span class=\"p\">,</span> <span class=\"n\">edgecolor</span><span class=\"o\">=</span><span class=\"s1\">&#39;black&#39;</span><span class=\"p\">,</span> <span class=\"n\">linewidth</span><span class=\"o\">=</span><span class=\"mi\">2</span><span class=\"p\">)</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">axhline</span><span class=\"p\">(</span><span class=\"mi\">10</span><span class=\"p\">,</span> <span class=\"n\">color</span><span class=\"o\">=</span><span class=\"s1\">&#39;red&#39;</span><span class=\"p\">,</span> <span class=\"n\">linestyle</span><span class=\"o\">=</span><span class=\"s1\">&#39;--&#39;</span><span class=\"p\">,</span> <span class=\"n\">linewidth</span><span class=\"o\">=</span><span class=\"mi\">2</span><span class=\"p\">,</span> <span class=\"n\">label</span><span class=\"o\">=</span><span class=\"s1\">&#39;Random (10% per decile)&#39;</span><span class=\"p\">)</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">set_xlabel</span><span class=\"p\">(</span><span class=\"s1\">&#39;Decile&#39;</span><span class=\"p\">,</span> <span class=\"n\">fontsize</span><span class=\"o\">=</span><span class=\"mi\">12</span><span class=\"p\">)</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">set_ylabel</span><span class=\"p\">(</span><span class=\"s1\">&#39;Gain (%)&#39;</span><span class=\"p\">,</span> <span class=\"n\">fontsize</span><span class=\"o\">=</span><span class=\"mi\">12</span><span class=\"p\">)</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">set_title</span><span class=\"p\">(</span><span class=\"s1\">&#39;Gain per Decile&#39;</span><span class=\"p\">,</span> <span class=\"n\">fontsize</span><span class=\"o\">=</span><span class=\"mi\">14</span><span class=\"p\">,</span> <span class=\"n\">fontweight</span><span class=\"o\">=</span><span class=\"s1\">&#39;bold&#39;</span><span class=\"p\">)</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">legend</span><span class=\"p\">()</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">grid</span><span class=\"p\">(</span><span class=\"n\">axis</span><span class=\"o\">=</span><span class=\"s1\">&#39;y&#39;</span><span class=\"p\">,</span> <span class=\"n\">alpha</span><span class=\"o\">=</span><span class=\"mf\">0.3</span><span class=\"p\">)</span>\n\n<span class=\"k\">for</span> <span class=\"n\">i</span><span class=\"p\">,</span> <span class=\"n\">gain</span> <span class=\"ow\">in</span> <span class=\"nb\">enumerate</span><span class=\"p\">(</span><span class=\"n\">decile_gains</span><span class=\"p\">):</span>\n    <span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">text</span><span class=\"p\">(</span><span class=\"n\">i</span><span class=\"o\">+</span><span class=\"mi\">1</span><span class=\"p\">,</span> <span class=\"n\">gain</span> <span class=\"o\">+</span> <span class=\"mf\">0.5</span><span class=\"p\">,</span> <span class=\"sa\">f</span><span class=\"s1\">&#39;</span><span class=\"si\">{</span><span class=\"n\">gain</span><span class=\"si\">:</span><span class=\"s1\">.1f</span><span class=\"si\">}</span><span class=\"s1\">%&#39;</span><span class=\"p\">,</span> <span class=\"n\">ha</span><span class=\"o\">=</span><span class=\"s1\">&#39;center&#39;</span><span class=\"p\">,</span> <span class=\"n\">fontsize</span><span class=\"o\">=</span><span class=\"mi\">9</span><span class=\"p\">,</span> <span class=\"n\">fontweight</span><span class=\"o\">=</span><span class=\"s1\">&#39;bold&#39;</span><span class=\"p\">)</span>\n\n<span class=\"n\">plt</span><span class=\"o\">.</span><span class=\"n\">tight_layout</span><span class=\"p\">()</span>\n<span class=\"n\">plt</span><span class=\"o\">.</span><span class=\"n\">show</span><span class=\"p\">()</span>\n\n<span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"sa\">f</span><span class=\"s2\">&quot;</span><span class=\"se\">\\n</span><span class=\"s2\">Con il 20% della popolazione catturiamo </span><span class=\"si\">{</span><span class=\"n\">gain_20</span><span class=\"si\">:</span><span class=\"s2\">.1f</span><span class=\"si\">}</span><span class=\"s2\">% dei target&quot;</span><span class=\"p\">)</span>\n<span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"sa\">f</span><span class=\"s2\">&quot;Con il 50% della popolazione catturiamo </span><span class=\"si\">{</span><span class=\"n\">gain_50</span><span class=\"si\">:</span><span class=\"s2\">.1f</span><span class=\"si\">}</span><span class=\"s2\">% dei target&quot;</span><span class=\"p\">)</span>\n</code></pre></div>\n</div>\n</details>\n\n<h3 id=\"142-lift-chart\">14.2 Lift Chart</h3>\n<p>Il <strong>Lift</strong> misura quante volte il modello è migliore di una selezione casuale:</p>\n<p>$\\text{Lift} = \\frac{\\text{Precision at depth}}{\\text{Overall prevalence}} = \\frac{\\text{Tasso di successo nel segmento}}{\\text{Tasso di successo globale}}$</p>\n<details class=\"code-container\">\n<summary>Code</summary>\n<div class=\"code-wrapper\">\n<button class=\"copy-button\" onclick=\"\n                const code = this.parentElement.querySelector('pre');\n                if (code) {\n                    navigator.clipboard.writeText(code.innerText);\n                    this.textContent = 'Copied!';\n                    setTimeout(() => this.textContent = 'Copy', 2000);\n                }\n            \">Copy</button>\n<div class=\"codehilite\"><pre><span></span><code><span class=\"n\">n_deciles</span> <span class=\"o\">=</span> <span class=\"mi\">10</span>\n<span class=\"n\">decile_size</span> <span class=\"o\">=</span> <span class=\"nb\">len</span><span class=\"p\">(</span><span class=\"n\">y_sorted</span><span class=\"p\">)</span> <span class=\"o\">//</span> <span class=\"n\">n_deciles</span>\n<span class=\"n\">lifts</span> <span class=\"o\">=</span> <span class=\"p\">[]</span>\n<span class=\"n\">precisions_decile</span> <span class=\"o\">=</span> <span class=\"p\">[]</span>\n<span class=\"n\">baseline</span> <span class=\"o\">=</span> <span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">mean</span><span class=\"p\">(</span><span class=\"n\">y_sorted</span><span class=\"p\">)</span>\n\n<span class=\"k\">for</span> <span class=\"n\">i</span> <span class=\"ow\">in</span> <span class=\"nb\">range</span><span class=\"p\">(</span><span class=\"n\">n_deciles</span><span class=\"p\">):</span>\n    <span class=\"n\">start_idx</span> <span class=\"o\">=</span> <span class=\"n\">i</span> <span class=\"o\">*</span> <span class=\"n\">decile_size</span>\n    <span class=\"n\">end_idx</span> <span class=\"o\">=</span> <span class=\"p\">(</span><span class=\"n\">i</span> <span class=\"o\">+</span> <span class=\"mi\">1</span><span class=\"p\">)</span> <span class=\"o\">*</span> <span class=\"n\">decile_size</span> <span class=\"k\">if</span> <span class=\"n\">i</span> <span class=\"o\">&lt;</span> <span class=\"n\">n_deciles</span> <span class=\"o\">-</span> <span class=\"mi\">1</span> <span class=\"k\">else</span> <span class=\"nb\">len</span><span class=\"p\">(</span><span class=\"n\">y_sorted</span><span class=\"p\">)</span>\n    <span class=\"n\">decile_precision</span> <span class=\"o\">=</span> <span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">sum</span><span class=\"p\">(</span><span class=\"n\">y_sorted</span><span class=\"p\">[</span><span class=\"n\">start_idx</span><span class=\"p\">:</span><span class=\"n\">end_idx</span><span class=\"p\">])</span> <span class=\"o\">/</span> <span class=\"p\">(</span><span class=\"n\">end_idx</span> <span class=\"o\">-</span> <span class=\"n\">start_idx</span><span class=\"p\">)</span>\n    <span class=\"n\">precisions_decile</span><span class=\"o\">.</span><span class=\"n\">append</span><span class=\"p\">(</span><span class=\"n\">decile_precision</span> <span class=\"o\">*</span> <span class=\"mi\">100</span><span class=\"p\">)</span>\n    <span class=\"n\">lift</span> <span class=\"o\">=</span> <span class=\"n\">decile_precision</span> <span class=\"o\">/</span> <span class=\"n\">baseline</span> <span class=\"k\">if</span> <span class=\"n\">baseline</span> <span class=\"o\">&gt;</span> <span class=\"mi\">0</span> <span class=\"k\">else</span> <span class=\"mi\">0</span>\n    <span class=\"n\">lifts</span><span class=\"o\">.</span><span class=\"n\">append</span><span class=\"p\">(</span><span class=\"n\">lift</span><span class=\"p\">)</span>\n\n<span class=\"n\">fig</span><span class=\"p\">,</span> <span class=\"n\">axes</span> <span class=\"o\">=</span> <span class=\"n\">plt</span><span class=\"o\">.</span><span class=\"n\">subplots</span><span class=\"p\">(</span><span class=\"mi\">1</span><span class=\"p\">,</span> <span class=\"mi\">2</span><span class=\"p\">,</span> <span class=\"n\">figsize</span><span class=\"o\">=</span><span class=\"p\">(</span><span class=\"mi\">15</span><span class=\"p\">,</span> <span class=\"mi\">6</span><span class=\"p\">))</span>\n\n<span class=\"c1\"># Lift Chart</span>\n<span class=\"n\">bars</span> <span class=\"o\">=</span> <span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">bar</span><span class=\"p\">(</span><span class=\"nb\">range</span><span class=\"p\">(</span><span class=\"mi\">1</span><span class=\"p\">,</span> <span class=\"n\">n_deciles</span> <span class=\"o\">+</span> <span class=\"mi\">1</span><span class=\"p\">),</span> <span class=\"n\">lifts</span><span class=\"p\">,</span> <span class=\"n\">color</span><span class=\"o\">=</span><span class=\"s1\">&#39;teal&#39;</span><span class=\"p\">,</span> \n                   <span class=\"n\">alpha</span><span class=\"o\">=</span><span class=\"mf\">0.7</span><span class=\"p\">,</span> <span class=\"n\">edgecolor</span><span class=\"o\">=</span><span class=\"s1\">&#39;black&#39;</span><span class=\"p\">,</span> <span class=\"n\">linewidth</span><span class=\"o\">=</span><span class=\"mi\">2</span><span class=\"p\">)</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">axhline</span><span class=\"p\">(</span><span class=\"n\">y</span><span class=\"o\">=</span><span class=\"mi\">1</span><span class=\"p\">,</span> <span class=\"n\">color</span><span class=\"o\">=</span><span class=\"s1\">&#39;red&#39;</span><span class=\"p\">,</span> <span class=\"n\">linestyle</span><span class=\"o\">=</span><span class=\"s1\">&#39;--&#39;</span><span class=\"p\">,</span> <span class=\"n\">linewidth</span><span class=\"o\">=</span><span class=\"mi\">2</span><span class=\"p\">,</span> <span class=\"n\">label</span><span class=\"o\">=</span><span class=\"s1\">&#39;Baseline (Lift=1)&#39;</span><span class=\"p\">)</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">set_xlabel</span><span class=\"p\">(</span><span class=\"s1\">&#39;Decile&#39;</span><span class=\"p\">,</span> <span class=\"n\">fontsize</span><span class=\"o\">=</span><span class=\"mi\">12</span><span class=\"p\">)</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">set_ylabel</span><span class=\"p\">(</span><span class=\"s1\">&#39;Lift&#39;</span><span class=\"p\">,</span> <span class=\"n\">fontsize</span><span class=\"o\">=</span><span class=\"mi\">12</span><span class=\"p\">)</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">set_title</span><span class=\"p\">(</span><span class=\"s1\">&#39;Lift Chart per Decile&#39;</span><span class=\"p\">,</span> <span class=\"n\">fontsize</span><span class=\"o\">=</span><span class=\"mi\">14</span><span class=\"p\">,</span> <span class=\"n\">fontweight</span><span class=\"o\">=</span><span class=\"s1\">&#39;bold&#39;</span><span class=\"p\">)</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">legend</span><span class=\"p\">()</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">grid</span><span class=\"p\">(</span><span class=\"n\">axis</span><span class=\"o\">=</span><span class=\"s1\">&#39;y&#39;</span><span class=\"p\">,</span> <span class=\"n\">alpha</span><span class=\"o\">=</span><span class=\"mf\">0.3</span><span class=\"p\">)</span>\n\n<span class=\"k\">for</span> <span class=\"n\">bar</span><span class=\"p\">,</span> <span class=\"n\">lift</span> <span class=\"ow\">in</span> <span class=\"nb\">zip</span><span class=\"p\">(</span><span class=\"n\">bars</span><span class=\"p\">,</span> <span class=\"n\">lifts</span><span class=\"p\">):</span>\n    <span class=\"n\">height</span> <span class=\"o\">=</span> <span class=\"n\">bar</span><span class=\"o\">.</span><span class=\"n\">get_height</span><span class=\"p\">()</span>\n    <span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">text</span><span class=\"p\">(</span><span class=\"n\">bar</span><span class=\"o\">.</span><span class=\"n\">get_x</span><span class=\"p\">()</span> <span class=\"o\">+</span> <span class=\"n\">bar</span><span class=\"o\">.</span><span class=\"n\">get_width</span><span class=\"p\">()</span><span class=\"o\">/</span><span class=\"mi\">2</span><span class=\"p\">,</span> <span class=\"n\">height</span> <span class=\"o\">+</span> <span class=\"mf\">0.05</span><span class=\"p\">,</span>\n                <span class=\"sa\">f</span><span class=\"s1\">&#39;</span><span class=\"si\">{</span><span class=\"n\">lift</span><span class=\"si\">:</span><span class=\"s1\">.2f</span><span class=\"si\">}</span><span class=\"s1\">x&#39;</span><span class=\"p\">,</span> <span class=\"n\">ha</span><span class=\"o\">=</span><span class=\"s1\">&#39;center&#39;</span><span class=\"p\">,</span> <span class=\"n\">fontsize</span><span class=\"o\">=</span><span class=\"mi\">10</span><span class=\"p\">,</span> <span class=\"n\">fontweight</span><span class=\"o\">=</span><span class=\"s1\">&#39;bold&#39;</span><span class=\"p\">)</span>\n\n<span class=\"c1\"># Interpretazione Lift</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">axis</span><span class=\"p\">(</span><span class=\"s1\">&#39;off&#39;</span><span class=\"p\">)</span>\n<span class=\"n\">lift_interpretation</span> <span class=\"o\">=</span> <span class=\"sa\">f</span><span class=\"s2\">&quot;&quot;&quot;</span>\n<span class=\"s2\">INTERPRETAZIONE LIFT</span>\n\n<span class=\"s2\">Baseline (prevalenza): </span><span class=\"si\">{</span><span class=\"n\">baseline</span><span class=\"o\">*</span><span class=\"mi\">100</span><span class=\"si\">:</span><span class=\"s2\">.2f</span><span class=\"si\">}</span><span class=\"s2\">%</span>\n\n<span class=\"s2\">Top Decile (primi 10%):</span>\n<span class=\"s2\">  • Precision: </span><span class=\"si\">{</span><span class=\"n\">precisions_decile</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">]</span><span class=\"si\">:</span><span class=\"s2\">.1f</span><span class=\"si\">}</span><span class=\"s2\">%</span>\n<span class=\"s2\">  • Lift: </span><span class=\"si\">{</span><span class=\"n\">lifts</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">]</span><span class=\"si\">:</span><span class=\"s2\">.2f</span><span class=\"si\">}</span><span class=\"s2\">x</span>\n<span class=\"s2\">  • Interpretazione: </span><span class=\"si\">{</span><span class=\"n\">lifts</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">]</span><span class=\"si\">:</span><span class=\"s2\">.1f</span><span class=\"si\">}</span><span class=\"s2\"> volte meglio</span>\n<span class=\"s2\">    del caso casuale</span>\n\n<span class=\"s2\">Lift = 1.0: Come selezione casuale</span>\n<span class=\"s2\">Lift &gt; 1.0: Meglio del caso</span>\n<span class=\"s2\">Lift &lt; 1.0: Peggio del caso</span>\n\n<span class=\"s2\">APPLICAZIONI PRATICHE:</span>\n\n<span class=\"s2\">Marketing Campaigns:</span>\n<span class=\"s2\">  Lift = 3.0 al top decile significa:</span>\n<span class=\"s2\">  • Contattando 10% clienti selezionati</span>\n<span class=\"s2\">  • Otteniamo 3x più conversioni</span>\n<span class=\"s2\">  • Rispetto a selezione casuale</span>\n\n<span class=\"s2\">Fraud Detection:</span>\n<span class=\"s2\">  Lift = 5.0 significa:</span>\n<span class=\"s2\">  • Top 10% transazioni sospette</span>\n<span class=\"s2\">  • Contiene 5x più frodi</span>\n<span class=\"s2\">  • Rispetto alla media</span>\n\n<span class=\"s2\">STRATEGIA:</span>\n<span class=\"s2\">✓ Focus sui decili con Lift &gt; 2</span>\n<span class=\"s2\">✓ Ignora decili con Lift &lt; 1</span>\n<span class=\"s2\">✓ Ottimizza risorse su high-lift</span>\n<span class=\"s2\">&quot;&quot;&quot;</span>\n\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">text</span><span class=\"p\">(</span><span class=\"mf\">0.05</span><span class=\"p\">,</span> <span class=\"mf\">0.95</span><span class=\"p\">,</span> <span class=\"n\">lift_interpretation</span><span class=\"p\">,</span> <span class=\"n\">fontsize</span><span class=\"o\">=</span><span class=\"mi\">9</span><span class=\"p\">,</span> <span class=\"n\">verticalalignment</span><span class=\"o\">=</span><span class=\"s1\">&#39;top&#39;</span><span class=\"p\">,</span>\n            <span class=\"n\">family</span><span class=\"o\">=</span><span class=\"s1\">&#39;monospace&#39;</span><span class=\"p\">,</span>\n            <span class=\"n\">bbox</span><span class=\"o\">=</span><span class=\"nb\">dict</span><span class=\"p\">(</span><span class=\"n\">boxstyle</span><span class=\"o\">=</span><span class=\"s1\">&#39;round&#39;</span><span class=\"p\">,</span> <span class=\"n\">facecolor</span><span class=\"o\">=</span><span class=\"s1\">&#39;lightcyan&#39;</span><span class=\"p\">,</span> <span class=\"n\">alpha</span><span class=\"o\">=</span><span class=\"mf\">0.8</span><span class=\"p\">))</span>\n\n<span class=\"n\">plt</span><span class=\"o\">.</span><span class=\"n\">tight_layout</span><span class=\"p\">()</span>\n<span class=\"n\">plt</span><span class=\"o\">.</span><span class=\"n\">show</span><span class=\"p\">()</span>\n\n<span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"s2\">&quot;</span><span class=\"se\">\\n</span><span class=\"s2\">Lift per Decile:&quot;</span><span class=\"p\">)</span>\n<span class=\"k\">for</span> <span class=\"n\">i</span><span class=\"p\">,</span> <span class=\"p\">(</span><span class=\"n\">lift</span><span class=\"p\">,</span> <span class=\"n\">prec</span><span class=\"p\">)</span> <span class=\"ow\">in</span> <span class=\"nb\">enumerate</span><span class=\"p\">(</span><span class=\"nb\">zip</span><span class=\"p\">(</span><span class=\"n\">lifts</span><span class=\"p\">,</span> <span class=\"n\">precisions_decile</span><span class=\"p\">),</span> <span class=\"mi\">1</span><span class=\"p\">):</span>\n    <span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"sa\">f</span><span class=\"s2\">&quot;  Decile </span><span class=\"si\">{</span><span class=\"n\">i</span><span class=\"si\">}</span><span class=\"s2\">: Lift=</span><span class=\"si\">{</span><span class=\"n\">lift</span><span class=\"si\">:</span><span class=\"s2\">.3f</span><span class=\"si\">}</span><span class=\"s2\">, Precision=</span><span class=\"si\">{</span><span class=\"n\">prec</span><span class=\"si\">:</span><span class=\"s2\">.1f</span><span class=\"si\">}</span><span class=\"s2\">%&quot;</span><span class=\"p\">)</span>\n</code></pre></div>\n</div>\n</details>\n\n<h2 id=\"15-cross-validation-e-stabilita-delle-metriche\">15. Cross-Validation e Stabilità delle Metriche</h2>\n<p>Valutazione robusta attraverso k-fold cross-validation:</p>\n<details class=\"code-container\">\n<summary>Code</summary>\n<div class=\"code-wrapper\">\n<button class=\"copy-button\" onclick=\"\n                const code = this.parentElement.querySelector('pre');\n                if (code) {\n                    navigator.clipboard.writeText(code.innerText);\n                    this.textContent = 'Copied!';\n                    setTimeout(() => this.textContent = 'Copy', 2000);\n                }\n            \">Copy</button>\n<div class=\"codehilite\"><pre><span></span><code><span class=\"kn\">from</span><span class=\"w\"> </span><span class=\"nn\">sklearn.model_selection</span><span class=\"w\"> </span><span class=\"kn\">import</span> <span class=\"n\">cross_val_score</span><span class=\"p\">,</span> <span class=\"n\">cross_validate</span>\n\n<span class=\"n\">scoring</span> <span class=\"o\">=</span> <span class=\"p\">[</span><span class=\"s1\">&#39;accuracy&#39;</span><span class=\"p\">,</span> <span class=\"s1\">&#39;precision&#39;</span><span class=\"p\">,</span> <span class=\"s1\">&#39;recall&#39;</span><span class=\"p\">,</span> <span class=\"s1\">&#39;f1&#39;</span><span class=\"p\">,</span> <span class=\"s1\">&#39;roc_auc&#39;</span><span class=\"p\">]</span>\n<span class=\"n\">cv_results</span> <span class=\"o\">=</span> <span class=\"n\">cross_validate</span><span class=\"p\">(</span><span class=\"n\">clf</span><span class=\"p\">,</span> <span class=\"n\">X</span><span class=\"p\">,</span> <span class=\"n\">y</span><span class=\"p\">,</span> <span class=\"n\">cv</span><span class=\"o\">=</span><span class=\"mi\">5</span><span class=\"p\">,</span> <span class=\"n\">scoring</span><span class=\"o\">=</span><span class=\"n\">scoring</span><span class=\"p\">,</span> \n                            <span class=\"n\">return_train_score</span><span class=\"o\">=</span><span class=\"kc\">False</span><span class=\"p\">)</span>\n\n<span class=\"n\">fig</span><span class=\"p\">,</span> <span class=\"n\">axes</span> <span class=\"o\">=</span> <span class=\"n\">plt</span><span class=\"o\">.</span><span class=\"n\">subplots</span><span class=\"p\">(</span><span class=\"mi\">1</span><span class=\"p\">,</span> <span class=\"mi\">2</span><span class=\"p\">,</span> <span class=\"n\">figsize</span><span class=\"o\">=</span><span class=\"p\">(</span><span class=\"mi\">15</span><span class=\"p\">,</span> <span class=\"mi\">6</span><span class=\"p\">))</span>\n\n<span class=\"c1\"># Box plot delle metriche</span>\n<span class=\"n\">metrics_cv_data</span> <span class=\"o\">=</span> <span class=\"p\">[</span><span class=\"n\">cv_results</span><span class=\"p\">[</span><span class=\"sa\">f</span><span class=\"s1\">&#39;test_</span><span class=\"si\">{</span><span class=\"n\">metric</span><span class=\"si\">}</span><span class=\"s1\">&#39;</span><span class=\"p\">]</span> <span class=\"k\">for</span> <span class=\"n\">metric</span> <span class=\"ow\">in</span> <span class=\"n\">scoring</span><span class=\"p\">]</span>\n<span class=\"n\">bp</span> <span class=\"o\">=</span> <span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">boxplot</span><span class=\"p\">(</span><span class=\"n\">metrics_cv_data</span><span class=\"p\">,</span> <span class=\"n\">labels</span><span class=\"o\">=</span><span class=\"p\">[</span><span class=\"n\">s</span><span class=\"o\">.</span><span class=\"n\">upper</span><span class=\"p\">()</span> <span class=\"k\">for</span> <span class=\"n\">s</span> <span class=\"ow\">in</span> <span class=\"n\">scoring</span><span class=\"p\">],</span>\n                     <span class=\"n\">patch_artist</span><span class=\"o\">=</span><span class=\"kc\">True</span><span class=\"p\">,</span> <span class=\"n\">showmeans</span><span class=\"o\">=</span><span class=\"kc\">True</span><span class=\"p\">)</span>\n\n<span class=\"k\">for</span> <span class=\"n\">patch</span><span class=\"p\">,</span> <span class=\"n\">color</span> <span class=\"ow\">in</span> <span class=\"nb\">zip</span><span class=\"p\">(</span><span class=\"n\">bp</span><span class=\"p\">[</span><span class=\"s1\">&#39;boxes&#39;</span><span class=\"p\">],</span> <span class=\"p\">[</span><span class=\"s1\">&#39;red&#39;</span><span class=\"p\">,</span> <span class=\"s1\">&#39;blue&#39;</span><span class=\"p\">,</span> <span class=\"s1\">&#39;green&#39;</span><span class=\"p\">,</span> <span class=\"s1\">&#39;purple&#39;</span><span class=\"p\">,</span> <span class=\"s1\">&#39;orange&#39;</span><span class=\"p\">]):</span>\n    <span class=\"n\">patch</span><span class=\"o\">.</span><span class=\"n\">set_facecolor</span><span class=\"p\">(</span><span class=\"n\">color</span><span class=\"p\">)</span>\n    <span class=\"n\">patch</span><span class=\"o\">.</span><span class=\"n\">set_alpha</span><span class=\"p\">(</span><span class=\"mf\">0.5</span><span class=\"p\">)</span>\n\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">set_ylabel</span><span class=\"p\">(</span><span class=\"s1\">&#39;Score&#39;</span><span class=\"p\">,</span> <span class=\"n\">fontsize</span><span class=\"o\">=</span><span class=\"mi\">12</span><span class=\"p\">)</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">set_title</span><span class=\"p\">(</span><span class=\"s1\">&#39;Stabilità Metriche (5-Fold CV)&#39;</span><span class=\"p\">,</span> <span class=\"n\">fontsize</span><span class=\"o\">=</span><span class=\"mi\">14</span><span class=\"p\">,</span> <span class=\"n\">fontweight</span><span class=\"o\">=</span><span class=\"s1\">&#39;bold&#39;</span><span class=\"p\">)</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">grid</span><span class=\"p\">(</span><span class=\"n\">axis</span><span class=\"o\">=</span><span class=\"s1\">&#39;y&#39;</span><span class=\"p\">,</span> <span class=\"n\">alpha</span><span class=\"o\">=</span><span class=\"mf\">0.3</span><span class=\"p\">)</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">set_ylim</span><span class=\"p\">([</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"mf\">1.05</span><span class=\"p\">])</span>\n\n<span class=\"c1\"># Media e deviazione standard</span>\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">axis</span><span class=\"p\">(</span><span class=\"s1\">&#39;off&#39;</span><span class=\"p\">)</span>\n<span class=\"n\">cv_summary</span> <span class=\"o\">=</span> <span class=\"s2\">&quot;RISULTATI CROSS-VALIDATION (5-Fold)</span><span class=\"se\">\\n</span><span class=\"s2\">&quot;</span> <span class=\"o\">+</span> <span class=\"s2\">&quot;=&quot;</span><span class=\"o\">*</span><span class=\"mi\">50</span> <span class=\"o\">+</span> <span class=\"s2\">&quot;</span><span class=\"se\">\\n\\n</span><span class=\"s2\">&quot;</span>\n\n<span class=\"k\">for</span> <span class=\"n\">metric</span> <span class=\"ow\">in</span> <span class=\"n\">scoring</span><span class=\"p\">:</span>\n    <span class=\"n\">scores</span> <span class=\"o\">=</span> <span class=\"n\">cv_results</span><span class=\"p\">[</span><span class=\"sa\">f</span><span class=\"s1\">&#39;test_</span><span class=\"si\">{</span><span class=\"n\">metric</span><span class=\"si\">}</span><span class=\"s1\">&#39;</span><span class=\"p\">]</span>\n    <span class=\"n\">cv_summary</span> <span class=\"o\">+=</span> <span class=\"sa\">f</span><span class=\"s2\">&quot;</span><span class=\"si\">{</span><span class=\"n\">metric</span><span class=\"o\">.</span><span class=\"n\">upper</span><span class=\"p\">()</span><span class=\"si\">:</span><span class=\"s2\">12s</span><span class=\"si\">}</span><span class=\"s2\">: &quot;</span>\n    <span class=\"n\">cv_summary</span> <span class=\"o\">+=</span> <span class=\"sa\">f</span><span class=\"s2\">&quot;</span><span class=\"si\">{</span><span class=\"n\">scores</span><span class=\"o\">.</span><span class=\"n\">mean</span><span class=\"p\">()</span><span class=\"si\">:</span><span class=\"s2\">.4f</span><span class=\"si\">}</span><span class=\"s2\"> (±</span><span class=\"si\">{</span><span class=\"n\">scores</span><span class=\"o\">.</span><span class=\"n\">std</span><span class=\"p\">()</span><span class=\"w\"> </span><span class=\"o\">*</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"si\">:</span><span class=\"s2\">.4f</span><span class=\"si\">}</span><span class=\"s2\">)</span><span class=\"se\">\\n</span><span class=\"s2\">&quot;</span>\n    <span class=\"n\">cv_summary</span> <span class=\"o\">+=</span> <span class=\"sa\">f</span><span class=\"s2\">&quot;</span><span class=\"si\">{</span><span class=\"s1\">&#39;&#39;</span><span class=\"si\">:</span><span class=\"s2\">12s</span><span class=\"si\">}</span><span class=\"s2\">  Min: </span><span class=\"si\">{</span><span class=\"n\">scores</span><span class=\"o\">.</span><span class=\"n\">min</span><span class=\"p\">()</span><span class=\"si\">:</span><span class=\"s2\">.4f</span><span class=\"si\">}</span><span class=\"s2\">, Max: </span><span class=\"si\">{</span><span class=\"n\">scores</span><span class=\"o\">.</span><span class=\"n\">max</span><span class=\"p\">()</span><span class=\"si\">:</span><span class=\"s2\">.4f</span><span class=\"si\">}</span><span class=\"se\">\\n\\n</span><span class=\"s2\">&quot;</span>\n\n<span class=\"n\">cv_summary</span> <span class=\"o\">+=</span> <span class=\"s2\">&quot;</span><span class=\"se\">\\n</span><span class=\"s2\">INTERPRETAZIONE:</span><span class=\"se\">\\n</span><span class=\"s2\">&quot;</span>\n<span class=\"n\">cv_summary</span> <span class=\"o\">+=</span> <span class=\"s2\">&quot;• Std bassa → Modello stabile</span><span class=\"se\">\\n</span><span class=\"s2\">&quot;</span>\n<span class=\"n\">cv_summary</span> <span class=\"o\">+=</span> <span class=\"s2\">&quot;• Std alta → Sensibile ai dati</span><span class=\"se\">\\n</span><span class=\"s2\">&quot;</span>\n<span class=\"n\">cv_summary</span> <span class=\"o\">+=</span> <span class=\"s2\">&quot;• Intervallo ±2σ copre ~95</span><span class=\"si\">% c</span><span class=\"s2\">asi</span><span class=\"se\">\\n</span><span class=\"s2\">&quot;</span>\n\n<span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">text</span><span class=\"p\">(</span><span class=\"mf\">0.1</span><span class=\"p\">,</span> <span class=\"mf\">0.9</span><span class=\"p\">,</span> <span class=\"n\">cv_summary</span><span class=\"p\">,</span> <span class=\"n\">fontsize</span><span class=\"o\">=</span><span class=\"mi\">10</span><span class=\"p\">,</span> <span class=\"n\">verticalalignment</span><span class=\"o\">=</span><span class=\"s1\">&#39;top&#39;</span><span class=\"p\">,</span>\n            <span class=\"n\">family</span><span class=\"o\">=</span><span class=\"s1\">&#39;monospace&#39;</span><span class=\"p\">,</span>\n            <span class=\"n\">bbox</span><span class=\"o\">=</span><span class=\"nb\">dict</span><span class=\"p\">(</span><span class=\"n\">boxstyle</span><span class=\"o\">=</span><span class=\"s1\">&#39;round&#39;</span><span class=\"p\">,</span> <span class=\"n\">facecolor</span><span class=\"o\">=</span><span class=\"s1\">&#39;wheat&#39;</span><span class=\"p\">,</span> <span class=\"n\">alpha</span><span class=\"o\">=</span><span class=\"mf\">0.7</span><span class=\"p\">))</span>\n\n<span class=\"n\">plt</span><span class=\"o\">.</span><span class=\"n\">tight_layout</span><span class=\"p\">()</span>\n<span class=\"n\">plt</span><span class=\"o\">.</span><span class=\"n\">show</span><span class=\"p\">()</span>\n\n<span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"s2\">&quot;</span><span class=\"se\">\\n</span><span class=\"s2\">Cross-Validation Results (5-fold):&quot;</span><span class=\"p\">)</span>\n<span class=\"k\">for</span> <span class=\"n\">metric</span> <span class=\"ow\">in</span> <span class=\"n\">scoring</span><span class=\"p\">:</span>\n    <span class=\"n\">scores</span> <span class=\"o\">=</span> <span class=\"n\">cv_results</span><span class=\"p\">[</span><span class=\"sa\">f</span><span class=\"s1\">&#39;test_</span><span class=\"si\">{</span><span class=\"n\">metric</span><span class=\"si\">}</span><span class=\"s1\">&#39;</span><span class=\"p\">]</span>\n    <span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"sa\">f</span><span class=\"s2\">&quot;  </span><span class=\"si\">{</span><span class=\"n\">metric</span><span class=\"o\">.</span><span class=\"n\">upper</span><span class=\"p\">()</span><span class=\"si\">:</span><span class=\"s2\">12s</span><span class=\"si\">}</span><span class=\"s2\">: </span><span class=\"si\">{</span><span class=\"n\">scores</span><span class=\"o\">.</span><span class=\"n\">mean</span><span class=\"p\">()</span><span class=\"si\">:</span><span class=\"s2\">.4f</span><span class=\"si\">}</span><span class=\"s2\"> (±</span><span class=\"si\">{</span><span class=\"n\">scores</span><span class=\"o\">.</span><span class=\"n\">std</span><span class=\"p\">()</span><span class=\"w\"> </span><span class=\"o\">*</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"si\">:</span><span class=\"s2\">.4f</span><span class=\"si\">}</span><span class=\"s2\">)&quot;</span><span class=\"p\">)</span>\n</code></pre></div>\n</div>\n</details>\n\n<h2 id=\"16-riepilogo-completo-e-linee-guida\">16. Riepilogo Completo e Linee Guida</h2>\n<h3 id=\"161-tabella-riassuntiva-metriche\">16.1 Tabella Riassuntiva Metriche</h3>\n<details class=\"code-container\">\n<summary>Code</summary>\n<div class=\"code-wrapper\">\n<button class=\"copy-button\" onclick=\"\n                const code = this.parentElement.querySelector('pre');\n                if (code) {\n                    navigator.clipboard.writeText(code.innerText);\n                    this.textContent = 'Copied!';\n                    setTimeout(() => this.textContent = 'Copy', 2000);\n                }\n            \">Copy</button>\n<div class=\"codehilite\"><pre><span></span><code><span class=\"c1\"># Calcolo completo di tutte le metriche</span>\n<span class=\"n\">all_metrics</span> <span class=\"o\">=</span> <span class=\"p\">{</span>\n    <span class=\"s1\">&#39;Metrica&#39;</span><span class=\"p\">:</span> <span class=\"p\">[</span>\n        <span class=\"s1\">&#39;Accuracy&#39;</span><span class=\"p\">,</span> <span class=\"s1\">&#39;Precision&#39;</span><span class=\"p\">,</span> <span class=\"s1\">&#39;Recall/TPR&#39;</span><span class=\"p\">,</span> <span class=\"s1\">&#39;Specificity/TNR&#39;</span><span class=\"p\">,</span>\n        <span class=\"s1\">&#39;F1-Score&#39;</span><span class=\"p\">,</span> <span class=\"s1\">&#39;F2-Score&#39;</span><span class=\"p\">,</span> <span class=\"s1\">&#39;FPR/FAR&#39;</span><span class=\"p\">,</span> <span class=\"s1\">&#39;FNR/FRR&#39;</span><span class=\"p\">,</span>\n        <span class=\"s1\">&#39;MCC&#39;</span><span class=\"p\">,</span> <span class=\"s2\">&quot;Cohen&#39;s Kappa&quot;</span><span class=\"p\">,</span> <span class=\"s1\">&#39;AUC-ROC&#39;</span><span class=\"p\">,</span> <span class=\"s1\">&#39;AUC-PR&#39;</span><span class=\"p\">,</span>\n        <span class=\"s1\">&#39;Log Loss&#39;</span><span class=\"p\">,</span> <span class=\"s1\">&#39;Brier Score&#39;</span>\n    <span class=\"p\">],</span>\n    <span class=\"s1\">&#39;Valore&#39;</span><span class=\"p\">:</span> <span class=\"p\">[</span>\n        <span class=\"n\">accuracy_score</span><span class=\"p\">(</span><span class=\"n\">y_test</span><span class=\"p\">,</span> <span class=\"n\">y_pred</span><span class=\"p\">),</span>\n        <span class=\"n\">precision_score</span><span class=\"p\">(</span><span class=\"n\">y_test</span><span class=\"p\">,</span> <span class=\"n\">y_pred</span><span class=\"p\">),</span>\n        <span class=\"n\">recall_score</span><span class=\"p\">(</span><span class=\"n\">y_test</span><span class=\"p\">,</span> <span class=\"n\">y_pred</span><span class=\"p\">),</span>\n        <span class=\"n\">tn</span> <span class=\"o\">/</span> <span class=\"p\">(</span><span class=\"n\">tn</span> <span class=\"o\">+</span> <span class=\"n\">fp</span><span class=\"p\">),</span>\n        <span class=\"n\">f1_score</span><span class=\"p\">(</span><span class=\"n\">y_test</span><span class=\"p\">,</span> <span class=\"n\">y_pred</span><span class=\"p\">),</span>\n        <span class=\"n\">fbeta_score</span><span class=\"p\">(</span><span class=\"n\">y_test</span><span class=\"p\">,</span> <span class=\"n\">y_pred</span><span class=\"p\">,</span> <span class=\"n\">beta</span><span class=\"o\">=</span><span class=\"mi\">2</span><span class=\"p\">),</span>\n        <span class=\"n\">fp</span> <span class=\"o\">/</span> <span class=\"p\">(</span><span class=\"n\">fp</span> <span class=\"o\">+</span> <span class=\"n\">tn</span><span class=\"p\">),</span>\n        <span class=\"n\">fn</span> <span class=\"o\">/</span> <span class=\"p\">(</span><span class=\"n\">fn</span> <span class=\"o\">+</span> <span class=\"n\">tp</span><span class=\"p\">),</span>\n        <span class=\"n\">matthews_corrcoef</span><span class=\"p\">(</span><span class=\"n\">y_test</span><span class=\"p\">,</span> <span class=\"n\">y_pred</span><span class=\"p\">),</span>\n        <span class=\"n\">cohen_kappa_score</span><span class=\"p\">(</span><span class=\"n\">y_test</span><span class=\"p\">,</span> <span class=\"n\">y_pred</span><span class=\"p\">),</span>\n        <span class=\"n\">roc_auc_score</span><span class=\"p\">(</span><span class=\"n\">y_test</span><span class=\"p\">,</span> <span class=\"n\">y_proba</span><span class=\"p\">),</span>\n        <span class=\"n\">average_precision_score</span><span class=\"p\">(</span><span class=\"n\">y_test</span><span class=\"p\">,</span> <span class=\"n\">y_proba</span><span class=\"p\">),</span>\n        <span class=\"n\">log_loss</span><span class=\"p\">(</span><span class=\"n\">y_test</span><span class=\"p\">,</span> <span class=\"n\">y_proba</span><span class=\"p\">),</span>\n        <span class=\"n\">brier_score_loss</span><span class=\"p\">(</span><span class=\"n\">y_test</span><span class=\"p\">,</span> <span class=\"n\">y_proba</span><span class=\"p\">)</span>\n    <span class=\"p\">],</span>\n    <span class=\"s1\">&#39;Range&#39;</span><span class=\"p\">:</span> <span class=\"p\">[</span>\n        <span class=\"s1\">&#39;[0, 1]&#39;</span><span class=\"p\">,</span> <span class=\"s1\">&#39;[0, 1]&#39;</span><span class=\"p\">,</span> <span class=\"s1\">&#39;[0, 1]&#39;</span><span class=\"p\">,</span> <span class=\"s1\">&#39;[0, 1]&#39;</span><span class=\"p\">,</span>\n        <span class=\"s1\">&#39;[0, 1]&#39;</span><span class=\"p\">,</span> <span class=\"s1\">&#39;[0, 1]&#39;</span><span class=\"p\">,</span> <span class=\"s1\">&#39;[0, 1]&#39;</span><span class=\"p\">,</span> <span class=\"s1\">&#39;[0, 1]&#39;</span><span class=\"p\">,</span>\n        <span class=\"s1\">&#39;[-1, 1]&#39;</span><span class=\"p\">,</span> <span class=\"s1\">&#39;[-1, 1]&#39;</span><span class=\"p\">,</span> <span class=\"s1\">&#39;[0, 1]&#39;</span><span class=\"p\">,</span> <span class=\"s1\">&#39;[0, 1]&#39;</span><span class=\"p\">,</span>\n        <span class=\"s1\">&#39;[0, ∞)&#39;</span><span class=\"p\">,</span> <span class=\"s1\">&#39;[0, 1]&#39;</span>\n    <span class=\"p\">],</span>\n    <span class=\"s1\">&#39;Meglio&#39;</span><span class=\"p\">:</span> <span class=\"p\">[</span>\n        <span class=\"s1\">&#39;↑&#39;</span><span class=\"p\">,</span> <span class=\"s1\">&#39;↑&#39;</span><span class=\"p\">,</span> <span class=\"s1\">&#39;↑&#39;</span><span class=\"p\">,</span> <span class=\"s1\">&#39;↑&#39;</span><span class=\"p\">,</span>\n        <span class=\"s1\">&#39;↑&#39;</span><span class=\"p\">,</span> <span class=\"s1\">&#39;↑&#39;</span><span class=\"p\">,</span> <span class=\"s1\">&#39;↓&#39;</span><span class=\"p\">,</span> <span class=\"s1\">&#39;↓&#39;</span><span class=\"p\">,</span>\n        <span class=\"s1\">&#39;↑&#39;</span><span class=\"p\">,</span> <span class=\"s1\">&#39;↑&#39;</span><span class=\"p\">,</span> <span class=\"s1\">&#39;↑&#39;</span><span class=\"p\">,</span> <span class=\"s1\">&#39;↑&#39;</span><span class=\"p\">,</span>\n        <span class=\"s1\">&#39;↓&#39;</span><span class=\"p\">,</span> <span class=\"s1\">&#39;↓&#39;</span>\n    <span class=\"p\">],</span>\n    <span class=\"s1\">&#39;Categoria&#39;</span><span class=\"p\">:</span> <span class=\"p\">[</span>\n        <span class=\"s1\">&#39;Base&#39;</span><span class=\"p\">,</span> <span class=\"s1\">&#39;Base&#39;</span><span class=\"p\">,</span> <span class=\"s1\">&#39;Base&#39;</span><span class=\"p\">,</span> <span class=\"s1\">&#39;Base&#39;</span><span class=\"p\">,</span>\n        <span class=\"s1\">&#39;Combinata&#39;</span><span class=\"p\">,</span> <span class=\"s1\">&#39;Combinata&#39;</span><span class=\"p\">,</span> <span class=\"s1\">&#39;Errore&#39;</span><span class=\"p\">,</span> <span class=\"s1\">&#39;Errore&#39;</span><span class=\"p\">,</span>\n        <span class=\"s1\">&#39;Avanzata&#39;</span><span class=\"p\">,</span> <span class=\"s1\">&#39;Avanzata&#39;</span><span class=\"p\">,</span> <span class=\"s1\">&#39;Curva&#39;</span><span class=\"p\">,</span> <span class=\"s1\">&#39;Curva&#39;</span><span class=\"p\">,</span>\n        <span class=\"s1\">&#39;Probabilistica&#39;</span><span class=\"p\">,</span> <span class=\"s1\">&#39;Probabilistica&#39;</span>\n    <span class=\"p\">]</span>\n<span class=\"p\">}</span>\n\n<span class=\"n\">df_metrics</span> <span class=\"o\">=</span> <span class=\"n\">pd</span><span class=\"o\">.</span><span class=\"n\">DataFrame</span><span class=\"p\">(</span><span class=\"n\">all_metrics</span><span class=\"p\">)</span>\n<span class=\"n\">df_metrics</span><span class=\"p\">[</span><span class=\"s1\">&#39;Valore&#39;</span><span class=\"p\">]</span> <span class=\"o\">=</span> <span class=\"n\">df_metrics</span><span class=\"p\">[</span><span class=\"s1\">&#39;Valore&#39;</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">round</span><span class=\"p\">(</span><span class=\"mi\">4</span><span class=\"p\">)</span>\n\n<span class=\"n\">fig</span><span class=\"p\">,</span> <span class=\"n\">ax</span> <span class=\"o\">=</span> <span class=\"n\">plt</span><span class=\"o\">.</span><span class=\"n\">subplots</span><span class=\"p\">(</span><span class=\"n\">figsize</span><span class=\"o\">=</span><span class=\"p\">(</span><span class=\"mi\">14</span><span class=\"p\">,</span> <span class=\"mi\">8</span><span class=\"p\">))</span>\n<span class=\"n\">ax</span><span class=\"o\">.</span><span class=\"n\">axis</span><span class=\"p\">(</span><span class=\"s1\">&#39;tight&#39;</span><span class=\"p\">)</span>\n<span class=\"n\">ax</span><span class=\"o\">.</span><span class=\"n\">axis</span><span class=\"p\">(</span><span class=\"s1\">&#39;off&#39;</span><span class=\"p\">)</span>\n\n<span class=\"n\">colors</span> <span class=\"o\">=</span> <span class=\"p\">[]</span>\n<span class=\"k\">for</span> <span class=\"n\">cat</span> <span class=\"ow\">in</span> <span class=\"n\">df_metrics</span><span class=\"p\">[</span><span class=\"s1\">&#39;Categoria&#39;</span><span class=\"p\">]:</span>\n    <span class=\"k\">if</span> <span class=\"n\">cat</span> <span class=\"o\">==</span> <span class=\"s1\">&#39;Base&#39;</span><span class=\"p\">:</span>\n        <span class=\"n\">colors</span><span class=\"o\">.</span><span class=\"n\">append</span><span class=\"p\">(</span><span class=\"s1\">&#39;#e3f2fd&#39;</span><span class=\"p\">)</span>\n    <span class=\"k\">elif</span> <span class=\"n\">cat</span> <span class=\"o\">==</span> <span class=\"s1\">&#39;Combinata&#39;</span><span class=\"p\">:</span>\n        <span class=\"n\">colors</span><span class=\"o\">.</span><span class=\"n\">append</span><span class=\"p\">(</span><span class=\"s1\">&#39;#fff3e0&#39;</span><span class=\"p\">)</span>\n    <span class=\"k\">elif</span> <span class=\"n\">cat</span> <span class=\"o\">==</span> <span class=\"s1\">&#39;Errore&#39;</span><span class=\"p\">:</span>\n        <span class=\"n\">colors</span><span class=\"o\">.</span><span class=\"n\">append</span><span class=\"p\">(</span><span class=\"s1\">&#39;#ffebee&#39;</span><span class=\"p\">)</span>\n    <span class=\"k\">elif</span> <span class=\"n\">cat</span> <span class=\"o\">==</span> <span class=\"s1\">&#39;Avanzata&#39;</span><span class=\"p\">:</span>\n        <span class=\"n\">colors</span><span class=\"o\">.</span><span class=\"n\">append</span><span class=\"p\">(</span><span class=\"s1\">&#39;#f3e5f5&#39;</span><span class=\"p\">)</span>\n    <span class=\"k\">elif</span> <span class=\"n\">cat</span> <span class=\"o\">==</span> <span class=\"s1\">&#39;Curva&#39;</span><span class=\"p\">:</span>\n        <span class=\"n\">colors</span><span class=\"o\">.</span><span class=\"n\">append</span><span class=\"p\">(</span><span class=\"s1\">&#39;#e8f5e9&#39;</span><span class=\"p\">)</span>\n    <span class=\"k\">else</span><span class=\"p\">:</span>\n        <span class=\"n\">colors</span><span class=\"o\">.</span><span class=\"n\">append</span><span class=\"p\">(</span><span class=\"s1\">&#39;#fce4ec&#39;</span><span class=\"p\">)</span>\n\n<span class=\"n\">table</span> <span class=\"o\">=</span> <span class=\"n\">ax</span><span class=\"o\">.</span><span class=\"n\">table</span><span class=\"p\">(</span><span class=\"n\">cellText</span><span class=\"o\">=</span><span class=\"n\">df_metrics</span><span class=\"o\">.</span><span class=\"n\">values</span><span class=\"p\">,</span> <span class=\"n\">colLabels</span><span class=\"o\">=</span><span class=\"n\">df_metrics</span><span class=\"o\">.</span><span class=\"n\">columns</span><span class=\"p\">,</span>\n                <span class=\"n\">cellLoc</span><span class=\"o\">=</span><span class=\"s1\">&#39;center&#39;</span><span class=\"p\">,</span> <span class=\"n\">loc</span><span class=\"o\">=</span><span class=\"s1\">&#39;center&#39;</span><span class=\"p\">,</span>\n                <span class=\"n\">colColours</span><span class=\"o\">=</span><span class=\"p\">[</span><span class=\"s1\">&#39;lightgray&#39;</span><span class=\"p\">]</span><span class=\"o\">*</span><span class=\"mi\">5</span><span class=\"p\">)</span>\n\n<span class=\"n\">table</span><span class=\"o\">.</span><span class=\"n\">auto_set_font_size</span><span class=\"p\">(</span><span class=\"kc\">False</span><span class=\"p\">)</span>\n<span class=\"n\">table</span><span class=\"o\">.</span><span class=\"n\">set_fontsize</span><span class=\"p\">(</span><span class=\"mi\">10</span><span class=\"p\">)</span>\n<span class=\"n\">table</span><span class=\"o\">.</span><span class=\"n\">scale</span><span class=\"p\">(</span><span class=\"mi\">1</span><span class=\"p\">,</span> <span class=\"mi\">2</span><span class=\"p\">)</span>\n\n<span class=\"k\">for</span> <span class=\"n\">i</span> <span class=\"ow\">in</span> <span class=\"nb\">range</span><span class=\"p\">(</span><span class=\"nb\">len</span><span class=\"p\">(</span><span class=\"n\">df_metrics</span><span class=\"p\">)):</span>\n    <span class=\"k\">for</span> <span class=\"n\">j</span> <span class=\"ow\">in</span> <span class=\"nb\">range</span><span class=\"p\">(</span><span class=\"mi\">5</span><span class=\"p\">):</span>\n        <span class=\"n\">cell</span> <span class=\"o\">=</span> <span class=\"n\">table</span><span class=\"p\">[(</span><span class=\"n\">i</span><span class=\"o\">+</span><span class=\"mi\">1</span><span class=\"p\">,</span> <span class=\"n\">j</span><span class=\"p\">)]</span>\n        <span class=\"n\">cell</span><span class=\"o\">.</span><span class=\"n\">set_facecolor</span><span class=\"p\">(</span><span class=\"n\">colors</span><span class=\"p\">[</span><span class=\"n\">i</span><span class=\"p\">])</span>\n        <span class=\"k\">if</span> <span class=\"n\">j</span> <span class=\"o\">==</span> <span class=\"mi\">1</span><span class=\"p\">:</span>  <span class=\"c1\"># Colonna Valore</span>\n            <span class=\"n\">cell</span><span class=\"o\">.</span><span class=\"n\">set_text_props</span><span class=\"p\">(</span><span class=\"n\">weight</span><span class=\"o\">=</span><span class=\"s1\">&#39;bold&#39;</span><span class=\"p\">)</span>\n\n<span class=\"n\">ax</span><span class=\"o\">.</span><span class=\"n\">set_title</span><span class=\"p\">(</span><span class=\"s1\">&#39;RIEPILOGO COMPLETO METRICHE DI CLASSIFICAZIONE&#39;</span><span class=\"p\">,</span> \n            <span class=\"n\">fontsize</span><span class=\"o\">=</span><span class=\"mi\">16</span><span class=\"p\">,</span> <span class=\"n\">fontweight</span><span class=\"o\">=</span><span class=\"s1\">&#39;bold&#39;</span><span class=\"p\">,</span> <span class=\"n\">pad</span><span class=\"o\">=</span><span class=\"mi\">20</span><span class=\"p\">)</span>\n\n<span class=\"n\">plt</span><span class=\"o\">.</span><span class=\"n\">tight_layout</span><span class=\"p\">()</span>\n<span class=\"n\">plt</span><span class=\"o\">.</span><span class=\"n\">show</span><span class=\"p\">()</span>\n\n<span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"s2\">&quot;</span><span class=\"se\">\\n</span><span class=\"s2\">&quot;</span> <span class=\"o\">+</span> <span class=\"s2\">&quot;=&quot;</span><span class=\"o\">*</span><span class=\"mi\">70</span><span class=\"p\">)</span>\n<span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"s2\">&quot;RIEPILOGO METRICHE DI CLASSIFICAZIONE&quot;</span><span class=\"p\">)</span>\n<span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"s2\">&quot;=&quot;</span><span class=\"o\">*</span><span class=\"mi\">70</span><span class=\"p\">)</span>\n<span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"n\">df_metrics</span><span class=\"o\">.</span><span class=\"n\">to_string</span><span class=\"p\">(</span><span class=\"n\">index</span><span class=\"o\">=</span><span class=\"kc\">False</span><span class=\"p\">))</span>\n<span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"s2\">&quot;=&quot;</span><span class=\"o\">*</span><span class=\"mi\">70</span><span class=\"p\">)</span>\n</code></pre></div>\n</div>\n</details>\n\n<h3 id=\"162-linee-guida-per-la-scelta-delle-metriche\">16.2 Linee Guida per la Scelta delle Metriche</h3>\n<details class=\"code-container\">\n<summary>Code</summary>\n<div class=\"code-wrapper\">\n<button class=\"copy-button\" onclick=\"\n                const code = this.parentElement.querySelector('pre');\n                if (code) {\n                    navigator.clipboard.writeText(code.innerText);\n                    this.textContent = 'Copied!';\n                    setTimeout(() => this.textContent = 'Copy', 2000);\n                }\n            \">Copy</button>\n<div class=\"codehilite\"><pre><span></span><code><span class=\"n\">fig</span><span class=\"p\">,</span> <span class=\"n\">ax</span> <span class=\"o\">=</span> <span class=\"n\">plt</span><span class=\"o\">.</span><span class=\"n\">subplots</span><span class=\"p\">(</span><span class=\"n\">figsize</span><span class=\"o\">=</span><span class=\"p\">(</span><span class=\"mi\">14</span><span class=\"p\">,</span> <span class=\"mi\">10</span><span class=\"p\">))</span>\n<span class=\"n\">ax</span><span class=\"o\">.</span><span class=\"n\">axis</span><span class=\"p\">(</span><span class=\"s1\">&#39;off&#39;</span><span class=\"p\">)</span>\n\n<span class=\"n\">guidelines</span> <span class=\"o\">=</span> <span class=\"s2\">&quot;&quot;&quot;</span>\n<span class=\"s2\">╔══════════════════════════════════════════════════════════════════╗</span>\n<span class=\"s2\">║         LINEE GUIDA PER LA SCELTA DELLE METRICHE                ║</span>\n<span class=\"s2\">╚══════════════════════════════════════════════════════════════════╝</span>\n\n<span class=\"s2\">📊 SCENARIO: Dataset Bilanciato</span>\n<span class=\"s2\">   Metriche:  Accuracy, F1-Score, AUC-ROC</span>\n<span class=\"s2\">   Rationale: Accuracy è affidabile, F1 bilancia bene</span>\n\n<span class=\"s2\">📊 SCENARIO: Dataset Sbilanciato</span>\n<span class=\"s2\">   Metriche:  Precision, Recall, F1, AUC-PR, MCC</span>\n<span class=\"s2\">   Rationale: Accuracy è ingannevole, focus su classe rara</span>\n<span class=\"s2\">   ⚠️  NON usare: Accuracy da sola</span>\n\n<span class=\"s2\">📊 SCENARIO: Costo FP alto (es. Spam, Pubblicità)</span>\n<span class=\"s2\">   Metriche:  Precision, FPR, FDR</span>\n<span class=\"s2\">   Rationale: Minimizzare falsi allarmi</span>\n<span class=\"s2\">   Obiettivo: Alta Precision, Basso FPR</span>\n\n<span class=\"s2\">📊 SCENARIO: Costo FN alto (es. Medicina, Frodi)</span>\n<span class=\"s2\">   Metriche:  Recall, FNR, F2-Score</span>\n<span class=\"s2\">   Rationale: Non perdere casi positivi</span>\n<span class=\"s2\">   Obiettivo: Alto Recall, Basso FNR</span>\n\n<span class=\"s2\">📊 SCENARIO: Probabilità importanti</span>\n<span class=\"s2\">   Metriche:  Log Loss, Brier Score, Calibration</span>\n<span class=\"s2\">   Rationale: Valutare qualità delle probabilità</span>\n<span class=\"s2\">   Uso:       Sistemi che usano le probabilità</span>\n\n<span class=\"s2\">📊 SCENARIO: Multi-classe</span>\n<span class=\"s2\">   Metriche:  Macro/Micro/Weighted F1, MCC, Kappa</span>\n<span class=\"s2\">   Rationale: Considerare tutte le classi</span>\n<span class=\"s2\">   Strategia: Macro per bilanciamento, Micro per volume</span>\n\n<span class=\"s2\">📊 SCENARIO: Ranking importante (es. IR, Recommender)</span>\n<span class=\"s2\">   Metriche:  AUC-ROC, AUC-PR, Lift, Gain</span>\n<span class=\"s2\">   Rationale: Ordinamento più importante che soglia</span>\n<span class=\"s2\">   Uso:       Top-K raccomandazioni</span>\n\n<span class=\"s2\">📊 SCENARIO: Confronto Sistemi Biometrici</span>\n<span class=\"s2\">   Metriche:  EER, ZeroFAR, ZeroFRR, ROC, DET</span>\n<span class=\"s2\">   Rationale: Standard del settore biometrico</span>\n<span class=\"s2\">   Focus:     FAR vs FRR trade-off</span>\n\n<span class=\"s2\">━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━</span>\n\n<span class=\"s2\">🎯 PRINCIPI GENERALI:</span>\n\n<span class=\"s2\">1. ✓ NON esiste una metrica universale</span>\n<span class=\"s2\">   Ogni metrica cattura aspetti diversi delle performance</span>\n\n<span class=\"s2\">2. ✓ Usa SEMPRE multiple metriche complementari</span>\n<span class=\"s2\">   Una singola metrica può essere ingannevole</span>\n\n<span class=\"s2\">3. ✓ Considera il COSTO degli errori</span>\n<span class=\"s2\">   FP e FN hanno spesso costi asimmetrici nel mondo reale</span>\n\n<span class=\"s2\">4. ✓ Valuta su set di VALIDAZIONE separato</span>\n<span class=\"s2\">   Evita overfitting sulle metriche</span>\n\n<span class=\"s2\">5. ✓ Usa CROSS-VALIDATION per robustezza</span>\n<span class=\"s2\">   Singolo split può dare risultati ottimistici/pessimistici</span>\n\n<span class=\"s2\">6. ✓ Visualizza con CURVE (ROC, PR, DET)</span>\n<span class=\"s2\">   Forniscono insight oltre ai singoli numeri</span>\n\n<span class=\"s2\">7. ✓ Comunica l&#39;INCERTEZZA</span>\n<span class=\"s2\">   Riporta sempre intervalli di confidenza</span>\n\n<span class=\"s2\">━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━</span>\n\n<span class=\"s2\">⚠️  ATTENZIONE CONFUSIONE ML vs BIOMETRIA:</span>\n\n<span class=\"s2\">   ML (Machine Learning)        vs    Biometria</span>\n<span class=\"s2\">   ────────────────────────────────────────────────────</span>\n<span class=\"s2\">   Precision (PPV)                    GA/(GA+FA)</span>\n<span class=\"s2\">   Recall (Sensitivity, TPR)          GAR = 1-FRR</span>\n<span class=\"s2\">   FPR (Fall-out)                     FAR</span>\n<span class=\"s2\">   FNR (Miss Rate)                    FRR</span>\n\n<span class=\"s2\">   DIFFERENZA CHIAVE:</span>\n<span class=\"s2\">   • Precision/Recall partono da TP (predizioni corrette)</span>\n<span class=\"s2\">   • FAR/FRR partono da FP/FN (errori del sistema)</span>\n\n<span class=\"s2\">   ⚠️  NON sono intercambiabili!</span>\n\n<span class=\"s2\">━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━</span>\n\n<span class=\"s2\">📚 CHECKLIST VALUTAZIONE MODELLO:</span>\n\n<span class=\"s2\">☐ Matrice di confusione visualizzata</span>\n<span class=\"s2\">☐ Metriche base calcolate (P, R, F1)</span>\n<span class=\"s2\">☐ Metriche avanzate (MCC, Kappa, AUC)</span>\n<span class=\"s2\">☐ Curve visualizzate (ROC, PR)</span>\n<span class=\"s2\">☐ Calibrazione verificata</span>\n<span class=\"s2\">☐ Cross-validation eseguita</span>\n<span class=\"s2\">☐ Soglia ottimizzata per use case</span>\n<span class=\"s2\">☐ Trade-offs documentati</span>\n<span class=\"s2\">☐ Metriche contestualizzate al problema</span>\n<span class=\"s2\">☐ Limitazioni discusse</span>\n<span class=\"s2\">&quot;&quot;&quot;</span>\n\n<span class=\"n\">ax</span><span class=\"o\">.</span><span class=\"n\">text</span><span class=\"p\">(</span><span class=\"mf\">0.5</span><span class=\"p\">,</span> <span class=\"mf\">0.5</span><span class=\"p\">,</span> <span class=\"n\">guidelines</span><span class=\"p\">,</span> <span class=\"n\">fontsize</span><span class=\"o\">=</span><span class=\"mi\">9</span><span class=\"p\">,</span> <span class=\"n\">verticalalignment</span><span class=\"o\">=</span><span class=\"s1\">&#39;center&#39;</span><span class=\"p\">,</span>\n       <span class=\"n\">horizontalalignment</span><span class=\"o\">=</span><span class=\"s1\">&#39;center&#39;</span><span class=\"p\">,</span> <span class=\"n\">family</span><span class=\"o\">=</span><span class=\"s1\">&#39;monospace&#39;</span><span class=\"p\">,</span>\n       <span class=\"n\">bbox</span><span class=\"o\">=</span><span class=\"nb\">dict</span><span class=\"p\">(</span><span class=\"n\">boxstyle</span><span class=\"o\">=</span><span class=\"s1\">&#39;round&#39;</span><span class=\"p\">,</span> <span class=\"n\">facecolor</span><span class=\"o\">=</span><span class=\"s1\">&#39;lightyellow&#39;</span><span class=\"p\">,</span> <span class=\"n\">alpha</span><span class=\"o\">=</span><span class=\"mf\">0.9</span><span class=\"p\">,</span> <span class=\"n\">pad</span><span class=\"o\">=</span><span class=\"mi\">1</span><span class=\"p\">))</span>\n\n<span class=\"n\">plt</span><span class=\"o\">.</span><span class=\"n\">tight_layout</span><span class=\"p\">()</span>\n<span class=\"n\">plt</span><span class=\"o\">.</span><span class=\"n\">show</span><span class=\"p\">()</span>\n</code></pre></div>\n</div>\n</details>\n\n<h2 id=\"17-conclusioni\">17. Conclusioni</h2>\n<p>La valutazione rigorosa di modelli di classificazione richiede:</p>\n<ol>\n<li><strong>Comprensione profonda</strong> delle metriche e delle loro proprietà matematiche</li>\n<li><strong>Consapevolezza delle differenze</strong> tra terminologia ML e biometrica</li>\n<li><strong>Scelta contestuale</strong> delle metriche appropriate al problema</li>\n<li><strong>Analisi multi-dimensionale</strong> con curve e visualizzazioni</li>\n<li><strong>Validazione robusta</strong> tramite cross-validation</li>\n<li><strong>Comunicazione chiara</strong> di limitazioni e trade-offs</li>\n</ol>\n<p><strong>Ricorda</strong>:\n- ✓ Precision e Recall ≠ FAR e FRR (diverse statistiche!)\n- ✓ Nessuna metrica è perfetta per tutti gli scenari\n- ✓ Dataset sbilanciati richiedono metriche speciali\n- ✓ Le curve (ROC, PR, DET) forniscono più informazioni dei singoli numeri\n- ✓ La soglia di decisione è un parametro critico da ottimizzare\n- ✓ Il contesto applicativo determina quali errori sono più costosi</p>\n<hr />\n<h2 id=\"appendice-formule-complete-e-relazioni\">Appendice: Formule Complete e Relazioni</h2>\n<h3 id=\"formule-matematiche-riassuntive\">Formule Matematiche Riassuntive</h3>\n<p><strong>Metriche Base</strong>:\n$\\text{Accuracy} = \\frac{TP + TN}{TP + TN + FP + FN}$</p>\n<p>$\\text{Precision} = \\frac{TP}{TP + FP}$</p>\n<p>$\\text{Recall (TPR)} = \\frac{TP}{TP + FN}$</p>\n<p>$\\text{Specificity (TNR)} = \\frac{TN}{TN + FP}$</p>\n<p><strong>Tassi di Errore</strong>:\n$\\text{FPR (FAR)} = \\frac{FP}{FP + TN} = 1 - \\text{Specificity}$</p>\n<p>$\\text{FNR (FRR)} = \\frac{FN}{FN + TP} = 1 - \\text{Recall}$</p>\n<p>$\\text{FDR} = \\frac{FP}{FP + TP} = 1 - \\text{Precision}$</p>\n<p><strong>F-Scores</strong>:\n$F_1 = \\frac{2 \\cdot \\text{Precision} \\cdot \\text{Recall}}{\\text{Precision} + \\text{Recall}} = \\frac{2TP}{2TP + FP + FN}$</p>\n<p>$F_\\beta = (1 + \\beta^2) \\cdot \\frac{\\text{Precision} \\cdot \\text{Recall}}{\\beta^2 \\cdot \\text{Precision} + \\text{Recall}}$</p>\n<p><strong>Metriche Avanzate</strong>:\n$\\text{MCC} = \\frac{TP \\cdot TN - FP \\cdot FN}{\\sqrt{(TP + FP)(TP + FN)(TN + FP)(TN + FN)}}$</p>\n<p>$\\kappa = \\frac{p_o - p_e}{1 - p_e}$</p>\n<p><strong>Metriche Probabilistiche</strong>:\n$\\text{Log Loss} = -\\frac{1}{N} \\sum_{i=1}^{N} \\left[ y_i \\log(p_i) + (1 - y_i) \\log(1 - p_i) \\right]$</p>\n<p>$\\text{Brier Score} = \\frac{1}{N} \\sum_{i=1}^{N} (p_i - y_i)^2$</p>\n<p><strong>Relazioni Fondamentali</strong>:\n$\\text{TPR} + \\text{FNR} = 1$\n$\\text{TNR} + \\text{FPR} = 1$\n$\\text{Precision} + \\text{FDR} = 1$\n$\\text{GAR} = 1 - \\text{FRR} = \\text{Recall}$</p>\n<h3 id=\"grafico-finale-relazioni-tra-metriche\">Grafico Finale: Relazioni tra Metriche</h3>\n<details class=\"code-container\">\n<summary>Code</summary>\n<div class=\"code-wrapper\">\n<button class=\"copy-button\" onclick=\"\n                const code = this.parentElement.querySelector('pre');\n                if (code) {\n                    navigator.clipboard.writeText(code.innerText);\n                    this.textContent = 'Copied!';\n                    setTimeout(() => this.textContent = 'Copy', 2000);\n                }\n            \">Copy</button>\n<div class=\"codehilite\"><pre><span></span><code><span class=\"n\">fig</span><span class=\"p\">,</span> <span class=\"n\">axes</span> <span class=\"o\">=</span> <span class=\"n\">plt</span><span class=\"o\">.</span><span class=\"n\">subplots</span><span class=\"p\">(</span><span class=\"mi\">2</span><span class=\"p\">,</span> <span class=\"mi\">2</span><span class=\"p\">,</span> <span class=\"n\">figsize</span><span class=\"o\">=</span><span class=\"p\">(</span><span class=\"mi\">16</span><span class=\"p\">,</span> <span class=\"mi\">12</span><span class=\"p\">))</span>\n\n<span class=\"c1\"># 1. Diagramma di Venn delle metriche</span>\n<span class=\"n\">ax</span> <span class=\"o\">=</span> <span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"mi\">0</span><span class=\"p\">]</span>\n<span class=\"n\">ax</span><span class=\"o\">.</span><span class=\"n\">axis</span><span class=\"p\">(</span><span class=\"s1\">&#39;off&#39;</span><span class=\"p\">)</span>\n<span class=\"n\">ax</span><span class=\"o\">.</span><span class=\"n\">set_xlim</span><span class=\"p\">(</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"mi\">10</span><span class=\"p\">)</span>\n<span class=\"n\">ax</span><span class=\"o\">.</span><span class=\"n\">set_ylim</span><span class=\"p\">(</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"mi\">10</span><span class=\"p\">)</span>\n\n<span class=\"c1\"># Cerchi per TP, FP, FN, TN</span>\n<span class=\"kn\">from</span><span class=\"w\"> </span><span class=\"nn\">matplotlib.patches</span><span class=\"w\"> </span><span class=\"kn\">import</span> <span class=\"n\">Rectangle</span><span class=\"p\">,</span> <span class=\"n\">FancyBboxPatch</span><span class=\"p\">,</span> <span class=\"n\">Circle</span><span class=\"p\">,</span> <span class=\"n\">FancyArrowPatch</span>\n\n<span class=\"c1\"># Confusion matrix visual</span>\n<span class=\"n\">box_size</span> <span class=\"o\">=</span> <span class=\"mi\">3</span>\n<span class=\"n\">ax</span><span class=\"o\">.</span><span class=\"n\">add_patch</span><span class=\"p\">(</span><span class=\"n\">Rectangle</span><span class=\"p\">((</span><span class=\"mi\">1</span><span class=\"p\">,</span> <span class=\"mi\">6</span><span class=\"p\">),</span> <span class=\"n\">box_size</span><span class=\"p\">,</span> <span class=\"n\">box_size</span><span class=\"p\">,</span> <span class=\"n\">facecolor</span><span class=\"o\">=</span><span class=\"s1\">&#39;lightgreen&#39;</span><span class=\"p\">,</span> \n                       <span class=\"n\">edgecolor</span><span class=\"o\">=</span><span class=\"s1\">&#39;black&#39;</span><span class=\"p\">,</span> <span class=\"n\">linewidth</span><span class=\"o\">=</span><span class=\"mi\">3</span><span class=\"p\">,</span> <span class=\"n\">alpha</span><span class=\"o\">=</span><span class=\"mf\">0.7</span><span class=\"p\">))</span>\n<span class=\"n\">ax</span><span class=\"o\">.</span><span class=\"n\">text</span><span class=\"p\">(</span><span class=\"mf\">2.5</span><span class=\"p\">,</span> <span class=\"mf\">7.5</span><span class=\"p\">,</span> <span class=\"sa\">f</span><span class=\"s1\">&#39;TP</span><span class=\"se\">\\n</span><span class=\"si\">{</span><span class=\"n\">tp</span><span class=\"si\">}</span><span class=\"s1\">&#39;</span><span class=\"p\">,</span> <span class=\"n\">ha</span><span class=\"o\">=</span><span class=\"s1\">&#39;center&#39;</span><span class=\"p\">,</span> <span class=\"n\">va</span><span class=\"o\">=</span><span class=\"s1\">&#39;center&#39;</span><span class=\"p\">,</span> <span class=\"n\">fontsize</span><span class=\"o\">=</span><span class=\"mi\">16</span><span class=\"p\">,</span> <span class=\"n\">fontweight</span><span class=\"o\">=</span><span class=\"s1\">&#39;bold&#39;</span><span class=\"p\">)</span>\n\n<span class=\"n\">ax</span><span class=\"o\">.</span><span class=\"n\">add_patch</span><span class=\"p\">(</span><span class=\"n\">Rectangle</span><span class=\"p\">((</span><span class=\"mi\">5</span><span class=\"p\">,</span> <span class=\"mi\">6</span><span class=\"p\">),</span> <span class=\"n\">box_size</span><span class=\"p\">,</span> <span class=\"n\">box_size</span><span class=\"p\">,</span> <span class=\"n\">facecolor</span><span class=\"o\">=</span><span class=\"s1\">&#39;lightcoral&#39;</span><span class=\"p\">,</span> \n                       <span class=\"n\">edgecolor</span><span class=\"o\">=</span><span class=\"s1\">&#39;black&#39;</span><span class=\"p\">,</span> <span class=\"n\">linewidth</span><span class=\"o\">=</span><span class=\"mi\">3</span><span class=\"p\">,</span> <span class=\"n\">alpha</span><span class=\"o\">=</span><span class=\"mf\">0.7</span><span class=\"p\">))</span>\n<span class=\"n\">ax</span><span class=\"o\">.</span><span class=\"n\">text</span><span class=\"p\">(</span><span class=\"mf\">6.5</span><span class=\"p\">,</span> <span class=\"mf\">7.5</span><span class=\"p\">,</span> <span class=\"sa\">f</span><span class=\"s1\">&#39;FP</span><span class=\"se\">\\n</span><span class=\"si\">{</span><span class=\"n\">fp</span><span class=\"si\">}</span><span class=\"s1\">&#39;</span><span class=\"p\">,</span> <span class=\"n\">ha</span><span class=\"o\">=</span><span class=\"s1\">&#39;center&#39;</span><span class=\"p\">,</span> <span class=\"n\">va</span><span class=\"o\">=</span><span class=\"s1\">&#39;center&#39;</span><span class=\"p\">,</span> <span class=\"n\">fontsize</span><span class=\"o\">=</span><span class=\"mi\">16</span><span class=\"p\">,</span> <span class=\"n\">fontweight</span><span class=\"o\">=</span><span class=\"s1\">&#39;bold&#39;</span><span class=\"p\">)</span>\n\n<span class=\"n\">ax</span><span class=\"o\">.</span><span class=\"n\">add_patch</span><span class=\"p\">(</span><span class=\"n\">Rectangle</span><span class=\"p\">((</span><span class=\"mi\">1</span><span class=\"p\">,</span> <span class=\"mi\">2</span><span class=\"p\">),</span> <span class=\"n\">box_size</span><span class=\"p\">,</span> <span class=\"n\">box_size</span><span class=\"p\">,</span> <span class=\"n\">facecolor</span><span class=\"o\">=</span><span class=\"s1\">&#39;lightyellow&#39;</span><span class=\"p\">,</span> \n                       <span class=\"n\">edgecolor</span><span class=\"o\">=</span><span class=\"s1\">&#39;black&#39;</span><span class=\"p\">,</span> <span class=\"n\">linewidth</span><span class=\"o\">=</span><span class=\"mi\">3</span><span class=\"p\">,</span> <span class=\"n\">alpha</span><span class=\"o\">=</span><span class=\"mf\">0.7</span><span class=\"p\">))</span>\n<span class=\"n\">ax</span><span class=\"o\">.</span><span class=\"n\">text</span><span class=\"p\">(</span><span class=\"mf\">2.5</span><span class=\"p\">,</span> <span class=\"mf\">3.5</span><span class=\"p\">,</span> <span class=\"sa\">f</span><span class=\"s1\">&#39;FN</span><span class=\"se\">\\n</span><span class=\"si\">{</span><span class=\"n\">fn</span><span class=\"si\">}</span><span class=\"s1\">&#39;</span><span class=\"p\">,</span> <span class=\"n\">ha</span><span class=\"o\">=</span><span class=\"s1\">&#39;center&#39;</span><span class=\"p\">,</span> <span class=\"n\">va</span><span class=\"o\">=</span><span class=\"s1\">&#39;center&#39;</span><span class=\"p\">,</span> <span class=\"n\">fontsize</span><span class=\"o\">=</span><span class=\"mi\">16</span><span class=\"p\">,</span> <span class=\"n\">fontweight</span><span class=\"o\">=</span><span class=\"s1\">&#39;bold&#39;</span><span class=\"p\">)</span>\n\n<span class=\"n\">ax</span><span class=\"o\">.</span><span class=\"n\">add_patch</span><span class=\"p\">(</span><span class=\"n\">Rectangle</span><span class=\"p\">((</span><span class=\"mi\">5</span><span class=\"p\">,</span> <span class=\"mi\">2</span><span class=\"p\">),</span> <span class=\"n\">box_size</span><span class=\"p\">,</span> <span class=\"n\">box_size</span><span class=\"p\">,</span> <span class=\"n\">facecolor</span><span class=\"o\">=</span><span class=\"s1\">&#39;lightblue&#39;</span><span class=\"p\">,</span> \n                       <span class=\"n\">edgecolor</span><span class=\"o\">=</span><span class=\"s1\">&#39;black&#39;</span><span class=\"p\">,</span> <span class=\"n\">linewidth</span><span class=\"o\">=</span><span class=\"mi\">3</span><span class=\"p\">,</span> <span class=\"n\">alpha</span><span class=\"o\">=</span><span class=\"mf\">0.7</span><span class=\"p\">))</span>\n<span class=\"n\">ax</span><span class=\"o\">.</span><span class=\"n\">text</span><span class=\"p\">(</span><span class=\"mf\">6.5</span><span class=\"p\">,</span> <span class=\"mf\">3.5</span><span class=\"p\">,</span> <span class=\"sa\">f</span><span class=\"s1\">&#39;TN</span><span class=\"se\">\\n</span><span class=\"si\">{</span><span class=\"n\">tn</span><span class=\"si\">}</span><span class=\"s1\">&#39;</span><span class=\"p\">,</span> <span class=\"n\">ha</span><span class=\"o\">=</span><span class=\"s1\">&#39;center&#39;</span><span class=\"p\">,</span> <span class=\"n\">va</span><span class=\"o\">=</span><span class=\"s1\">&#39;center&#39;</span><span class=\"p\">,</span> <span class=\"n\">fontsize</span><span class=\"o\">=</span><span class=\"mi\">16</span><span class=\"p\">,</span> <span class=\"n\">fontweight</span><span class=\"o\">=</span><span class=\"s1\">&#39;bold&#39;</span><span class=\"p\">)</span>\n\n<span class=\"c1\"># Labels</span>\n<span class=\"n\">ax</span><span class=\"o\">.</span><span class=\"n\">text</span><span class=\"p\">(</span><span class=\"mf\">2.5</span><span class=\"p\">,</span> <span class=\"mf\">9.5</span><span class=\"p\">,</span> <span class=\"s1\">&#39;Pred: POS&#39;</span><span class=\"p\">,</span> <span class=\"n\">ha</span><span class=\"o\">=</span><span class=\"s1\">&#39;center&#39;</span><span class=\"p\">,</span> <span class=\"n\">fontsize</span><span class=\"o\">=</span><span class=\"mi\">12</span><span class=\"p\">,</span> <span class=\"n\">fontweight</span><span class=\"o\">=</span><span class=\"s1\">&#39;bold&#39;</span><span class=\"p\">)</span>\n<span class=\"n\">ax</span><span class=\"o\">.</span><span class=\"n\">text</span><span class=\"p\">(</span><span class=\"mf\">6.5</span><span class=\"p\">,</span> <span class=\"mf\">9.5</span><span class=\"p\">,</span> <span class=\"s1\">&#39;Pred: NEG&#39;</span><span class=\"p\">,</span> <span class=\"n\">ha</span><span class=\"o\">=</span><span class=\"s1\">&#39;center&#39;</span><span class=\"p\">,</span> <span class=\"n\">fontsize</span><span class=\"o\">=</span><span class=\"mi\">12</span><span class=\"p\">,</span> <span class=\"n\">fontweight</span><span class=\"o\">=</span><span class=\"s1\">&#39;bold&#39;</span><span class=\"p\">)</span>\n<span class=\"n\">ax</span><span class=\"o\">.</span><span class=\"n\">text</span><span class=\"p\">(</span><span class=\"mf\">0.2</span><span class=\"p\">,</span> <span class=\"mf\">7.5</span><span class=\"p\">,</span> <span class=\"s1\">&#39;Real:</span><span class=\"se\">\\n</span><span class=\"s1\">POS&#39;</span><span class=\"p\">,</span> <span class=\"n\">ha</span><span class=\"o\">=</span><span class=\"s1\">&#39;center&#39;</span><span class=\"p\">,</span> <span class=\"n\">va</span><span class=\"o\">=</span><span class=\"s1\">&#39;center&#39;</span><span class=\"p\">,</span> <span class=\"n\">fontsize</span><span class=\"o\">=</span><span class=\"mi\">12</span><span class=\"p\">,</span> <span class=\"n\">fontweight</span><span class=\"o\">=</span><span class=\"s1\">&#39;bold&#39;</span><span class=\"p\">)</span>\n<span class=\"n\">ax</span><span class=\"o\">.</span><span class=\"n\">text</span><span class=\"p\">(</span><span class=\"mf\">0.2</span><span class=\"p\">,</span> <span class=\"mf\">3.5</span><span class=\"p\">,</span> <span class=\"s1\">&#39;Real:</span><span class=\"se\">\\n</span><span class=\"s1\">NEG&#39;</span><span class=\"p\">,</span> <span class=\"n\">ha</span><span class=\"o\">=</span><span class=\"s1\">&#39;center&#39;</span><span class=\"p\">,</span> <span class=\"n\">va</span><span class=\"o\">=</span><span class=\"s1\">&#39;center&#39;</span><span class=\"p\">,</span> <span class=\"n\">fontsize</span><span class=\"o\">=</span><span class=\"mi\">12</span><span class=\"p\">,</span> <span class=\"n\">fontweight</span><span class=\"o\">=</span><span class=\"s1\">&#39;bold&#39;</span><span class=\"p\">)</span>\n\n<span class=\"c1\"># Formule collegate</span>\n<span class=\"n\">ax</span><span class=\"o\">.</span><span class=\"n\">text</span><span class=\"p\">(</span><span class=\"mf\">2.5</span><span class=\"p\">,</span> <span class=\"mi\">1</span><span class=\"p\">,</span> <span class=\"sa\">f</span><span class=\"s1\">&#39;Precision = TP/(TP+FP) = </span><span class=\"si\">{</span><span class=\"n\">precision</span><span class=\"si\">:</span><span class=\"s1\">.3f</span><span class=\"si\">}</span><span class=\"s1\">&#39;</span><span class=\"p\">,</span> \n       <span class=\"n\">ha</span><span class=\"o\">=</span><span class=\"s1\">&#39;center&#39;</span><span class=\"p\">,</span> <span class=\"n\">fontsize</span><span class=\"o\">=</span><span class=\"mi\">10</span><span class=\"p\">,</span> <span class=\"n\">bbox</span><span class=\"o\">=</span><span class=\"nb\">dict</span><span class=\"p\">(</span><span class=\"n\">boxstyle</span><span class=\"o\">=</span><span class=\"s1\">&#39;round&#39;</span><span class=\"p\">,</span> <span class=\"n\">facecolor</span><span class=\"o\">=</span><span class=\"s1\">&#39;blue&#39;</span><span class=\"p\">,</span> <span class=\"n\">alpha</span><span class=\"o\">=</span><span class=\"mf\">0.3</span><span class=\"p\">))</span>\n<span class=\"n\">ax</span><span class=\"o\">.</span><span class=\"n\">text</span><span class=\"p\">(</span><span class=\"mf\">2.5</span><span class=\"p\">,</span> <span class=\"mf\">0.3</span><span class=\"p\">,</span> <span class=\"sa\">f</span><span class=\"s1\">&#39;Recall = TP/(TP+FN) = </span><span class=\"si\">{</span><span class=\"n\">recall</span><span class=\"si\">:</span><span class=\"s1\">.3f</span><span class=\"si\">}</span><span class=\"s1\">&#39;</span><span class=\"p\">,</span> \n       <span class=\"n\">ha</span><span class=\"o\">=</span><span class=\"s1\">&#39;center&#39;</span><span class=\"p\">,</span> <span class=\"n\">fontsize</span><span class=\"o\">=</span><span class=\"mi\">10</span><span class=\"p\">,</span> <span class=\"n\">bbox</span><span class=\"o\">=</span><span class=\"nb\">dict</span><span class=\"p\">(</span><span class=\"n\">boxstyle</span><span class=\"o\">=</span><span class=\"s1\">&#39;round&#39;</span><span class=\"p\">,</span> <span class=\"n\">facecolor</span><span class=\"o\">=</span><span class=\"s1\">&#39;green&#39;</span><span class=\"p\">,</span> <span class=\"n\">alpha</span><span class=\"o\">=</span><span class=\"mf\">0.3</span><span class=\"p\">))</span>\n<span class=\"n\">ax</span><span class=\"o\">.</span><span class=\"n\">text</span><span class=\"p\">(</span><span class=\"mf\">6.5</span><span class=\"p\">,</span> <span class=\"mi\">1</span><span class=\"p\">,</span> <span class=\"sa\">f</span><span class=\"s1\">&#39;FPR = FP/(FP+TN) = </span><span class=\"si\">{</span><span class=\"n\">fpr</span><span class=\"si\">:</span><span class=\"s1\">.3f</span><span class=\"si\">}</span><span class=\"s1\">&#39;</span><span class=\"p\">,</span> \n       <span class=\"n\">ha</span><span class=\"o\">=</span><span class=\"s1\">&#39;center&#39;</span><span class=\"p\">,</span> <span class=\"n\">fontsize</span><span class=\"o\">=</span><span class=\"mi\">10</span><span class=\"p\">,</span> <span class=\"n\">bbox</span><span class=\"o\">=</span><span class=\"nb\">dict</span><span class=\"p\">(</span><span class=\"n\">boxstyle</span><span class=\"o\">=</span><span class=\"s1\">&#39;round&#39;</span><span class=\"p\">,</span> <span class=\"n\">facecolor</span><span class=\"o\">=</span><span class=\"s1\">&#39;red&#39;</span><span class=\"p\">,</span> <span class=\"n\">alpha</span><span class=\"o\">=</span><span class=\"mf\">0.3</span><span class=\"p\">))</span>\n<span class=\"n\">ax</span><span class=\"o\">.</span><span class=\"n\">text</span><span class=\"p\">(</span><span class=\"mf\">6.5</span><span class=\"p\">,</span> <span class=\"mf\">0.3</span><span class=\"p\">,</span> <span class=\"sa\">f</span><span class=\"s1\">&#39;FNR = FN/(FN+TP) = </span><span class=\"si\">{</span><span class=\"n\">fnr</span><span class=\"si\">:</span><span class=\"s1\">.3f</span><span class=\"si\">}</span><span class=\"s1\">&#39;</span><span class=\"p\">,</span> \n       <span class=\"n\">ha</span><span class=\"o\">=</span><span class=\"s1\">&#39;center&#39;</span><span class=\"p\">,</span> <span class=\"n\">fontsize</span><span class=\"o\">=</span><span class=\"mi\">10</span><span class=\"p\">,</span> <span class=\"n\">bbox</span><span class=\"o\">=</span><span class=\"nb\">dict</span><span class=\"p\">(</span><span class=\"n\">boxstyle</span><span class=\"o\">=</span><span class=\"s1\">&#39;round&#39;</span><span class=\"p\">,</span> <span class=\"n\">facecolor</span><span class=\"o\">=</span><span class=\"s1\">&#39;orange&#39;</span><span class=\"p\">,</span> <span class=\"n\">alpha</span><span class=\"o\">=</span><span class=\"mf\">0.3</span><span class=\"p\">))</span>\n\n<span class=\"n\">ax</span><span class=\"o\">.</span><span class=\"n\">set_title</span><span class=\"p\">(</span><span class=\"s1\">&#39;Matrice di Confusione e Relazioni&#39;</span><span class=\"p\">,</span> <span class=\"n\">fontsize</span><span class=\"o\">=</span><span class=\"mi\">14</span><span class=\"p\">,</span> <span class=\"n\">fontweight</span><span class=\"o\">=</span><span class=\"s1\">&#39;bold&#39;</span><span class=\"p\">)</span>\n\n<span class=\"c1\"># 2. Trade-offs principali</span>\n<span class=\"n\">ax</span> <span class=\"o\">=</span> <span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"mi\">1</span><span class=\"p\">]</span>\n<span class=\"n\">x_vals</span> <span class=\"o\">=</span> <span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">linspace</span><span class=\"p\">(</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"mi\">1</span><span class=\"p\">,</span> <span class=\"mi\">100</span><span class=\"p\">)</span>\n\n<span class=\"c1\"># Simula trade-off ideale</span>\n<span class=\"n\">precision_tradeoff</span> <span class=\"o\">=</span> <span class=\"mi\">1</span> <span class=\"o\">/</span> <span class=\"p\">(</span><span class=\"mi\">1</span> <span class=\"o\">+</span> <span class=\"mi\">2</span><span class=\"o\">*</span><span class=\"n\">x_vals</span><span class=\"p\">)</span>\n<span class=\"n\">recall_tradeoff</span> <span class=\"o\">=</span> <span class=\"n\">x_vals</span>\n\n<span class=\"n\">ax</span><span class=\"o\">.</span><span class=\"n\">plot</span><span class=\"p\">(</span><span class=\"n\">recall_tradeoff</span><span class=\"p\">,</span> <span class=\"n\">precision_tradeoff</span><span class=\"p\">,</span> <span class=\"s1\">&#39;b-&#39;</span><span class=\"p\">,</span> <span class=\"n\">lw</span><span class=\"o\">=</span><span class=\"mi\">3</span><span class=\"p\">,</span> <span class=\"n\">label</span><span class=\"o\">=</span><span class=\"s1\">&#39;Precision vs Recall&#39;</span><span class=\"p\">)</span>\n<span class=\"n\">ax</span><span class=\"o\">.</span><span class=\"n\">scatter</span><span class=\"p\">([</span><span class=\"n\">recall</span><span class=\"p\">],</span> <span class=\"p\">[</span><span class=\"n\">precision</span><span class=\"p\">],</span> <span class=\"n\">s</span><span class=\"o\">=</span><span class=\"mi\">300</span><span class=\"p\">,</span> <span class=\"n\">c</span><span class=\"o\">=</span><span class=\"s1\">&#39;red&#39;</span><span class=\"p\">,</span> <span class=\"n\">marker</span><span class=\"o\">=</span><span class=\"s1\">&#39;*&#39;</span><span class=\"p\">,</span> \n          <span class=\"n\">zorder</span><span class=\"o\">=</span><span class=\"mi\">5</span><span class=\"p\">,</span> <span class=\"n\">edgecolor</span><span class=\"o\">=</span><span class=\"s1\">&#39;black&#39;</span><span class=\"p\">,</span> <span class=\"n\">linewidth</span><span class=\"o\">=</span><span class=\"mi\">2</span><span class=\"p\">,</span> <span class=\"n\">label</span><span class=\"o\">=</span><span class=\"s1\">&#39;Punto Attuale&#39;</span><span class=\"p\">)</span>\n\n<span class=\"c1\"># F1 iso-lines</span>\n<span class=\"n\">f1_values</span> <span class=\"o\">=</span> <span class=\"p\">[</span><span class=\"mf\">0.3</span><span class=\"p\">,</span> <span class=\"mf\">0.5</span><span class=\"p\">,</span> <span class=\"mf\">0.7</span><span class=\"p\">,</span> <span class=\"mf\">0.9</span><span class=\"p\">]</span>\n<span class=\"k\">for</span> <span class=\"n\">f1_val</span> <span class=\"ow\">in</span> <span class=\"n\">f1_values</span><span class=\"p\">:</span>\n    <span class=\"n\">recall_line</span> <span class=\"o\">=</span> <span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">linspace</span><span class=\"p\">(</span><span class=\"mf\">0.01</span><span class=\"p\">,</span> <span class=\"mi\">1</span><span class=\"p\">,</span> <span class=\"mi\">100</span><span class=\"p\">)</span>\n    <span class=\"n\">precision_line</span> <span class=\"o\">=</span> <span class=\"p\">(</span><span class=\"n\">f1_val</span> <span class=\"o\">*</span> <span class=\"n\">recall_line</span><span class=\"p\">)</span> <span class=\"o\">/</span> <span class=\"p\">(</span><span class=\"mi\">2</span> <span class=\"o\">*</span> <span class=\"n\">recall_line</span> <span class=\"o\">-</span> <span class=\"n\">f1_val</span><span class=\"p\">)</span>\n    <span class=\"n\">precision_line</span> <span class=\"o\">=</span> <span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">clip</span><span class=\"p\">(</span><span class=\"n\">precision_line</span><span class=\"p\">,</span> <span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"mi\">1</span><span class=\"p\">)</span>\n    <span class=\"n\">ax</span><span class=\"o\">.</span><span class=\"n\">plot</span><span class=\"p\">(</span><span class=\"n\">recall_line</span><span class=\"p\">,</span> <span class=\"n\">precision_line</span><span class=\"p\">,</span> <span class=\"s1\">&#39;--&#39;</span><span class=\"p\">,</span> <span class=\"n\">alpha</span><span class=\"o\">=</span><span class=\"mf\">0.4</span><span class=\"p\">,</span> \n           <span class=\"n\">label</span><span class=\"o\">=</span><span class=\"sa\">f</span><span class=\"s1\">&#39;F1=</span><span class=\"si\">{</span><span class=\"n\">f1_val</span><span class=\"si\">}</span><span class=\"s1\">&#39;</span> <span class=\"k\">if</span> <span class=\"n\">f1_val</span> <span class=\"ow\">in</span> <span class=\"p\">[</span><span class=\"mf\">0.5</span><span class=\"p\">,</span> <span class=\"mf\">0.9</span><span class=\"p\">]</span> <span class=\"k\">else</span> <span class=\"s1\">&#39;&#39;</span><span class=\"p\">)</span>\n\n<span class=\"n\">ax</span><span class=\"o\">.</span><span class=\"n\">set_xlabel</span><span class=\"p\">(</span><span class=\"s1\">&#39;Recall&#39;</span><span class=\"p\">,</span> <span class=\"n\">fontsize</span><span class=\"o\">=</span><span class=\"mi\">12</span><span class=\"p\">)</span>\n<span class=\"n\">ax</span><span class=\"o\">.</span><span class=\"n\">set_ylabel</span><span class=\"p\">(</span><span class=\"s1\">&#39;Precision&#39;</span><span class=\"p\">,</span> <span class=\"n\">fontsize</span><span class=\"o\">=</span><span class=\"mi\">12</span><span class=\"p\">)</span>\n<span class=\"n\">ax</span><span class=\"o\">.</span><span class=\"n\">set_title</span><span class=\"p\">(</span><span class=\"s1\">&#39;Trade-off Precision-Recall con Iso-F1&#39;</span><span class=\"p\">,</span> <span class=\"n\">fontsize</span><span class=\"o\">=</span><span class=\"mi\">14</span><span class=\"p\">,</span> <span class=\"n\">fontweight</span><span class=\"o\">=</span><span class=\"s1\">&#39;bold&#39;</span><span class=\"p\">)</span>\n<span class=\"n\">ax</span><span class=\"o\">.</span><span class=\"n\">legend</span><span class=\"p\">()</span>\n<span class=\"n\">ax</span><span class=\"o\">.</span><span class=\"n\">grid</span><span class=\"p\">(</span><span class=\"n\">alpha</span><span class=\"o\">=</span><span class=\"mf\">0.3</span><span class=\"p\">)</span>\n<span class=\"n\">ax</span><span class=\"o\">.</span><span class=\"n\">set_xlim</span><span class=\"p\">([</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"mi\">1</span><span class=\"p\">])</span>\n<span class=\"n\">ax</span><span class=\"o\">.</span><span class=\"n\">set_ylim</span><span class=\"p\">([</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"mi\">1</span><span class=\"p\">])</span>\n\n<span class=\"c1\"># 3. Comparazione ML vs Biometria</span>\n<span class=\"n\">ax</span> <span class=\"o\">=</span> <span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">,</span> <span class=\"mi\">0</span><span class=\"p\">]</span>\n<span class=\"n\">ax</span><span class=\"o\">.</span><span class=\"n\">axis</span><span class=\"p\">(</span><span class=\"s1\">&#39;off&#39;</span><span class=\"p\">)</span>\n\n<span class=\"n\">comparison_text</span> <span class=\"o\">=</span> <span class=\"s2\">&quot;&quot;&quot;</span>\n<span class=\"s2\">╔═══════════════════════════════════════════════════════════════╗</span>\n<span class=\"s2\">║       DIFFERENZE CRITICHE: ML vs BIOMETRIA                   ║</span>\n<span class=\"s2\">╚═══════════════════════════════════════════════════════════════╝</span>\n\n<span class=\"s2\">TERMINOLOGIA:</span>\n<span class=\"s2\">┌────────────────┬─────────────────┬──────────────────────┐</span>\n<span class=\"s2\">│ Machine Learn. │    Biometria    │   Significato        │</span>\n<span class=\"s2\">├────────────────┼─────────────────┼──────────────────────┤</span>\n<span class=\"s2\">│ True Positive  │ Genuine Accept  │ Correttamente +      │</span>\n<span class=\"s2\">│ False Positive │ False Accept    │ Errore Tipo II       │</span>\n<span class=\"s2\">│ False Negative │ False Reject    │ Errore Tipo I        │</span>\n<span class=\"s2\">│ True Negative  │ Genuine Reject  │ Correttamente -      │</span>\n<span class=\"s2\">└────────────────┴─────────────────┴──────────────────────┘</span>\n\n<span class=\"s2\">METRICHE - ATTENZIONE ALLE FORMULE:</span>\n<span class=\"s2\">┌─────────────────────────────────────────────────────────────┐</span>\n<span class=\"s2\">│ PRECISION (ML) ≠ metriche biometriche                       │</span>\n<span class=\"s2\">│   Formula: TP / (TP + FP)                                   │</span>\n<span class=\"s2\">│   Significato: Accuratezza predizioni positive              │</span>\n<span class=\"s2\">│   Equivalente Bio: GA/(GA+FA) - Positive Predictive Value  │</span>\n<span class=\"s2\">│                                                             │</span>\n<span class=\"s2\">│ RECALL (ML) ≠ GAR ma RECALL = 1 - FRR                      │</span>\n<span class=\"s2\">│   Formula: TP / (TP + FN)                                   │</span>\n<span class=\"s2\">│   Significato: Copertura dei positivi                       │</span>\n<span class=\"s2\">│   Equivalente Bio: GAR (Genuine Acceptance Rate)           │</span>\n<span class=\"s2\">│                                                             │</span>\n<span class=\"s2\">│ FPR (ML) = FAR (Biometria) ✓                              │</span>\n<span class=\"s2\">│   Formula: FP / (FP + TN)                                   │</span>\n<span class=\"s2\">│   Significato: Tasso accettazione impostori                 │</span>\n<span class=\"s2\">│                                                             │</span>\n<span class=\"s2\">│ FNR (ML) = FRR (Biometria) ✓                              │</span>\n<span class=\"s2\">│   Formula: FN / (FN + TP)                                   │</span>\n<span class=\"s2\">│   Significato: Tasso rifiuto genuini                        │</span>\n<span class=\"s2\">└─────────────────────────────────────────────────────────────┘</span>\n\n<span class=\"s2\">FOCUS DIVERSO:</span>\n<span class=\"s2\">┌─────────────────────────────────────────────────────────────┐</span>\n<span class=\"s2\">│ ML (Precision/Recall):                                      │</span>\n<span class=\"s2\">│   → Partono da PREDIZIONI CORRETTE (TP)                    │</span>\n<span class=\"s2\">│   → Valutano QUALITÀ delle predizioni                       │</span>\n<span class=\"s2\">│   → Ottimizzazione: massimizzare TP                         │</span>\n<span class=\"s2\">│                                                             │</span>\n<span class=\"s2\">│ Biometria (FAR/FRR):                                       │</span>\n<span class=\"s2\">│   → Partono da ERRORI del sistema (FP, FN)                 │</span>\n<span class=\"s2\">│   → Valutano TASSI DI ERRORE                               │</span>\n<span class=\"s2\">│   → Ottimizzazione: minimizzare errori                      │</span>\n<span class=\"s2\">└─────────────────────────────────────────────────────────────┘</span>\n\n<span class=\"s2\">⚠️  NON INTERCAMBIABILI NELLE VALUTAZIONI!</span>\n<span class=\"s2\">&quot;&quot;&quot;</span>\n\n<span class=\"n\">ax</span><span class=\"o\">.</span><span class=\"n\">text</span><span class=\"p\">(</span><span class=\"mf\">0.5</span><span class=\"p\">,</span> <span class=\"mf\">0.5</span><span class=\"p\">,</span> <span class=\"n\">comparison_text</span><span class=\"p\">,</span> <span class=\"n\">fontsize</span><span class=\"o\">=</span><span class=\"mi\">8</span><span class=\"p\">,</span> <span class=\"n\">family</span><span class=\"o\">=</span><span class=\"s1\">&#39;monospace&#39;</span><span class=\"p\">,</span>\n       <span class=\"n\">verticalalignment</span><span class=\"o\">=</span><span class=\"s1\">&#39;center&#39;</span><span class=\"p\">,</span> <span class=\"n\">horizontalalignment</span><span class=\"o\">=</span><span class=\"s1\">&#39;center&#39;</span><span class=\"p\">,</span>\n       <span class=\"n\">bbox</span><span class=\"o\">=</span><span class=\"nb\">dict</span><span class=\"p\">(</span><span class=\"n\">boxstyle</span><span class=\"o\">=</span><span class=\"s1\">&#39;round&#39;</span><span class=\"p\">,</span> <span class=\"n\">facecolor</span><span class=\"o\">=</span><span class=\"s1\">&#39;lightyellow&#39;</span><span class=\"p\">,</span> <span class=\"n\">alpha</span><span class=\"o\">=</span><span class=\"mf\">0.9</span><span class=\"p\">))</span>\n\n<span class=\"c1\"># 4. Decision framework</span>\n<span class=\"n\">ax</span> <span class=\"o\">=</span> <span class=\"n\">axes</span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">,</span> <span class=\"mi\">1</span><span class=\"p\">]</span>\n<span class=\"n\">ax</span><span class=\"o\">.</span><span class=\"n\">axis</span><span class=\"p\">(</span><span class=\"s1\">&#39;off&#39;</span><span class=\"p\">)</span>\n\n<span class=\"n\">decision_text</span> <span class=\"o\">=</span> <span class=\"s2\">&quot;&quot;&quot;</span>\n<span class=\"s2\">╔═══════════════════════════════════════════════════════════════╗</span>\n<span class=\"s2\">║           FRAMEWORK DECISIONALE METRICHE                     ║</span>\n<span class=\"s2\">╚═══════════════════════════════════════════════════════════════╝</span>\n\n<span class=\"s2\">DOMANDE CHIAVE:</span>\n\n<span class=\"s2\">1️⃣  Le classi sono bilanciate?</span>\n<span class=\"s2\">   └─ SÌ  → Accuracy, F1, ROC-AUC</span>\n<span class=\"s2\">   └─ NO  → Precision, Recall, PR-AUC, MCC</span>\n\n<span class=\"s2\">2️⃣  Quale errore è più costoso?</span>\n<span class=\"s2\">   └─ FP  → Maximizza Precision, minimizza FPR</span>\n<span class=\"s2\">   └─ FN  → Maximizza Recall, minimizza FNR</span>\n<span class=\"s2\">   └─ Simile → F1-Score, EER</span>\n\n<span class=\"s2\">3️⃣  Le probabilità sono importanti?</span>\n<span class=\"s2\">   └─ SÌ  → Log Loss, Brier, Calibration</span>\n<span class=\"s2\">   └─ NO  → Metriche basate su soglia</span>\n\n<span class=\"s2\">4️⃣  È un ranking problem?</span>\n<span class=\"s2\">   └─ SÌ  → AUC-ROC, AUC-PR, Lift, Gain</span>\n<span class=\"s2\">   └─ NO  → Metriche basate su soglia fissa</span>\n\n<span class=\"s2\">5️⃣  Quante classi?</span>\n<span class=\"s2\">   └─ 2   → Metriche binarie</span>\n<span class=\"s2\">   └─ &gt;2  → Macro/Micro/Weighted averaging</span>\n\n<span class=\"s2\">6️⃣  Dominio applicativo?</span>\n<span class=\"s2\">   └─ Biometria    → EER, FAR, FRR, DET</span>\n<span class=\"s2\">   └─ ML generale  → Precision, Recall, F1</span>\n<span class=\"s2\">   └─ IR/Ranking   → MAP, NDCG, MRR</span>\n\n<span class=\"s2\">━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━</span>\n\n<span class=\"s2\">COMBINAZIONI RACCOMANDATE:</span>\n\n<span class=\"s2\">🏥 MEDICINA (diagnosi tumori)</span>\n<span class=\"s2\">   Primary: Recall (↑), FNR (↓)</span>\n<span class=\"s2\">   Secondary: F2, Specificity</span>\n\n<span class=\"s2\">💳 FRODI BANCARIE</span>\n<span class=\"s2\">   Primary: Recall (↑), Precision</span>\n<span class=\"s2\">   Secondary: F1, AUC-PR</span>\n\n<span class=\"s2\">📧 SPAM DETECTION  </span>\n<span class=\"s2\">   Primary: Precision (↑), FPR (↓)</span>\n<span class=\"s2\">   Secondary: F0.5, Specificity</span>\n\n<span class=\"s2\">🔐 BIOMETRIA (accesso)</span>\n<span class=\"s2\">   Primary: EER, FAR, FRR</span>\n<span class=\"s2\">   Secondary: ZeroFAR, ROC, DET</span>\n\n<span class=\"s2\">🎯 RECOMMENDER SYSTEMS</span>\n<span class=\"s2\">   Primary: Precision@K, Recall@K</span>\n<span class=\"s2\">   Secondary: MAP, NDCG, Lift</span>\n<span class=\"s2\">&quot;&quot;&quot;</span>\n\n<span class=\"n\">ax</span><span class=\"o\">.</span><span class=\"n\">text</span><span class=\"p\">(</span><span class=\"mf\">0.5</span><span class=\"p\">,</span> <span class=\"mf\">0.5</span><span class=\"p\">,</span> <span class=\"n\">decision_text</span><span class=\"p\">,</span> <span class=\"n\">fontsize</span><span class=\"o\">=</span><span class=\"mi\">8</span><span class=\"p\">,</span> <span class=\"n\">family</span><span class=\"o\">=</span><span class=\"s1\">&#39;monospace&#39;</span><span class=\"p\">,</span>\n       <span class=\"n\">verticalalignment</span><span class=\"o\">=</span><span class=\"s1\">&#39;center&#39;</span><span class=\"p\">,</span> <span class=\"n\">horizontalalignment</span><span class=\"o\">=</span><span class=\"s1\">&#39;center&#39;</span><span class=\"p\">,</span>\n       <span class=\"n\">bbox</span><span class=\"o\">=</span><span class=\"nb\">dict</span><span class=\"p\">(</span><span class=\"n\">boxstyle</span><span class=\"o\">=</span><span class=\"s1\">&#39;round&#39;</span><span class=\"p\">,</span> <span class=\"n\">facecolor</span><span class=\"o\">=</span><span class=\"s1\">&#39;lightcyan&#39;</span><span class=\"p\">,</span> <span class=\"n\">alpha</span><span class=\"o\">=</span><span class=\"mf\">0.9</span><span class=\"p\">))</span>\n\n<span class=\"n\">plt</span><span class=\"o\">.</span><span class=\"n\">suptitle</span><span class=\"p\">(</span><span class=\"s1\">&#39;SINTESI COMPLETA: Relazioni, Differenze e Framework Decisionale&#39;</span><span class=\"p\">,</span> \n            <span class=\"n\">fontsize</span><span class=\"o\">=</span><span class=\"mi\">16</span><span class=\"p\">,</span> <span class=\"n\">fontweight</span><span class=\"o\">=</span><span class=\"s1\">&#39;bold&#39;</span><span class=\"p\">,</span> <span class=\"n\">y</span><span class=\"o\">=</span><span class=\"mf\">0.995</span><span class=\"p\">)</span>\n<span class=\"n\">plt</span><span class=\"o\">.</span><span class=\"n\">tight_layout</span><span class=\"p\">()</span>\n<span class=\"n\">plt</span><span class=\"o\">.</span><span class=\"n\">show</span><span class=\"p\">()</span>\n</code></pre></div>\n</div>\n</details>\n\n<h3 id=\"esempio-pratico-completo-caso-duso-end-to-end\">Esempio Pratico Completo: Caso d&rsquo;Uso End-to-End</h3>\n<details class=\"code-container\">\n<summary>Code</summary>\n<div class=\"code-wrapper\">\n<button class=\"copy-button\" onclick=\"\n                const code = this.parentElement.querySelector('pre');\n                if (code) {\n                    navigator.clipboard.writeText(code.innerText);\n                    this.textContent = 'Copied!';\n                    setTimeout(() => this.textContent = 'Copy', 2000);\n                }\n            \">Copy</button>\n<div class=\"codehilite\"><pre><span></span><code><span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"s2\">&quot;</span><span class=\"se\">\\n</span><span class=\"s2\">&quot;</span> <span class=\"o\">+</span> <span class=\"s2\">&quot;=&quot;</span><span class=\"o\">*</span><span class=\"mi\">80</span><span class=\"p\">)</span>\n<span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"s2\">&quot;ESEMPIO PRATICO: VALUTAZIONE COMPLETA SISTEMA DI CLASSIFICAZIONE&quot;</span><span class=\"p\">)</span>\n<span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"s2\">&quot;=&quot;</span><span class=\"o\">*</span><span class=\"mi\">80</span><span class=\"p\">)</span>\n<span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"s2\">&quot;</span><span class=\"se\">\\n</span><span class=\"s2\">Scenario: Sistema di Rilevamento Frodi Bancarie&quot;</span><span class=\"p\">)</span>\n<span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"s2\">&quot;-&quot;</span><span class=\"o\">*</span><span class=\"mi\">80</span><span class=\"p\">)</span>\n\n<span class=\"c1\"># Metriche attuali</span>\n<span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"s2\">&quot;</span><span class=\"se\">\\n</span><span class=\"s2\">📊 METRICHE CALCOLATE:&quot;</span><span class=\"p\">)</span>\n<span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"sa\">f</span><span class=\"s2\">&quot;  Accuracy:           </span><span class=\"si\">{</span><span class=\"n\">accuracy</span><span class=\"si\">:</span><span class=\"s2\">.4f</span><span class=\"si\">}</span><span class=\"s2\">&quot;</span><span class=\"p\">)</span>\n<span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"sa\">f</span><span class=\"s2\">&quot;  Precision:          </span><span class=\"si\">{</span><span class=\"n\">precision</span><span class=\"si\">:</span><span class=\"s2\">.4f</span><span class=\"si\">}</span><span class=\"s2\">&quot;</span><span class=\"p\">)</span>\n<span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"sa\">f</span><span class=\"s2\">&quot;  Recall:             </span><span class=\"si\">{</span><span class=\"n\">recall</span><span class=\"si\">:</span><span class=\"s2\">.4f</span><span class=\"si\">}</span><span class=\"s2\">&quot;</span><span class=\"p\">)</span>\n<span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"sa\">f</span><span class=\"s2\">&quot;  F1-Score:           </span><span class=\"si\">{</span><span class=\"n\">f1</span><span class=\"si\">:</span><span class=\"s2\">.4f</span><span class=\"si\">}</span><span class=\"s2\">&quot;</span><span class=\"p\">)</span>\n<span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"sa\">f</span><span class=\"s2\">&quot;  F2-Score:           </span><span class=\"si\">{</span><span class=\"n\">fbeta_score</span><span class=\"p\">(</span><span class=\"n\">y_test</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">y_pred</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">beta</span><span class=\"o\">=</span><span class=\"mi\">2</span><span class=\"p\">)</span><span class=\"si\">:</span><span class=\"s2\">.4f</span><span class=\"si\">}</span><span class=\"s2\">&quot;</span><span class=\"p\">)</span>\n<span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"sa\">f</span><span class=\"s2\">&quot;  MCC:                </span><span class=\"si\">{</span><span class=\"n\">mcc</span><span class=\"si\">:</span><span class=\"s2\">.4f</span><span class=\"si\">}</span><span class=\"s2\">&quot;</span><span class=\"p\">)</span>\n<span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"sa\">f</span><span class=\"s2\">&quot;  ROC-AUC:            </span><span class=\"si\">{</span><span class=\"n\">roc_auc</span><span class=\"si\">:</span><span class=\"s2\">.4f</span><span class=\"si\">}</span><span class=\"s2\">&quot;</span><span class=\"p\">)</span>\n<span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"sa\">f</span><span class=\"s2\">&quot;  PR-AUC:             </span><span class=\"si\">{</span><span class=\"n\">avg_precision</span><span class=\"si\">:</span><span class=\"s2\">.4f</span><span class=\"si\">}</span><span class=\"s2\">&quot;</span><span class=\"p\">)</span>\n<span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"sa\">f</span><span class=\"s2\">&quot;  FPR (FAR):          </span><span class=\"si\">{</span><span class=\"n\">fpr</span><span class=\"si\">:</span><span class=\"s2\">.4f</span><span class=\"si\">}</span><span class=\"s2\">&quot;</span><span class=\"p\">)</span>\n<span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"sa\">f</span><span class=\"s2\">&quot;  FNR (FRR):          </span><span class=\"si\">{</span><span class=\"n\">fnr</span><span class=\"si\">:</span><span class=\"s2\">.4f</span><span class=\"si\">}</span><span class=\"s2\">&quot;</span><span class=\"p\">)</span>\n\n<span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"s2\">&quot;</span><span class=\"se\">\\n</span><span class=\"s2\">💡 INTERPRETAZIONE:&quot;</span><span class=\"p\">)</span>\n<span class=\"n\">prevalence</span> <span class=\"o\">=</span> <span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">mean</span><span class=\"p\">(</span><span class=\"n\">y_test</span><span class=\"p\">)</span>\n<span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"sa\">f</span><span class=\"s2\">&quot;  Prevalenza frodi:   </span><span class=\"si\">{</span><span class=\"n\">prevalence</span><span class=\"o\">*</span><span class=\"mi\">100</span><span class=\"si\">:</span><span class=\"s2\">.2f</span><span class=\"si\">}</span><span class=\"s2\">%&quot;</span><span class=\"p\">)</span>\n<span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"sa\">f</span><span class=\"s2\">&quot;  Dataset:            </span><span class=\"si\">{</span><span class=\"s1\">&#39;Sbilanciato&#39;</span><span class=\"w\"> </span><span class=\"k\">if</span><span class=\"w\"> </span><span class=\"n\">prevalence</span><span class=\"w\"> </span><span class=\"o\">&lt;</span><span class=\"w\"> </span><span class=\"mf\">0.3</span><span class=\"w\"> </span><span class=\"k\">else</span><span class=\"w\"> </span><span class=\"s1\">&#39;Bilanciato&#39;</span><span class=\"si\">}</span><span class=\"s2\">&quot;</span><span class=\"p\">)</span>\n\n<span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"s2\">&quot;</span><span class=\"se\">\\n</span><span class=\"s2\">🎯 ANALISI PERFORMANCE:&quot;</span><span class=\"p\">)</span>\n<span class=\"k\">if</span> <span class=\"n\">recall</span> <span class=\"o\">&gt;</span> <span class=\"mf\">0.85</span><span class=\"p\">:</span>\n    <span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"sa\">f</span><span class=\"s2\">&quot;  ✓ Recall alto (</span><span class=\"si\">{</span><span class=\"n\">recall</span><span class=\"si\">:</span><span class=\"s2\">.2f</span><span class=\"si\">}</span><span class=\"s2\">): Buona copertura delle frodi&quot;</span><span class=\"p\">)</span>\n<span class=\"k\">else</span><span class=\"p\">:</span>\n    <span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"sa\">f</span><span class=\"s2\">&quot;  ⚠ Recall basso (</span><span class=\"si\">{</span><span class=\"n\">recall</span><span class=\"si\">:</span><span class=\"s2\">.2f</span><span class=\"si\">}</span><span class=\"s2\">): Molte frodi non rilevate!&quot;</span><span class=\"p\">)</span>\n\n<span class=\"k\">if</span> <span class=\"n\">precision</span> <span class=\"o\">&gt;</span> <span class=\"mf\">0.75</span><span class=\"p\">:</span>\n    <span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"sa\">f</span><span class=\"s2\">&quot;  ✓ Precision alta (</span><span class=\"si\">{</span><span class=\"n\">precision</span><span class=\"si\">:</span><span class=\"s2\">.2f</span><span class=\"si\">}</span><span class=\"s2\">): Pochi falsi allarmi&quot;</span><span class=\"p\">)</span>\n<span class=\"k\">else</span><span class=\"p\">:</span>\n    <span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"sa\">f</span><span class=\"s2\">&quot;  ⚠ Precision bassa (</span><span class=\"si\">{</span><span class=\"n\">precision</span><span class=\"si\">:</span><span class=\"s2\">.2f</span><span class=\"si\">}</span><span class=\"s2\">): Troppi falsi positivi&quot;</span><span class=\"p\">)</span>\n\n<span class=\"k\">if</span> <span class=\"n\">f1</span> <span class=\"o\">&gt;</span> <span class=\"mf\">0.80</span><span class=\"p\">:</span>\n    <span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"sa\">f</span><span class=\"s2\">&quot;  ✓ F1 alto (</span><span class=\"si\">{</span><span class=\"n\">f1</span><span class=\"si\">:</span><span class=\"s2\">.2f</span><span class=\"si\">}</span><span class=\"s2\">): Buon bilanciamento generale&quot;</span><span class=\"p\">)</span>\n<span class=\"k\">else</span><span class=\"p\">:</span>\n    <span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"sa\">f</span><span class=\"s2\">&quot;  ⚠ F1 medio (</span><span class=\"si\">{</span><span class=\"n\">f1</span><span class=\"si\">:</span><span class=\"s2\">.2f</span><span class=\"si\">}</span><span class=\"s2\">): Considerare ottimizzazione&quot;</span><span class=\"p\">)</span>\n\n<span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"s2\">&quot;</span><span class=\"se\">\\n</span><span class=\"s2\">💰 IMPATTO BUSINESS:&quot;</span><span class=\"p\">)</span>\n<span class=\"c1\"># Simula costi</span>\n<span class=\"n\">cost_fp</span> <span class=\"o\">=</span> <span class=\"mi\">10</span>  <span class=\"c1\"># Costo investigazione falso positivo</span>\n<span class=\"n\">cost_fn</span> <span class=\"o\">=</span> <span class=\"mi\">1000</span>  <span class=\"c1\"># Costo frode non rilevata</span>\n<span class=\"n\">n_transactions</span> <span class=\"o\">=</span> <span class=\"nb\">len</span><span class=\"p\">(</span><span class=\"n\">y_test</span><span class=\"p\">)</span>\n\n<span class=\"n\">total_cost_fp</span> <span class=\"o\">=</span> <span class=\"n\">fp</span> <span class=\"o\">*</span> <span class=\"n\">cost_fp</span>\n<span class=\"n\">total_cost_fn</span> <span class=\"o\">=</span> <span class=\"n\">fn</span> <span class=\"o\">*</span> <span class=\"n\">cost_fn</span>\n<span class=\"n\">total_cost</span> <span class=\"o\">=</span> <span class=\"n\">total_cost_fp</span> <span class=\"o\">+</span> <span class=\"n\">total_cost_fn</span>\n\n<span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"sa\">f</span><span class=\"s2\">&quot;  Transazioni totali:     </span><span class=\"si\">{</span><span class=\"n\">n_transactions</span><span class=\"si\">}</span><span class=\"s2\">&quot;</span><span class=\"p\">)</span>\n<span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"sa\">f</span><span class=\"s2\">&quot;  Costo FP (€</span><span class=\"si\">{</span><span class=\"n\">cost_fp</span><span class=\"si\">}</span><span class=\"s2\">/caso):       €</span><span class=\"si\">{</span><span class=\"n\">total_cost_fp</span><span class=\"si\">:</span><span class=\"s2\">,.2f</span><span class=\"si\">}</span><span class=\"s2\">&quot;</span><span class=\"p\">)</span>\n<span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"sa\">f</span><span class=\"s2\">&quot;  Costo FN (€</span><span class=\"si\">{</span><span class=\"n\">cost_fn</span><span class=\"si\">}</span><span class=\"s2\">/caso):      €</span><span class=\"si\">{</span><span class=\"n\">total_cost_fn</span><span class=\"si\">:</span><span class=\"s2\">,.2f</span><span class=\"si\">}</span><span class=\"s2\">&quot;</span><span class=\"p\">)</span>\n<span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"sa\">f</span><span class=\"s2\">&quot;  Costo Totale:           €</span><span class=\"si\">{</span><span class=\"n\">total_cost</span><span class=\"si\">:</span><span class=\"s2\">,.2f</span><span class=\"si\">}</span><span class=\"s2\">&quot;</span><span class=\"p\">)</span>\n\n<span class=\"c1\"># Baseline (predice sempre negativo)</span>\n<span class=\"n\">cost_baseline</span> <span class=\"o\">=</span> <span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">sum</span><span class=\"p\">(</span><span class=\"n\">y_test</span><span class=\"p\">)</span> <span class=\"o\">*</span> <span class=\"n\">cost_fn</span>\n<span class=\"n\">saving</span> <span class=\"o\">=</span> <span class=\"n\">cost_baseline</span> <span class=\"o\">-</span> <span class=\"n\">total_cost</span>\n<span class=\"n\">saving_pct</span> <span class=\"o\">=</span> <span class=\"p\">(</span><span class=\"n\">saving</span> <span class=\"o\">/</span> <span class=\"n\">cost_baseline</span><span class=\"p\">)</span> <span class=\"o\">*</span> <span class=\"mi\">100</span>\n\n<span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"sa\">f</span><span class=\"s2\">&quot;</span><span class=\"se\">\\n</span><span class=\"s2\">  Costo Baseline (no modello): €</span><span class=\"si\">{</span><span class=\"n\">cost_baseline</span><span class=\"si\">:</span><span class=\"s2\">,.2f</span><span class=\"si\">}</span><span class=\"s2\">&quot;</span><span class=\"p\">)</span>\n<span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"sa\">f</span><span class=\"s2\">&quot;  Risparmio con modello:       €</span><span class=\"si\">{</span><span class=\"n\">saving</span><span class=\"si\">:</span><span class=\"s2\">,.2f</span><span class=\"si\">}</span><span class=\"s2\"> (</span><span class=\"si\">{</span><span class=\"n\">saving_pct</span><span class=\"si\">:</span><span class=\"s2\">.1f</span><span class=\"si\">}</span><span class=\"s2\">%)&quot;</span><span class=\"p\">)</span>\n\n<span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"s2\">&quot;</span><span class=\"se\">\\n</span><span class=\"s2\">🔧 RACCOMANDAZIONI:&quot;</span><span class=\"p\">)</span>\n<span class=\"k\">if</span> <span class=\"n\">recall</span> <span class=\"o\">&lt;</span> <span class=\"mf\">0.85</span><span class=\"p\">:</span>\n    <span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"s2\">&quot;  1. Abbassare soglia per aumentare Recall&quot;</span><span class=\"p\">)</span>\n    <span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"sa\">f</span><span class=\"s2\">&quot;     Soglia attuale: 0.5 → Suggerita: </span><span class=\"si\">{</span><span class=\"n\">optimal_f1_threshold</span><span class=\"si\">:</span><span class=\"s2\">.3f</span><span class=\"si\">}</span><span class=\"s2\">&quot;</span><span class=\"p\">)</span>\n\n<span class=\"k\">if</span> <span class=\"n\">fpr</span> <span class=\"o\">&gt;</span> <span class=\"mf\">0.05</span><span class=\"p\">:</span>\n    <span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"s2\">&quot;  2. FPR alto: considerare feature engineering&quot;</span><span class=\"p\">)</span>\n\n<span class=\"k\">if</span> <span class=\"n\">mcc</span> <span class=\"o\">&lt;</span> <span class=\"mf\">0.7</span><span class=\"p\">:</span>\n    <span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"s2\">&quot;  3. MCC basso: provare algoritmi più sofisticati&quot;</span><span class=\"p\">)</span>\n\n<span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"s2\">&quot;</span><span class=\"se\">\\n</span><span class=\"s2\">📈 PROSSIMI PASSI:&quot;</span><span class=\"p\">)</span>\n<span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"s2\">&quot;  1. Analizzare errori (FP e FN) per pattern&quot;</span><span class=\"p\">)</span>\n<span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"s2\">&quot;  2. Calibrare soglia in base a costo FP vs FN&quot;</span><span class=\"p\">)</span>\n<span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"s2\">&quot;  3. Validare su dati temporali futuri&quot;</span><span class=\"p\">)</span>\n<span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"s2\">&quot;  4. Monitorare performance in produzione&quot;</span><span class=\"p\">)</span>\n<span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"s2\">&quot;  5. Re-train periodicamente con nuovi dati&quot;</span><span class=\"p\">)</span>\n\n<span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"s2\">&quot;</span><span class=\"se\">\\n</span><span class=\"s2\">&quot;</span> <span class=\"o\">+</span> <span class=\"s2\">&quot;=&quot;</span><span class=\"o\">*</span><span class=\"mi\">80</span><span class=\"p\">)</span>\n<span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"s2\">&quot;REPORT COMPLETO GENERATO&quot;</span><span class=\"p\">)</span>\n<span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"s2\">&quot;=&quot;</span><span class=\"o\">*</span><span class=\"mi\">80</span><span class=\"p\">)</span>\n</code></pre></div>\n</div>\n</details>\n\n<hr />\n<h2 id=\"fine-del-documento\">Fine del Documento</h2>\n<p>Questo documento ha fornito una trattazione <strong>completa, rigorosa e dettagliata</strong> di tutte le metriche di valutazione per la classificazione in machine learning, con particolare attenzione a:</p>\n<p>✅ <strong>Formule matematiche</strong> precise e rigorose<br />\n✅ <strong>Differenze critiche</strong> tra ML e biometria<br />\n✅ <strong>Visualizzazioni esplicative</strong> con Python/Matplotlib/Seaborn<br />\n✅ <strong>Esempi pratici</strong> e casi d&rsquo;uso reali<br />\n✅ <strong>Linee guida</strong> per la scelta appropriata<br />\n✅ <strong>Trade-offs</strong> e ottimizzazioni  </p>\n<p><strong>Metriche coperte</strong>: Accuracy, Precision, Recall, F1/F-beta, Specificity, FPR/FAR, FNR/FRR, FDR, MCC, Cohen&rsquo;s Kappa, ROC-AUC, PR-AUC, EER, Log Loss, Brier Score, Calibration, Lift, Gain, e molto altro.</p>\n<p>La valutazione rigorosa è <strong>fondamentale</strong> per lo sviluppo di sistemi di machine learning affidabili e adatti al contesto applicativo specifico.</p>"
}